function Nn(e,lr){return lr.forEach(function(h){h&&typeof h!="string"&&!Array.isArray(h)&&Object.keys(h).forEach(function(T){if(T!=="default"&&!(T in e)){var A=Object.getOwnPropertyDescriptor(h,T);Object.defineProperty(e,T,A.get?A:{enumerable:!0,get:function(){return h[T]}})}})}),Object.freeze(e)}function Rn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fn,On;function Sn(){return On||(On=1,fn=(function(e){var lr={};function h(T){if(lr[T])return lr[T].exports;var A=lr[T]={i:T,l:!1,exports:{}};return e[T].call(A.exports,A,A.exports,h),A.l=!0,A.exports}return h.m=e,h.c=lr,h.d=function(T,A,G){h.o(T,A)||Object.defineProperty(T,A,{enumerable:!0,get:G})},h.r=function(T){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(T,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(T,"__esModule",{value:!0})},h.t=function(T,A){if(1&A&&(T=h(T)),8&A||4&A&&typeof T=="object"&&T&&T.__esModule)return T;var G=Object.create(null);if(h.r(G),Object.defineProperty(G,"default",{enumerable:!0,value:T}),2&A&&typeof T!="string")for(var S in T)h.d(G,S,(function(ue){return T[ue]}).bind(null,S));return G},h.n=function(T){var A=T&&T.__esModule?function(){return T.default}:function(){return T};return h.d(A,"a",A),A},h.o=function(T,A){return Object.prototype.hasOwnProperty.call(T,A)},h.p="",h(h.s=34)})([function(e,lr,h){const T=h(5);e.exports.FENGARI_AUTHORS=T.FENGARI_AUTHORS,e.exports.FENGARI_COPYRIGHT=T.FENGARI_COPYRIGHT,e.exports.FENGARI_RELEASE=T.FENGARI_RELEASE,e.exports.FENGARI_VERSION=T.FENGARI_VERSION,e.exports.FENGARI_VERSION_MAJOR=T.FENGARI_VERSION_MAJOR,e.exports.FENGARI_VERSION_MINOR=T.FENGARI_VERSION_MINOR,e.exports.FENGARI_VERSION_NUM=T.FENGARI_VERSION_NUM,e.exports.FENGARI_VERSION_RELEASE=T.FENGARI_VERSION_RELEASE,e.exports.luastring_eq=T.luastring_eq,e.exports.luastring_indexOf=T.luastring_indexOf,e.exports.luastring_of=T.luastring_of,e.exports.to_jsstring=T.to_jsstring,e.exports.to_luastring=T.to_luastring,e.exports.to_uristring=T.to_uristring;const A=h(3),G=h(2),S=h(7),ue=h(17);e.exports.luaconf=A,e.exports.lua=G,e.exports.lauxlib=S,e.exports.lualib=ue},function(e,lr,h){let T,A,G;if(T=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):function(H){let oe=0,$=H.length,Be=new Uint8Array($);for(;$>oe;)Be[oe]=H[oe++];return Be},typeof new Uint8Array().indexOf=="function")A=function(H,oe,$){return H.indexOf(oe,$)};else{let H=[].indexOf;if(H.call(new Uint8Array(1),0)!==0)throw Error("missing .indexOf");A=function(oe,$,Be){return H.call(oe,$,Be)}}G=typeof Uint8Array.of=="function"?Uint8Array.of.bind(Uint8Array):function(){return T(arguments)};const S=function(H){return H instanceof Uint8Array},ue="cannot convert invalid utf8 to javascript string",we=";,/?:@&=+$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789,-_.!~*'()#".split("").reduce(function(H,oe){return H[oe.charCodeAt(0)]=!0,H},{}),C={},fe=function(H,oe){if(typeof H!="string")throw new TypeError("to_luastring expects a javascript string");if(oe){let Ke=C[H];if(S(Ke))return Ke}let $=H.length,Be=Array($),Me=0;for(let Ke=0;Ke<$;++Ke){let Pe=H.charCodeAt(Ke);if(Pe<=127)Be[Me++]=Pe;else if(Pe<=2047)Be[Me++]=192|Pe>>6,Be[Me++]=128|63&Pe;else{if(Pe>=55296&&Pe<=56319&&Ke+1<$){let Ye=H.charCodeAt(Ke+1);Ye>=56320&&Ye<=57343&&(Ke++,Pe=1024*(Pe-55296)+Ye+9216)}Pe<=65535?(Be[Me++]=224|Pe>>12,Be[Me++]=128|Pe>>6&63,Be[Me++]=128|63&Pe):(Be[Me++]=240|Pe>>18,Be[Me++]=128|Pe>>12&63,Be[Me++]=128|Pe>>6&63,Be[Me++]=128|63&Pe)}}return Be=T(Be),oe&&(C[H]=Be),Be};e.exports.luastring_from=T,e.exports.luastring_indexOf=A,e.exports.luastring_of=G,e.exports.is_luastring=S,e.exports.luastring_eq=function(H,oe){if(H!==oe){let $=H.length;if($!==oe.length)return!1;for(let Be=0;Be<$;Be++)if(H[Be]!==oe[Be])return!1}return!0},e.exports.to_jsstring=function(H,oe,$,Be){if(!S(H))throw new TypeError("to_jsstring expects a Uint8Array");$=$===void 0?H.length:Math.min(H.length,$);let Me="";for(let Ke=oe!==void 0?oe:0;Ke<$;){let Pe=H[Ke++];if(Pe<128)Me+=String.fromCharCode(Pe);else if(Pe<194||Pe>244){if(!Be)throw RangeError(ue);Me+="�"}else if(Pe<=223){if(Ke>=$){if(!Be)throw RangeError(ue);Me+="�";continue}let Ye=H[Ke++];if((192&Ye)!=128){if(!Be)throw RangeError(ue);Me+="�";continue}Me+=String.fromCharCode(((31&Pe)<<6)+(63&Ye))}else if(Pe<=239){if(Ke+1>=$){if(!Be)throw RangeError(ue);Me+="�";continue}let Ye=H[Ke++];if((192&Ye)!=128){if(!Be)throw RangeError(ue);Me+="�";continue}let b=H[Ke++];if((192&b)!=128){if(!Be)throw RangeError(ue);Me+="�";continue}let I=((15&Pe)<<12)+((63&Ye)<<6)+(63&b);if(I<=65535)Me+=String.fromCharCode(I);else{let Y=55296+((I-=65536)>>10),X=I%1024+56320;Me+=String.fromCharCode(Y,X)}}else{if(Ke+2>=$){if(!Be)throw RangeError(ue);Me+="�";continue}let Ye=H[Ke++];if((192&Ye)!=128){if(!Be)throw RangeError(ue);Me+="�";continue}let b=H[Ke++];if((192&b)!=128){if(!Be)throw RangeError(ue);Me+="�";continue}let I=H[Ke++];if((192&I)!=128){if(!Be)throw RangeError(ue);Me+="�";continue}let Y=((7&Pe)<<18)+((63&Ye)<<12)+((63&b)<<6)+(63&I),X=55296+((Y-=65536)>>10),ee=Y%1024+56320;Me+=String.fromCharCode(X,ee)}}return Me},e.exports.to_uristring=function(H){if(!S(H))throw new TypeError("to_uristring expects a Uint8Array");let oe="";for(let $=0;$<H.length;$++){let Be=H[$];we[Be]?oe+=String.fromCharCode(Be):oe+="%"+(Be<16?"0":"")+Be.toString(16)}return oe},e.exports.to_luastring=fe,e.exports.from_userstring=function(H){if(!S(H)){if(typeof H!="string")throw new TypeError("expects an array of bytes or javascript string");H=fe(H)}return H};const K=fe("\x1BLua");e.exports.LUA_SIGNATURE=K,e.exports.LUA_VERSION_MAJOR="5",e.exports.LUA_VERSION_MINOR="3",e.exports.LUA_VERSION_NUM=503,e.exports.LUA_VERSION_RELEASE="4",e.exports.LUA_VERSION="Lua 5.3",e.exports.LUA_RELEASE="Lua 5.3.4",e.exports.LUA_COPYRIGHT="Lua 5.3.4  Copyright (C) 1994-2017 Lua.org, PUC-Rio",e.exports.LUA_AUTHORS="R. Ierusalimschy, L. H. de Figueiredo, W. Celes";const Ie={LUA_TNONE:-1,LUA_TNIL:0,LUA_TBOOLEAN:1,LUA_TLIGHTUSERDATA:2,LUA_TNUMBER:3,LUA_TSTRING:4,LUA_TTABLE:5,LUA_TFUNCTION:6,LUA_TUSERDATA:7,LUA_TTHREAD:8,LUA_NUMTAGS:9};Ie.LUA_TSHRSTR=0|Ie.LUA_TSTRING,Ie.LUA_TLNGSTR=16|Ie.LUA_TSTRING,Ie.LUA_TNUMFLT=0|Ie.LUA_TNUMBER,Ie.LUA_TNUMINT=16|Ie.LUA_TNUMBER,Ie.LUA_TLCL=0|Ie.LUA_TFUNCTION,Ie.LUA_TLCF=16|Ie.LUA_TFUNCTION,Ie.LUA_TCCL=32|Ie.LUA_TFUNCTION;const{LUAI_MAXSTACK:pe}=h(3),Le=-pe-1e3;e.exports.LUA_HOOKCALL=0,e.exports.LUA_HOOKCOUNT=3,e.exports.LUA_HOOKLINE=2,e.exports.LUA_HOOKRET=1,e.exports.LUA_HOOKTAILCALL=4,e.exports.LUA_MASKCALL=1,e.exports.LUA_MASKCOUNT=8,e.exports.LUA_MASKLINE=4,e.exports.LUA_MASKRET=2,e.exports.LUA_MINSTACK=20,e.exports.LUA_MULTRET=-1,e.exports.LUA_OPADD=0,e.exports.LUA_OPBAND=7,e.exports.LUA_OPBNOT=13,e.exports.LUA_OPBOR=8,e.exports.LUA_OPBXOR=9,e.exports.LUA_OPDIV=5,e.exports.LUA_OPEQ=0,e.exports.LUA_OPIDIV=6,e.exports.LUA_OPLE=2,e.exports.LUA_OPLT=1,e.exports.LUA_OPMOD=3,e.exports.LUA_OPMUL=2,e.exports.LUA_OPPOW=4,e.exports.LUA_OPSHL=10,e.exports.LUA_OPSHR=11,e.exports.LUA_OPSUB=1,e.exports.LUA_OPUNM=12,e.exports.LUA_REGISTRYINDEX=Le,e.exports.LUA_RIDX_GLOBALS=2,e.exports.LUA_RIDX_LAST=2,e.exports.LUA_RIDX_MAINTHREAD=1,e.exports.constant_types=Ie,e.exports.lua_Debug=class{constructor(){this.event=NaN,this.name=null,this.namewhat=null,this.what=null,this.source=null,this.currentline=NaN,this.linedefined=NaN,this.lastlinedefined=NaN,this.nups=NaN,this.nparams=NaN,this.isvararg=NaN,this.istailcall=NaN,this.short_src=null,this.i_ci=null}},e.exports.lua_upvalueindex=function(H){return Le-H},e.exports.thread_status={LUA_OK:0,LUA_YIELD:1,LUA_ERRRUN:2,LUA_ERRSYNTAX:3,LUA_ERRMEM:4,LUA_ERRGCMM:5,LUA_ERRERR:6}},function(e,lr,h){const T=h(1),A=h(18),G=h(11),S=h(8),ue=h(12);e.exports.LUA_AUTHORS=T.LUA_AUTHORS,e.exports.LUA_COPYRIGHT=T.LUA_COPYRIGHT,e.exports.LUA_ERRERR=T.thread_status.LUA_ERRERR,e.exports.LUA_ERRGCMM=T.thread_status.LUA_ERRGCMM,e.exports.LUA_ERRMEM=T.thread_status.LUA_ERRMEM,e.exports.LUA_ERRRUN=T.thread_status.LUA_ERRRUN,e.exports.LUA_ERRSYNTAX=T.thread_status.LUA_ERRSYNTAX,e.exports.LUA_HOOKCALL=T.LUA_HOOKCALL,e.exports.LUA_HOOKCOUNT=T.LUA_HOOKCOUNT,e.exports.LUA_HOOKLINE=T.LUA_HOOKLINE,e.exports.LUA_HOOKRET=T.LUA_HOOKRET,e.exports.LUA_HOOKTAILCALL=T.LUA_HOOKTAILCALL,e.exports.LUA_MASKCALL=T.LUA_MASKCALL,e.exports.LUA_MASKCOUNT=T.LUA_MASKCOUNT,e.exports.LUA_MASKLINE=T.LUA_MASKLINE,e.exports.LUA_MASKRET=T.LUA_MASKRET,e.exports.LUA_MINSTACK=T.LUA_MINSTACK,e.exports.LUA_MULTRET=T.LUA_MULTRET,e.exports.LUA_NUMTAGS=T.constant_types.LUA_NUMTAGS,e.exports.LUA_OK=T.thread_status.LUA_OK,e.exports.LUA_OPADD=T.LUA_OPADD,e.exports.LUA_OPBAND=T.LUA_OPBAND,e.exports.LUA_OPBNOT=T.LUA_OPBNOT,e.exports.LUA_OPBOR=T.LUA_OPBOR,e.exports.LUA_OPBXOR=T.LUA_OPBXOR,e.exports.LUA_OPDIV=T.LUA_OPDIV,e.exports.LUA_OPEQ=T.LUA_OPEQ,e.exports.LUA_OPIDIV=T.LUA_OPIDIV,e.exports.LUA_OPLE=T.LUA_OPLE,e.exports.LUA_OPLT=T.LUA_OPLT,e.exports.LUA_OPMOD=T.LUA_OPMOD,e.exports.LUA_OPMUL=T.LUA_OPMUL,e.exports.LUA_OPPOW=T.LUA_OPPOW,e.exports.LUA_OPSHL=T.LUA_OPSHL,e.exports.LUA_OPSHR=T.LUA_OPSHR,e.exports.LUA_OPSUB=T.LUA_OPSUB,e.exports.LUA_OPUNM=T.LUA_OPUNM,e.exports.LUA_REGISTRYINDEX=T.LUA_REGISTRYINDEX,e.exports.LUA_RELEASE=T.LUA_RELEASE,e.exports.LUA_RIDX_GLOBALS=T.LUA_RIDX_GLOBALS,e.exports.LUA_RIDX_LAST=T.LUA_RIDX_LAST,e.exports.LUA_RIDX_MAINTHREAD=T.LUA_RIDX_MAINTHREAD,e.exports.LUA_SIGNATURE=T.LUA_SIGNATURE,e.exports.LUA_TNONE=T.constant_types.LUA_TNONE,e.exports.LUA_TNIL=T.constant_types.LUA_TNIL,e.exports.LUA_TBOOLEAN=T.constant_types.LUA_TBOOLEAN,e.exports.LUA_TLIGHTUSERDATA=T.constant_types.LUA_TLIGHTUSERDATA,e.exports.LUA_TNUMBER=T.constant_types.LUA_TNUMBER,e.exports.LUA_TSTRING=T.constant_types.LUA_TSTRING,e.exports.LUA_TTABLE=T.constant_types.LUA_TTABLE,e.exports.LUA_TFUNCTION=T.constant_types.LUA_TFUNCTION,e.exports.LUA_TUSERDATA=T.constant_types.LUA_TUSERDATA,e.exports.LUA_TTHREAD=T.constant_types.LUA_TTHREAD,e.exports.LUA_VERSION=T.LUA_VERSION,e.exports.LUA_VERSION_MAJOR=T.LUA_VERSION_MAJOR,e.exports.LUA_VERSION_MINOR=T.LUA_VERSION_MINOR,e.exports.LUA_VERSION_NUM=T.LUA_VERSION_NUM,e.exports.LUA_VERSION_RELEASE=T.LUA_VERSION_RELEASE,e.exports.LUA_YIELD=T.thread_status.LUA_YIELD,e.exports.lua_Debug=T.lua_Debug,e.exports.lua_upvalueindex=T.lua_upvalueindex,e.exports.lua_absindex=A.lua_absindex,e.exports.lua_arith=A.lua_arith,e.exports.lua_atpanic=A.lua_atpanic,e.exports.lua_atnativeerror=A.lua_atnativeerror,e.exports.lua_call=A.lua_call,e.exports.lua_callk=A.lua_callk,e.exports.lua_checkstack=A.lua_checkstack,e.exports.lua_close=ue.lua_close,e.exports.lua_compare=A.lua_compare,e.exports.lua_concat=A.lua_concat,e.exports.lua_copy=A.lua_copy,e.exports.lua_createtable=A.lua_createtable,e.exports.lua_dump=A.lua_dump,e.exports.lua_error=A.lua_error,e.exports.lua_gc=A.lua_gc,e.exports.lua_getallocf=A.lua_getallocf,e.exports.lua_getextraspace=A.lua_getextraspace,e.exports.lua_getfield=A.lua_getfield,e.exports.lua_getglobal=A.lua_getglobal,e.exports.lua_gethook=G.lua_gethook,e.exports.lua_gethookcount=G.lua_gethookcount,e.exports.lua_gethookmask=G.lua_gethookmask,e.exports.lua_geti=A.lua_geti,e.exports.lua_getinfo=G.lua_getinfo,e.exports.lua_getlocal=G.lua_getlocal,e.exports.lua_getmetatable=A.lua_getmetatable,e.exports.lua_getstack=G.lua_getstack,e.exports.lua_gettable=A.lua_gettable,e.exports.lua_gettop=A.lua_gettop,e.exports.lua_getupvalue=A.lua_getupvalue,e.exports.lua_getuservalue=A.lua_getuservalue,e.exports.lua_insert=A.lua_insert,e.exports.lua_isboolean=A.lua_isboolean,e.exports.lua_iscfunction=A.lua_iscfunction,e.exports.lua_isfunction=A.lua_isfunction,e.exports.lua_isinteger=A.lua_isinteger,e.exports.lua_islightuserdata=A.lua_islightuserdata,e.exports.lua_isnil=A.lua_isnil,e.exports.lua_isnone=A.lua_isnone,e.exports.lua_isnoneornil=A.lua_isnoneornil,e.exports.lua_isnumber=A.lua_isnumber,e.exports.lua_isproxy=A.lua_isproxy,e.exports.lua_isstring=A.lua_isstring,e.exports.lua_istable=A.lua_istable,e.exports.lua_isthread=A.lua_isthread,e.exports.lua_isuserdata=A.lua_isuserdata,e.exports.lua_isyieldable=S.lua_isyieldable,e.exports.lua_len=A.lua_len,e.exports.lua_load=A.lua_load,e.exports.lua_newstate=ue.lua_newstate,e.exports.lua_newtable=A.lua_newtable,e.exports.lua_newthread=ue.lua_newthread,e.exports.lua_newuserdata=A.lua_newuserdata,e.exports.lua_next=A.lua_next,e.exports.lua_pcall=A.lua_pcall,e.exports.lua_pcallk=A.lua_pcallk,e.exports.lua_pop=A.lua_pop,e.exports.lua_pushboolean=A.lua_pushboolean,e.exports.lua_pushcclosure=A.lua_pushcclosure,e.exports.lua_pushcfunction=A.lua_pushcfunction,e.exports.lua_pushfstring=A.lua_pushfstring,e.exports.lua_pushglobaltable=A.lua_pushglobaltable,e.exports.lua_pushinteger=A.lua_pushinteger,e.exports.lua_pushjsclosure=A.lua_pushjsclosure,e.exports.lua_pushjsfunction=A.lua_pushjsfunction,e.exports.lua_pushlightuserdata=A.lua_pushlightuserdata,e.exports.lua_pushliteral=A.lua_pushliteral,e.exports.lua_pushlstring=A.lua_pushlstring,e.exports.lua_pushnil=A.lua_pushnil,e.exports.lua_pushnumber=A.lua_pushnumber,e.exports.lua_pushstring=A.lua_pushstring,e.exports.lua_pushthread=A.lua_pushthread,e.exports.lua_pushvalue=A.lua_pushvalue,e.exports.lua_pushvfstring=A.lua_pushvfstring,e.exports.lua_rawequal=A.lua_rawequal,e.exports.lua_rawget=A.lua_rawget,e.exports.lua_rawgeti=A.lua_rawgeti,e.exports.lua_rawgetp=A.lua_rawgetp,e.exports.lua_rawlen=A.lua_rawlen,e.exports.lua_rawset=A.lua_rawset,e.exports.lua_rawseti=A.lua_rawseti,e.exports.lua_rawsetp=A.lua_rawsetp,e.exports.lua_register=A.lua_register,e.exports.lua_remove=A.lua_remove,e.exports.lua_replace=A.lua_replace,e.exports.lua_resume=S.lua_resume,e.exports.lua_rotate=A.lua_rotate,e.exports.lua_setallof=S.lua_setallof,e.exports.lua_setfield=A.lua_setfield,e.exports.lua_setglobal=A.lua_setglobal,e.exports.lua_sethook=G.lua_sethook,e.exports.lua_seti=A.lua_seti,e.exports.lua_setlocal=G.lua_setlocal,e.exports.lua_setmetatable=A.lua_setmetatable,e.exports.lua_settable=A.lua_settable,e.exports.lua_settop=A.lua_settop,e.exports.lua_setupvalue=A.lua_setupvalue,e.exports.lua_setuservalue=A.lua_setuservalue,e.exports.lua_status=A.lua_status,e.exports.lua_stringtonumber=A.lua_stringtonumber,e.exports.lua_toboolean=A.lua_toboolean,e.exports.lua_todataview=A.lua_todataview,e.exports.lua_tointeger=A.lua_tointeger,e.exports.lua_tointegerx=A.lua_tointegerx,e.exports.lua_tojsstring=A.lua_tojsstring,e.exports.lua_tolstring=A.lua_tolstring,e.exports.lua_tonumber=A.lua_tonumber,e.exports.lua_tonumberx=A.lua_tonumberx,e.exports.lua_topointer=A.lua_topointer,e.exports.lua_toproxy=A.lua_toproxy,e.exports.lua_tostring=A.lua_tostring,e.exports.lua_tothread=A.lua_tothread,e.exports.lua_touserdata=A.lua_touserdata,e.exports.lua_type=A.lua_type,e.exports.lua_typename=A.lua_typename,e.exports.lua_upvalueid=A.lua_upvalueid,e.exports.lua_upvaluejoin=A.lua_upvaluejoin,e.exports.lua_version=A.lua_version,e.exports.lua_xmove=A.lua_xmove,e.exports.lua_yield=S.lua_yield,e.exports.lua_yieldk=S.lua_yieldk,e.exports.lua_tocfunction=A.lua_tocfunction},function(e,lr,h){const T={},{LUA_VERSION_MAJOR:A,LUA_VERSION_MINOR:G,to_luastring:S}=h(1);e.exports.LUA_PATH_SEP=";",e.exports.LUA_PATH_MARK="?",e.exports.LUA_EXEC_DIR="!";const ue=A+"."+G;e.exports.LUA_VDIR=ue;{e.exports.LUA_DIRSEP="/";const Le="./lua/"+ue+"/";e.exports.LUA_LDIR=Le;const H=Le;e.exports.LUA_JSDIR=H;const oe=S(Le+"?.lua;"+Le+"?/init.lua;./?.lua;./?/init.lua");e.exports.LUA_PATH_DEFAULT=oe;const $=S(H+"?.js;"+H+"loadall.js;./?.js");e.exports.LUA_JSPATH_DEFAULT=$}const we=T.LUA_COMPAT_FLOATSTRING||!1,C=T.LUAI_MAXSTACK||1e6,fe=T.LUA_IDSIZE||59,K=T.LUAL_BUFFERSIZE||8192,Ie=function(pe,Le){for(var H=Math.min(3,Math.ceil(Math.abs(Le)/1023)),oe=pe,$=0;$<H;$++)oe*=Math.pow(2,Math.floor((Le+$)/H));return oe};e.exports.LUAI_MAXSTACK=C,e.exports.LUA_COMPAT_FLOATSTRING=we,e.exports.LUA_IDSIZE=fe,e.exports.LUA_INTEGER_FMT="%d",e.exports.LUA_INTEGER_FRMLEN="",e.exports.LUA_MAXINTEGER=2147483647,e.exports.LUA_MININTEGER=-2147483648,e.exports.LUA_NUMBER_FMT="%.14g",e.exports.LUA_NUMBER_FRMLEN="",e.exports.LUAL_BUFFERSIZE=K,e.exports.frexp=function(pe){if(pe===0)return[pe,0];var Le=new DataView(new ArrayBuffer(8));Le.setFloat64(0,pe);var H=Le.getUint32(0)>>>20&2047;H===0&&(Le.setFloat64(0,pe*Math.pow(2,64)),H=(Le.getUint32(0)>>>20&2047)-64);var oe=H-1022;return[Ie(pe,-oe),oe]},e.exports.ldexp=Ie,e.exports.lua_getlocaledecpoint=function(){return 46},e.exports.lua_integer2str=function(pe){return String(pe)},e.exports.lua_number2str=function(pe){return String(Number(pe.toPrecision(14)))},e.exports.lua_numbertointeger=function(pe){return pe>=-2147483648&&pe<2147483648&&pe},e.exports.luai_apicheck=function(pe,Le){if(!Le)throw Error(Le)}},function(e,lr,h){const{luai_apicheck:T}=h(3),A=function(G){if(!G)throw Error("assertion failed")};e.exports.lua_assert=A,e.exports.luai_apicheck=T||function(G,S){return A(S)},e.exports.api_check=function(G,S,ue){return T(G,S&&ue)},e.exports.LUAI_MAXCCALLS=200,e.exports.LUA_MINBUFFER=32,e.exports.luai_nummod=function(G,S,ue){let we=S%ue;return we*ue<0&&(we+=ue),we},e.exports.MAX_INT=2147483647,e.exports.MIN_INT=-2147483648},function(e,lr,h){const T=h(1),A=`Fengari 0.1.4  Copyright (C) 2017-2018 B. Giannangeli, Daurnimator
Based on: `+T.LUA_COPYRIGHT;e.exports.FENGARI_AUTHORS="B. Giannangeli, Daurnimator",e.exports.FENGARI_COPYRIGHT=A,e.exports.FENGARI_RELEASE="Fengari 0.1.4",e.exports.FENGARI_VERSION="Fengari 0.1",e.exports.FENGARI_VERSION_MAJOR="0",e.exports.FENGARI_VERSION_MINOR="1",e.exports.FENGARI_VERSION_NUM=1,e.exports.FENGARI_VERSION_RELEASE="4",e.exports.is_luastring=T.is_luastring,e.exports.luastring_eq=T.luastring_eq,e.exports.luastring_from=T.luastring_from,e.exports.luastring_indexOf=T.luastring_indexOf,e.exports.luastring_of=T.luastring_of,e.exports.to_jsstring=T.to_jsstring,e.exports.to_luastring=T.to_luastring,e.exports.to_uristring=T.to_uristring,e.exports.from_userstring=T.from_userstring},function(e,lr,h){const{LUA_OPADD:T,LUA_OPBAND:A,LUA_OPBNOT:G,LUA_OPBOR:S,LUA_OPBXOR:ue,LUA_OPDIV:we,LUA_OPIDIV:C,LUA_OPMOD:fe,LUA_OPMUL:K,LUA_OPPOW:Ie,LUA_OPSHL:pe,LUA_OPSHR:Le,LUA_OPSUB:H,LUA_OPUNM:oe,constant_types:{LUA_NUMTAGS:$,LUA_TBOOLEAN:Be,LUA_TCCL:Me,LUA_TFUNCTION:Ke,LUA_TLCF:Pe,LUA_TLCL:Ye,LUA_TLIGHTUSERDATA:b,LUA_TLNGSTR:I,LUA_TNIL:Y,LUA_TNUMBER:X,LUA_TNUMFLT:ee,LUA_TNUMINT:Ne,LUA_TSHRSTR:Fe,LUA_TSTRING:He,LUA_TTABLE:y,LUA_TTHREAD:W,LUA_TUSERDATA:Ue},from_userstring:Z,luastring_indexOf:je,luastring_of:d,to_jsstring:k,to_luastring:m}=h(1),{lisdigit:ie,lisprint:_e,lisspace:nr,lisxdigit:ze}=h(22),rr=h(11),tr=h(8),R=h(12),{luaS_bless:N,luaS_new:de}=h(10),q=h(9),{LUA_COMPAT_FLOATSTRING:Re,ldexp:ar,lua_integer2str:Je,lua_number2str:ke}=h(3),w=h(15),{MAX_INT:le,luai_nummod:p,lua_assert:j}=h(4),he=h(14),g=$,z=$+1;class se{constructor(n,l){this.type=n,this.value=l}ttype(){return 63&this.type}ttnov(){return 15&this.type}checktag(n){return this.type===n}checktype(n){return this.ttnov()===n}ttisnumber(){return this.checktype(X)}ttisfloat(){return this.checktag(ee)}ttisinteger(){return this.checktag(Ne)}ttisnil(){return this.checktag(Y)}ttisboolean(){return this.checktag(Be)}ttislightuserdata(){return this.checktag(b)}ttisstring(){return this.checktype(He)}ttisshrstring(){return this.checktag(Fe)}ttislngstring(){return this.checktag(I)}ttistable(){return this.checktag(y)}ttisfunction(){return this.checktype(Ke)}ttisclosure(){return(31&this.type)===Ke}ttisCclosure(){return this.checktag(Me)}ttisLclosure(){return this.checktag(Ye)}ttislcf(){return this.checktag(Pe)}ttisfulluserdata(){return this.checktag(Ue)}ttisthread(){return this.checktag(W)}ttisdeadkey(){return this.checktag(z)}l_isfalse(){return this.ttisnil()||this.ttisboolean()&&this.value===!1}setfltvalue(n){this.type=ee,this.value=n}chgfltvalue(n){j(this.type==ee),this.value=n}setivalue(n){this.type=Ne,this.value=n}chgivalue(n){j(this.type==Ne),this.value=n}setnilvalue(){this.type=Y,this.value=null}setfvalue(n){this.type=Pe,this.value=n}setpvalue(n){this.type=b,this.value=n}setbvalue(n){this.type=Be,this.value=n}setsvalue(n){this.type=I,this.value=n}setuvalue(n){this.type=Ue,this.value=n}setthvalue(n){this.type=W,this.value=n}setclLvalue(n){this.type=Ye,this.value=n}setclCvalue(n){this.type=Me,this.value=n}sethvalue(n){this.type=y,this.value=n}setdeadvalue(){this.type=z,this.value=null}setfrom(n){this.type=n.type,this.value=n.value}tsvalue(){return j(this.ttisstring()),this.value}svalue(){return this.tsvalue().getstr()}vslen(){return this.tsvalue().tsslen()}jsstring(n,l){return k(this.svalue(),n,l,!0)}}const or=function(r,n,l){r.stack[n].setsvalue(l)},ir=new se(Y,null);Object.freeze(ir),e.exports.luaO_nilobject=ir;class cr{constructor(n,l){this.id=n.l_G.id_counter++,this.p=null,this.nupvalues=l,this.upvals=new Array(l)}}class mr{constructor(n,l,a){for(this.id=n.l_G.id_counter++,this.f=l,this.nupvalues=a,this.upvalue=new Array(a);a--;)this.upvalue[a]=new se(Y,null)}}class Sr{constructor(n,l){this.id=n.l_G.id_counter++,this.metatable=null,this.uservalue=new se(Y,null),this.len=l,this.data=Object.create(null)}}const Rr=m("..."),Cr=m('[string "'),_=m('"]'),Oe=function(r){return ie(r)?r-48:(223&r)-55},be=function(r,n){let l=1;if(j(n<=1114111),n<128)r[7]=n;else{let a=63;do r[8-l++]=128|63&n,n>>=6,a>>=1;while(n>a);r[8-l]=~a<<1|n}return l},ge=function(r,n){let l=n==="x"?(function(a){let u,f=0,s=0,U=0,xe=0,Ge=0,Ar=!1;for(;nr(a[f]);)f++;if(((u=a[f]===45)||a[f]===43)&&f++,a[f]!==48||a[f+1]!==120&&a[f+1]!==88)return null;for(f+=2;;f++)if(a[f]===46){if(Ar)break;Ar=!0}else{if(!ze(a[f]))break;U===0&&a[f]===48?xe++:++U<=30?s=16*s+Oe(a[f]):Ge++,Ar&&Ge--}if(xe+U===0)return null;if(Ge*=4,a[f]===112||a[f]===80){let Tr,M=0;if(((Tr=a[++f]===45)||a[f]===43)&&f++,!ie(a[f]))return null;for(;ie(a[f]);)M=10*M+a[f++]-48;Tr&&(M=-M),Ge+=M}return u&&(s=-s),{n:ar(s,Ge),i:f}})(r):(function(a){try{a=k(a)}catch{return null}let u=/^[\t\v\f \n\r]*[+-]?(?:[0-9]+\.?[0-9]*|\.[0-9]*)(?:[eE][+-]?[0-9]+)?/.exec(a);if(!u)return null;let f=parseFloat(u[0]);return isNaN(f)?null:{n:f,i:u[0].length}})(r);if(l===null)return null;for(;nr(r[l.i]);)l.i++;return l.i===r.length||r[l.i]===0?l:null},ae=[46,120,88,110,78],ce={46:".",120:"x",88:"x",110:"n",78:"n"},De=Math.floor(le/10),Lr=le%10,dr=function(r,n){let l;if(n.ttisinteger())l=m(Je(n.value));else{let a=ke(n.value);!Re&&/^[-0123456789]+$/.test(a)&&(a+=".0"),l=m(a)}n.setsvalue(N(r,l))},xr=function(r,n){tr.luaD_inctop(r),or(r,r.top-1,de(r,n))},Mr=function(r,n,l){let a,u=0,f=0,s=0;for(;(a=je(n,37,f))!=-1;){switch(xr(r,n.subarray(f,a)),n[a+1]){case 115:{let U=l[s++];if(U===null)U=m("(null)",!0);else{U=Z(U);let xe=je(U,0);xe!==-1&&(U=U.subarray(0,xe))}xr(r,U);break}case 99:{let U=l[s++];_e(U)?xr(r,d(U)):Qe(r,m("<\\%d>",!0),U);break}case 100:case 73:tr.luaD_inctop(r),r.stack[r.top-1].setivalue(l[s++]),dr(r,r.stack[r.top-1]);break;case 102:tr.luaD_inctop(r),r.stack[r.top-1].setfltvalue(l[s++]),dr(r,r.stack[r.top-1]);break;case 112:{let U=l[s++];if(U instanceof R.lua_State||U instanceof q.Table||U instanceof Sr||U instanceof cr||U instanceof mr)xr(r,m("0x"+U.id.toString(16)));else switch(typeof U){case"undefined":xr(r,m("undefined"));break;case"number":xr(r,m("Number("+U+")"));break;case"string":xr(r,m("String("+JSON.stringify(U)+")"));break;case"boolean":xr(r,m(U?"Boolean(true)":"Boolean(false)"));break;case"object":if(U===null){xr(r,m("null"));break}case"function":{let xe=r.l_G.ids.get(U);xe||(xe=r.l_G.id_counter++,r.l_G.ids.set(U,xe)),xr(r,m("0x"+xe.toString(16)));break}default:xr(r,m("<id NYI>"))}break}case 85:{let U=new Uint8Array(8),xe=be(U,l[s++]);xr(r,U.subarray(8-xe));break}case 37:xr(r,m("%",!0));break;default:rr.luaG_runerror(r,m("invalid option '%%%c' to 'lua_pushfstring'"),n[a+1])}u+=2,f=a+2}return tr.luaD_checkstack(r,1),xr(r,n.subarray(f)),u>0&&w.luaV_concat(r,u+1),r.stack[r.top-1].svalue()},Qe=function(r,n,...l){return Mr(r,n,l)},sr=function(r,n,l,a){switch(n){case T:return l+a|0;case H:return l-a|0;case K:return w.luaV_imul(l,a);case fe:return w.luaV_mod(r,l,a);case C:return w.luaV_div(r,l,a);case A:return l&a;case S:return l|a;case ue:return l^a;case pe:return w.luaV_shiftl(l,a);case Le:return w.luaV_shiftl(l,-a);case oe:return 0-l|0;case G:return-1^l;default:j(0)}},br=function(r,n,l,a){switch(n){case T:return l+a;case H:return l-a;case K:return l*a;case we:return l/a;case Ie:return Math.pow(l,a);case C:return Math.floor(l/a);case oe:return-l;case fe:return p(r,l,a);default:j(0)}};e.exports.CClosure=mr,e.exports.LClosure=cr,e.exports.LUA_TDEADKEY=z,e.exports.LUA_TPROTO=g,e.exports.LocVar=class{constructor(){this.varname=null,this.startpc=NaN,this.endpc=NaN}},e.exports.TValue=se,e.exports.Udata=Sr,e.exports.UTF8BUFFSZ=8,e.exports.luaO_arith=function(r,n,l,a,u){let f=typeof u=="number"?r.stack[u]:u;switch(n){case A:case S:case ue:case pe:case Le:case G:{let s,U;if((s=w.tointeger(l))!==!1&&(U=w.tointeger(a))!==!1)return void f.setivalue(sr(r,n,s,U));break}case we:case Ie:{let s,U;if((s=w.tonumber(l))!==!1&&(U=w.tonumber(a))!==!1)return void f.setfltvalue(br(r,n,s,U));break}default:{let s,U;if(l.ttisinteger()&&a.ttisinteger())return void f.setivalue(sr(r,n,l.value,a.value));if((s=w.tonumber(l))!==!1&&(U=w.tonumber(a))!==!1)return void f.setfltvalue(br(r,n,s,U));break}}j(r!==null),he.luaT_trybinTM(r,l,a,u,n-T+he.TMS.TM_ADD)},e.exports.luaO_chunkid=function(r,n){let l,a=r.length;if(r[0]===61)a<n?(l=new Uint8Array(a-1)).set(r.subarray(1)):(l=new Uint8Array(n)).set(r.subarray(1,n+1));else if(r[0]===64)a<=n?(l=new Uint8Array(a-1)).set(r.subarray(1)):((l=new Uint8Array(n)).set(Rr),n-=Rr.length,l.set(r.subarray(a-n),Rr.length));else{l=new Uint8Array(n);let u=je(r,10);l.set(Cr);let f=Cr.length;a<(n-=Cr.length+Rr.length+_.length)&&u===-1?(l.set(r,f),f+=r.length):(u!==-1&&(a=u),a>n&&(a=n),l.set(r.subarray(0,a),f),f+=a,l.set(Rr,f),f+=Rr.length),l.set(_,f),f+=_.length,l=l.subarray(0,f)}return l},e.exports.luaO_hexavalue=Oe,e.exports.luaO_int2fb=function(r){let n=0;if(r<8)return r;for(;r>=128;)r=r+15>>4,n+=4;for(;r>=16;)r=r+1>>1,n++;return n+1<<3|r-8},e.exports.luaO_pushfstring=Qe,e.exports.luaO_pushvfstring=Mr,e.exports.luaO_str2num=function(r,n){let l=(function(a){let u,f=0,s=0,U=!0;for(;nr(a[f]);)f++;if(((u=a[f]===45)||a[f]===43)&&f++,a[f]!==48||a[f+1]!==120&&a[f+1]!==88)for(;f<a.length&&ie(a[f]);f++){let xe=a[f]-48;if(s>=De&&(s>De||xe>Lr+u))return null;s=10*s+xe|0,U=!1}else for(f+=2;f<a.length&&ze(a[f]);f++)s=16*s+Oe(a[f])|0,U=!1;for(;f<a.length&&nr(a[f]);)f++;return U||f!==a.length&&a[f]!==0?null:{n:0|(u?-s:s),i:f}})(r);return l!==null?(n.setivalue(l.n),l.i+1):(l=(function(a){let u=a.length,f=0;for(let U=0;U<u;U++){let xe=a[U];if(ae.indexOf(xe)!==-1){f=xe;break}}let s=ce[f];return s==="n"?null:ge(a,s)})(r))!==null?(n.setfltvalue(l.n),l.i+1):0},e.exports.luaO_tostring=dr,e.exports.luaO_utf8esc=be,e.exports.numarith=br,e.exports.pushobj2s=function(r,n){r.stack[r.top++]=new se(n.type,n.value)},e.exports.pushsvalue2s=function(r,n){r.stack[r.top++]=new se(I,n)},e.exports.setobjs2s=function(r,n,l){r.stack[n].setfrom(r.stack[l])},e.exports.setobj2s=function(r,n,l){r.stack[n].setfrom(l)},e.exports.setsvalue2s=or},function(e,lr,h){const{LUAL_BUFFERSIZE:T}=h(3),{LUA_ERRERR:A,LUA_MULTRET:G,LUA_REGISTRYINDEX:S,LUA_SIGNATURE:ue,LUA_TBOOLEAN:we,LUA_TLIGHTUSERDATA:C,LUA_TNIL:fe,LUA_TNONE:K,LUA_TNUMBER:Ie,LUA_TSTRING:pe,LUA_TTABLE:Le,LUA_VERSION_NUM:H,lua_Debug:oe,lua_absindex:$,lua_atpanic:Be,lua_call:Me,lua_checkstack:Ke,lua_concat:Pe,lua_copy:Ye,lua_createtable:b,lua_error:I,lua_getfield:Y,lua_getinfo:X,lua_getmetatable:ee,lua_getstack:Ne,lua_gettop:Fe,lua_insert:He,lua_isinteger:y,lua_isnil:W,lua_isnumber:Ue,lua_isstring:Z,lua_istable:je,lua_len:d,lua_load:k,lua_newstate:m,lua_newtable:ie,lua_next:_e,lua_pcall:nr,lua_pop:ze,lua_pushboolean:rr,lua_pushcclosure:tr,lua_pushcfunction:R,lua_pushfstring:N,lua_pushinteger:de,lua_pushliteral:q,lua_pushlstring:Re,lua_pushnil:ar,lua_pushstring:Je,lua_pushvalue:ke,lua_pushvfstring:w,lua_rawequal:le,lua_rawget:p,lua_rawgeti:j,lua_rawlen:he,lua_rawseti:g,lua_remove:z,lua_setfield:se,lua_setglobal:or,lua_setmetatable:ir,lua_settop:cr,lua_toboolean:mr,lua_tointeger:Sr,lua_tointegerx:Rr,lua_tojsstring:Cr,lua_tolstring:_,lua_tonumber:Oe,lua_tonumberx:be,lua_topointer:ge,lua_tostring:ae,lua_touserdata:ce,lua_type:De,lua_typename:Lr,lua_version:dr}=h(2),{from_userstring:xr,luastring_eq:Mr,to_luastring:Qe,to_uristring:sr}=h(5),br=A+1,r=Qe("_LOADED"),n=Qe("_PRELOAD"),l=Qe("FILE*"),a=Qe("__name"),u=Qe("__tostring"),f=new Uint8Array(0);class s{constructor(){this.L=null,this.b=f,this.n=0}}const U=function(o,x,Q){if(Q===0||!je(o,-1))return 0;for(ar(o);_e(o,-2);){if(De(o,-2)===pe){if(le(o,x,-1))return ze(o,1),1;if(U(o,x,Q-1))return z(o,-2),q(o,"."),He(o,-2),Pe(o,3),1}ze(o,1)}return 0},xe=function(o,x){let Q=Fe(o);if(X(o,Qe("f"),x),Y(o,S,r),U(o,Q+1,2)){let qe=ae(o,-1);return qe[0]===95&&qe[1]===71&&qe[2]===46&&(Je(o,qe.subarray(3)),z(o,-2)),Ye(o,-1,Q+1),ze(o,2),1}return cr(o,Q),0},Ge=function(o,x){xe(o,x)?(N(o,Qe("function '%s'"),ae(o,-1)),z(o,-2)):x.namewhat.length!==0?N(o,Qe("%s '%s'"),x.namewhat,x.name):x.what&&x.what[0]===109?q(o,"main chunk"):x.what&&x.what[0]===76?N(o,Qe("function <%s:%d>"),x.short_src,x.linedefined):q(o,"?")},Ar=function(o){let x="PANIC: unprotected error in call to Lua API ("+Cr(o,-1)+")";throw new Error(x)},Tr=function(o,x,Q){let qe=new oe;return Ne(o,0,qe)?(X(o,Qe("n"),qe),Mr(qe.namewhat,Qe("method"))&&--x===0?L(o,Qe("calling '%s' on bad self (%s)"),qe.name,Q):(qe.name===null&&(qe.name=xe(o,qe)?ae(o,-1):Qe("?")),L(o,Qe("bad argument #%d to '%s' (%s)"),x,qe.name,Q))):L(o,Qe("bad argument #%d (%s)"),x,Q)},M=function(o,x,Q){let qe;qe=ve(o,x,a)===pe?ae(o,-1):De(o,x)===C?Qe("light userdata",!0):fr(o,x);let Or=N(o,Qe("%s expected, got %s"),Q,qe);return Tr(o,x,Or)},me=function(o,x){let Q=new oe;Ne(o,x,Q)&&(X(o,Qe("Sl",!0),Q),Q.currentline>0)?N(o,Qe("%s:%d: "),Q.short_src,Q.currentline):Je(o,Qe(""))},L=function(o,x,...Q){return me(o,1),w(o,x,Q),Pe(o,2),I(o)},ne=function(o,x,Q,qe){if(x)return rr(o,1),1;{let Or,yr;return ar(o),qe?(Or=qe.message,yr=-qe.errno):(Or="Success",yr=0),Q?N(o,Qe("%s: %s"),Q,Qe(Or)):Je(o,Qe(Or)),de(o,yr),3}},P=function(o,x){return Y(o,S,x)},Ce=function(o,x,Q){let qe=ce(o,x);return qe!==null&&ee(o,x)?(P(o,Q),le(o,-1,-2)||(qe=null),ze(o,2),qe):null},_r=function(o,x,Q){M(o,x,Lr(o,Q))},fr=function(o,x){return Lr(o,De(o,x))},ur=function(o,x){let Q=_(o,x);return Q!=null||_r(o,x,pe),Q},kr=ur,Br=function(o,x,Q){return De(o,x)<=0?Q===null?null:xr(Q):ur(o,x)},hr=Br,Er=function(o,x){let Q=be(o,x);return Q===!1&&_r(o,x,Ie),Q},vr=function(o,x){let Q=Rr(o,x);return Q===!1&&(function(qe,Or){Ue(qe,Or)?Tr(qe,Or,Qe("number has no integer representation",!0)):_r(qe,Or,Ie)})(o,x),Q},wr=function(o,x){let Q=o.n+x;if(o.b.length<Q){let qe=Math.max(2*o.b.length,Q),Or=new Uint8Array(qe);Or.set(o.b),o.b=Or}return o.b.subarray(o.n,Q)},Ir=function(o,x){x.L=o,x.b=f},Hr=function(o,x,Q){Q>0&&(x=xr(x),wr(o,Q).set(x.subarray(0,Q)),Fr(o,Q))},Vr=function(o,x){x=xr(x),Hr(o,x,x.length)},Xr=function(o){Re(o.L,o.b,o.n),o.n=0,o.b=f},Fr=function(o,x){o.n+=x},c=function(o,x,Q,qe){return De(o,Q)<=0?qe:x(o,Q)},D=function(o,x){let Q=x.string;return x.string=null,Q},Ee=function(o,x,Q,qe,Or){return k(o,D,{string:x},qe,Or)},ye=function(o,x,Q,qe){return Ee(o,x,0,qe,null)},We=function(o,x){return ye(o,x,x.length,x)},ve=function(o,x,Q){if(ee(o,x)){Je(o,Q);let qe=p(o,-2);return qe===fe?ze(o,2):z(o,-2),qe}return fe},Se=function(o,x,Q){return x=$(o,x),ve(o,x,Q)!==fe&&(ke(o,x),Me(o,1,1),!0)},Ae=Qe("%I"),Xe=Qe("%f"),er=function(o,x,Q){var qe=Q>>>0,Or=x.length,yr=o.length+1-Or;e:for(;qe<yr;qe++){for(let jr=0;jr<Or;jr++)if(o[qe+jr]!==x[jr])continue e;return qe}return-1},t=function(o,x,Q){return Y(o,x,Q)===Le||(ze(o,1),x=$(o,x),ie(o),ke(o,-1),se(o,x,Q),!1)},v=function(o,x,Q){O(o,Q,Qe("too many upvalues",!0));for(let qe in x){for(let Or=0;Or<Q;Or++)ke(o,-Q);tr(o,x[qe],Q),se(o,-(Q+2),Qe(qe))}ze(o,Q)},O=function(o,x,Q){Ke(o,x)||(Q?L(o,Qe("stack overflow (%s)"),Q):L(o,Qe("stack overflow",!0)))},F=function(o,x,Q,qe){let Or=qe.message,yr=ae(o,Q).subarray(1);return N(o,Qe("cannot %s %s: %s"),Qe(x),yr,Qe(Or)),z(o,Q),br};let V;const B=[239,187,191],$e=function(o){let x=(function(Q){let qe;Q.n=0;let Or=0;do{if((qe=V(Q))===null||qe!==B[Or])return qe;Or++,Q.buff[Q.n++]=qe}while(Or<B.length);return Q.n=0,V(Q)})(o);if(x===35){do x=V(o);while(x&&x!==10);return{skipped:!0,c:V(o)}}return{skipped:!1,c:x}};let pr;{class o{constructor(){this.n=NaN,this.f=null,this.buff=new Uint8Array(1024),this.pos=0,this.err=void 0}}const x=function(Q,qe){let Or=qe;if(Or.f!==null&&Or.n>0){let jr=Or.n;return Or.n=0,Or.f=Or.f.subarray(Or.pos),Or.buff.subarray(0,jr)}let yr=Or.f;return Or.f=null,yr};V=function(Q){return Q.pos<Q.f.length?Q.f[Q.pos++]:null},pr=function(Q,qe,Or){let yr=new o,jr=Fe(Q)+1;if(qe===null)throw new Error("Can't read stdin in the browser");{N(Q,Qe("@%s"),qe);let Jr=sr(qe),Gr=new XMLHttpRequest;if(Gr.open("GET",Jr,!1),typeof window>"u"&&(Gr.responseType="arraybuffer"),Gr.send(),!(Gr.status>=200&&Gr.status<=299))return yr.err=Gr.status,F(Q,"open",jr,{message:`${Gr.status}: ${Gr.statusText}`});typeof Gr.response=="string"?yr.f=Qe(Gr.response):yr.f=new Uint8Array(Gr.response)}let Zr=$e(yr);Zr.c===ue[0]&&qe||Zr.skipped&&(yr.buff[yr.n++]=10),Zr.c!==null&&(yr.buff[yr.n++]=Zr.c);let Qr=k(Q,x,yr,ae(Q,-1),Or),$r=yr.err;return $r?(cr(Q,jr),F(Q,"read",jr,$r)):(z(Q,jr),Qr)}}const gr=function(o,x){return pr(o,x,null)},Nr=function(o,x,Q){let qe=dr(o);Q!=72&&L(o,Qe("core and library have incompatible numeric types")),qe!=dr(null)?L(o,Qe("multiple Lua VMs detected")):qe!==x&&L(o,Qe("version mismatch: app. needs %f, Lua core provides %f"),x,qe)};e.exports.LUA_ERRFILE=br,e.exports.LUA_FILEHANDLE=l,e.exports.LUA_LOADED_TABLE=r,e.exports.LUA_NOREF=-2,e.exports.LUA_PRELOAD_TABLE=n,e.exports.LUA_REFNIL=-1,e.exports.luaL_Buffer=s,e.exports.luaL_addchar=function(o,x){wr(o,1),o.b[o.n++]=x},e.exports.luaL_addlstring=Hr,e.exports.luaL_addsize=Fr,e.exports.luaL_addstring=Vr,e.exports.luaL_addvalue=function(o){let x=o.L,Q=ae(x,-1);Hr(o,Q,Q.length),ze(x,1)},e.exports.luaL_argcheck=function(o,x,Q,qe){x||Tr(o,Q,qe)},e.exports.luaL_argerror=Tr,e.exports.luaL_buffinit=Ir,e.exports.luaL_buffinitsize=function(o,x,Q){return Ir(o,x),wr(x,Q)},e.exports.luaL_callmeta=Se,e.exports.luaL_checkany=function(o,x){De(o,x)===K&&Tr(o,x,Qe("value expected",!0))},e.exports.luaL_checkinteger=vr,e.exports.luaL_checklstring=ur,e.exports.luaL_checknumber=Er,e.exports.luaL_checkoption=function(o,x,Q,qe){let Or=Q!==null?hr(o,x,Q):kr(o,x);for(let yr=0;qe[yr];yr++)if(Mr(qe[yr],Or))return yr;return Tr(o,x,N(o,Qe("invalid option '%s'"),Or))},e.exports.luaL_checkstack=O,e.exports.luaL_checkstring=kr,e.exports.luaL_checktype=function(o,x,Q){De(o,x)!==Q&&_r(o,x,Q)},e.exports.luaL_checkudata=function(o,x,Q){let qe=Ce(o,x,Q);return qe===null&&M(o,x,Q),qe},e.exports.luaL_checkversion=function(o){Nr(o,H,72)},e.exports.luaL_checkversion_=Nr,e.exports.luaL_dofile=function(o,x){return gr(o,x)||nr(o,0,G,0)},e.exports.luaL_dostring=function(o,x){return We(o,x)||nr(o,0,G,0)},e.exports.luaL_error=L,e.exports.luaL_execresult=function(o,x){let Q,qe;if(x===null)return rr(o,1),q(o,"exit"),de(o,0),3;if(x.status)Q="exit",qe=x.status;else{if(!x.signal)return ne(o,0,null,x);Q="signal",qe=x.signal}return ar(o),q(o,Q),de(o,qe),3},e.exports.luaL_fileresult=ne,e.exports.luaL_getmetafield=ve,e.exports.luaL_getmetatable=P,e.exports.luaL_getsubtable=t,e.exports.luaL_gsub=function(o,x,Q,qe){let Or,yr=new s;for(Ir(o,yr);(Or=er(x,Q))>=0;)Hr(yr,x,Or),Vr(yr,qe),x=x.subarray(Or+Q.length);return Vr(yr,x),Xr(yr),ae(o,-1)},e.exports.luaL_len=function(o,x){d(o,x);let Q=Rr(o,-1);return Q===!1&&L(o,Qe("object length is not an integer",!0)),ze(o,1),Q},e.exports.luaL_loadbuffer=ye,e.exports.luaL_loadbufferx=Ee,e.exports.luaL_loadfile=gr,e.exports.luaL_loadfilex=pr,e.exports.luaL_loadstring=We,e.exports.luaL_newlib=function(o,x){b(o),v(o,x,0)},e.exports.luaL_newlibtable=function(o){b(o)},e.exports.luaL_newmetatable=function(o,x){return P(o,x)!==fe?0:(ze(o,1),b(o,0,2),Je(o,x),se(o,-2,a),ke(o,-1),se(o,S,x),1)},e.exports.luaL_newstate=function(){let o=m();return o&&Be(o,Ar),o},e.exports.luaL_opt=c,e.exports.luaL_optinteger=function(o,x,Q){return c(o,vr,x,Q)},e.exports.luaL_optlstring=Br,e.exports.luaL_optnumber=function(o,x,Q){return c(o,Er,x,Q)},e.exports.luaL_optstring=hr,e.exports.luaL_prepbuffer=function(o){return wr(o,T)},e.exports.luaL_prepbuffsize=wr,e.exports.luaL_pushresult=Xr,e.exports.luaL_pushresultsize=function(o,x){Fr(o,x),Xr(o)},e.exports.luaL_ref=function(o,x){let Q;return W(o,-1)?(ze(o,1),-1):(x=$(o,x),j(o,x,0),Q=Sr(o,-1),ze(o,1),Q!==0?(j(o,x,Q),g(o,x,0)):Q=he(o,x)+1,g(o,x,Q),Q)},e.exports.luaL_requiref=function(o,x,Q,qe){t(o,S,r),Y(o,-1,x),mr(o,-1)||(ze(o,1),R(o,Q),Je(o,x),Me(o,1,1),ke(o,-1),se(o,-3,x)),z(o,-2),qe&&(ke(o,-1),or(o,x))},e.exports.luaL_setfuncs=v,e.exports.luaL_setmetatable=function(o,x){P(o,x),ir(o,-2)},e.exports.luaL_testudata=Ce,e.exports.luaL_tolstring=function(o,x){if(Se(o,x,u))Z(o,-1)||L(o,Qe("'__tostring' must return a string"));else switch(De(o,x)){case Ie:y(o,x)?N(o,Ae,Sr(o,x)):N(o,Xe,Oe(o,x));break;case pe:ke(o,x);break;case we:q(o,mr(o,x)?"true":"false");break;case fe:q(o,"nil");break;default:{let Q=ve(o,x,a),qe=Q===pe?ae(o,-1):fr(o,x);N(o,Qe("%s: %p"),qe,ge(o,x)),Q!==fe&&z(o,-2);break}}return _(o,-1)},e.exports.luaL_traceback=function(o,x,Q,qe){let Or=new oe,yr=Fe(o),jr=(function(Qr){let $r=new oe,Jr=1,Gr=1;for(;Ne(Qr,Gr,$r);)Jr=Gr,Gr*=2;for(;Jr<Gr;){let qr=Math.floor((Jr+Gr)/2);Ne(Qr,qr,$r)?Jr=qr+1:Gr=qr}return Gr-1})(x),Zr=jr-qe>21?10:-1;for(Q&&N(o,Qe(`%s
`),Q),O(o,10,null),q(o,"stack traceback:");Ne(x,qe++,Or);)Zr--==0?(q(o,`
	...`),qe=jr-11+1):(X(x,Qe("Slnt",!0),Or),N(o,Qe(`
	%s:`),Or.short_src),Or.currentline>0&&q(o,`${Or.currentline}:`),q(o," in "),Ge(o,Or),Or.istailcall&&q(o,`
	(...tail calls..)`),Pe(o,Fe(o)-yr));Pe(o,Fe(o)-yr)},e.exports.luaL_typename=fr,e.exports.luaL_unref=function(o,x,Q){Q>=0&&(x=$(o,x),j(o,x,0),g(o,x,Q),de(o,Q),g(o,x,0))},e.exports.luaL_where=me,e.exports.lua_writestringerror=function(){for(let o=0;o<arguments.length;o++){let x=arguments[o];do{let Q=/([^\n]*)\n?([\d\D]*)/.exec(x);console.error(Q[1]),x=Q[2]}while(x!=="")}}},function(e,lr,h){const{LUA_HOOKCALL:T,LUA_HOOKRET:A,LUA_HOOKTAILCALL:G,LUA_MASKCALL:S,LUA_MASKLINE:ue,LUA_MASKRET:we,LUA_MINSTACK:C,LUA_MULTRET:fe,LUA_SIGNATURE:K,constant_types:{LUA_TCCL:Ie,LUA_TLCF:pe,LUA_TLCL:Le,LUA_TNIL:H},thread_status:{LUA_ERRMEM:oe,LUA_ERRERR:$,LUA_ERRRUN:Be,LUA_ERRSYNTAX:Me,LUA_OK:Ke,LUA_YIELD:Pe},lua_Debug:Ye,luastring_indexOf:b,to_luastring:I}=h(1),Y=h(18),X=h(11),ee=h(13),{api_check:Ne,lua_assert:Fe,LUAI_MAXCCALLS:He}=h(4),y=h(6),W=h(16),Ue=h(23),Z=h(12),{luaS_newliteral:je}=h(10),d=h(14),{LUAI_MAXSTACK:k}=h(3),m=h(36),ie=h(15),{MBuffer:_e}=h(19),nr=function(_,Oe){if(_.top<Oe)for(;_.top<Oe;)_.stack[_.top++]=new y.TValue(H,null);else for(;_.top>Oe;)delete _.stack[--_.top]},ze=function(_,Oe,be){let ge=_.top;for(;_.top<be+1;)_.stack[_.top++]=new y.TValue(H,null);switch(Oe){case oe:y.setsvalue2s(_,be,je(_,"not enough memory"));break;case $:y.setsvalue2s(_,be,je(_,"error in error handling"));break;default:y.setobjs2s(_,be,ge-1)}for(;_.top>be+1;)delete _.stack[--_.top]},rr=k+200,tr=function(_,Oe){Fe(Oe<=k||Oe==rr),Fe(_.stack_last==_.stack.length-Z.EXTRA_STACK),_.stack.length=Oe,_.stack_last=Oe-Z.EXTRA_STACK},R=function(_,Oe){let be=_.stack.length;if(be>k)j(_,$);else{let ge=_.top+Oe+Z.EXTRA_STACK,ae=2*be;ae>k&&(ae=k),ae<ge&&(ae=ge),ae>k?(tr(_,rr),X.luaG_runerror(_,I("stack overflow",!0))):tr(_,ae)}},N=function(_,Oe){_.stack_last-_.top<=Oe&&R(_,Oe)},de=function(_){let Oe=(function(ge){let ae=ge.top;for(let ce=ge.ci;ce!==null;ce=ce.previous)ae<ce.top&&(ae=ce.top);return Fe(ae<=ge.stack_last),ae+1})(_),be=Oe+Math.floor(Oe/8)+2*Z.EXTRA_STACK;be>k&&(be=k),_.stack.length>k&&Z.luaE_freeCI(_),Oe<=k-Z.EXTRA_STACK&&be<_.stack.length&&tr(_,be)},q=function(_,Oe,be){let ge=_.stack[Oe];switch(ge.type){case Ie:case pe:{let ae=ge.type===Ie?ge.value.f:ge.value;N(_,C);let ce=Z.luaE_extendCI(_);ce.funcOff=Oe,ce.nresults=be,ce.func=ge,ce.top=_.top+C,Fe(ce.top<=_.stack_last),ce.callstatus=0,_.hookmask&S&&Je(_,T,-1);let De=ae(_);if(typeof De!="number"||De<0||(0|De)!==De)throw Error("invalid return value from JS function (expected integer)");return Y.api_checknelems(_,De),Re(_,ce,_.top-De,De),!0}case Le:{let ae,ce=ge.value.p,De=_.top-Oe-1,Lr=ce.maxstacksize;if(N(_,Lr),ce.is_vararg)ae=w(_,ce,De);else{for(;De<ce.numparams;De++)_.stack[_.top++]=new y.TValue(H,null);ae=Oe+1}let dr=Z.luaE_extendCI(_);return dr.funcOff=Oe,dr.nresults=be,dr.func=ge,dr.l_base=ae,dr.top=ae+Lr,nr(_,dr.top),dr.l_code=ce.code,dr.l_savedpc=0,dr.callstatus=Z.CIST_LUA,_.hookmask&S&&ke(_,dr),!1}default:return N(_,1),le(_,Oe,ge),q(_,Oe,be)}},Re=function(_,Oe,be,ge){let ae=Oe.nresults;_.hookmask&(we|ue)&&(_.hookmask&we&&Je(_,A,-1),_.oldpc=Oe.previous.l_savedpc);let ce=Oe.funcOff;return _.ci=Oe.previous,_.ci.next=null,ar(_,be,ce,ge,ae)},ar=function(_,Oe,be,ge,ae){switch(ae){case 0:break;case 1:ge===0?_.stack[be].setnilvalue():y.setobjs2s(_,be,Oe);break;case fe:for(let De=0;De<ge;De++)y.setobjs2s(_,be+De,Oe+De);for(let De=_.top;De>=be+ge;De--)delete _.stack[De];return _.top=be+ge,!1;default:{let De;if(ae<=ge)for(De=0;De<ae;De++)y.setobjs2s(_,be+De,Oe+De);else{for(De=0;De<ge;De++)y.setobjs2s(_,be+De,Oe+De);for(;De<ae;De++)be+De>=_.top?_.stack[be+De]=new y.TValue(H,null):_.stack[be+De].setnilvalue()}break}}let ce=be+ae;for(let De=_.top;De>=ce;De--)delete _.stack[De];return _.top=ce,!0},Je=function(_,Oe,be){let ge=_.hook;if(ge&&_.allowhook){let ae=_.ci,ce=_.top,De=ae.top,Lr=new Ye;Lr.event=Oe,Lr.currentline=be,Lr.i_ci=ae,N(_,C),ae.top=_.top+C,Fe(ae.top<=_.stack_last),_.allowhook=0,ae.callstatus|=Z.CIST_HOOKED,ge(_,Lr),Fe(!_.allowhook),_.allowhook=1,ae.top=De,nr(_,ce),ae.callstatus&=~Z.CIST_HOOKED}},ke=function(_,Oe){let be=T;Oe.l_savedpc++,Oe.previous.callstatus&Z.CIST_LUA&&Oe.previous.l_code[Oe.previous.l_savedpc-1].opcode==W.OpCodesI.OP_TAILCALL&&(Oe.callstatus|=Z.CIST_TAIL,be=G),Je(_,be,-1),Oe.l_savedpc--},w=function(_,Oe,be){let ge,ae=Oe.numparams,ce=_.top-be,De=_.top;for(ge=0;ge<ae&&ge<be;ge++)y.pushobj2s(_,_.stack[ce+ge]),_.stack[ce+ge].setnilvalue();for(;ge<ae;ge++)_.stack[_.top++]=new y.TValue(H,null);return De},le=function(_,Oe,be){let ge=d.luaT_gettmbyobj(_,be,d.TMS.TM_CALL);ge.ttisfunction(ge)||X.luaG_typeerror(_,be,I("call",!0)),y.pushobj2s(_,_.stack[_.top-1]);for(let ae=_.top-2;ae>Oe;ae--)y.setobjs2s(_,ae,ae-1);y.setobj2s(_,Oe,ge)},p=function(_,Oe,be){++_.nCcalls>=He&&(function(ge){ge.nCcalls===He?X.luaG_runerror(ge,I("JS stack overflow",!0)):ge.nCcalls>=He+(He>>3)&&j(ge,$)})(_),q(_,Oe,be)||ie.luaV_execute(_),_.nCcalls--},j=function(_,Oe){if(_.errorJmp)throw _.errorJmp.status=Oe,_.errorJmp;{let be=_.l_G;if(_.status=Oe,!be.mainthread.errorJmp){let ge=be.panic;throw ge&&(ze(_,Oe,_.top),_.ci.top<_.top&&(_.ci.top=_.top),ge(_)),new Error(`Aborted ${Oe}`)}be.mainthread.stack[be.mainthread.top++]=_.stack[_.top-1],j(be.mainthread,Oe)}},he=function(_,Oe,be){let ge=_.nCcalls,ae={status:Ke,previous:_.errorJmp};_.errorJmp=ae;try{Oe(_,be)}catch(ce){if(ae.status===Ke){let De=_.l_G.atnativeerror;if(De)try{if(ae.status=Ke,Y.lua_pushcfunction(_,De),Y.lua_pushlightuserdata(_,ce),Sr(_,_.top-2,1),_.errfunc!==0){let Lr=_.errfunc;y.pushobj2s(_,_.stack[_.top-1]),y.setobjs2s(_,_.top-2,Lr),Sr(_,_.top-2,1)}ae.status=Be}catch{ae.status===Ke&&(ae.status=-1)}else ae.status=-1}}return _.errorJmp=ae.previous,_.nCcalls=ge,ae.status},g=function(_,Oe){let be=_.ci;Fe(be.c_k!==null&&_.nny===0),Fe(be.callstatus&Z.CIST_YPCALL||Oe===Pe),be.callstatus&Z.CIST_YPCALL&&(be.callstatus&=~Z.CIST_YPCALL,_.errfunc=be.c_old_errfunc),be.nresults===fe&&_.ci.top<_.top&&(_.ci.top=_.top);let ge=(0,be.c_k)(_,Oe,be.c_ctx);Y.api_checknelems(_,ge),Re(_,be,_.top-ge,ge)},z=function(_,Oe){for(Oe!==null&&g(_,Oe);_.ci!==_.base_ci;)_.ci.callstatus&Z.CIST_LUA?(ie.luaV_finishOp(_),ie.luaV_execute(_)):g(_,Pe)},se=function(_,Oe){let be=(function(ae){for(let ce=ae.ci;ce!==null;ce=ce.previous)if(ce.callstatus&Z.CIST_YPCALL)return ce;return null})(_);if(be===null)return 0;let ge=be.extra;return ee.luaF_close(_,ge),ze(_,Oe,ge),_.ci=be,_.allowhook=be.callstatus&Z.CIST_OAH,_.nny=0,de(_),_.errfunc=be.c_old_errfunc,1},or=function(_,Oe,be){let ge=je(_,Oe);if(be===0)y.pushsvalue2s(_,ge),Ne(_,_.top<=_.ci.top,"stack overflow");else{for(let ae=1;ae<be;ae++)delete _.stack[--_.top];y.setsvalue2s(_,_.top-1,ge)}return Be},ir=function(_,Oe){let be=_.top-Oe,ge=_.ci;_.status===Ke?q(_,be-1,fe)||ie.luaV_execute(_):(Fe(_.status===Pe),_.status=Ke,ge.funcOff=ge.extra,ge.func=_.stack[ge.funcOff],ge.callstatus&Z.CIST_LUA?ie.luaV_execute(_):(ge.c_k!==null&&(Oe=ge.c_k(_,Pe,ge.c_ctx),Y.api_checknelems(_,Oe),be=_.top-Oe),Re(_,ge,be,Oe)),z(_,null))},cr=function(_,Oe,be,ge){let ae=_.ci;return Y.api_checknelems(_,Oe),_.nny>0&&(_!==_.l_G.mainthread?X.luaG_runerror(_,I("attempt to yield across a JS-call boundary",!0)):X.luaG_runerror(_,I("attempt to yield from outside a coroutine",!0))),_.status=Pe,ae.extra=ae.funcOff,ae.callstatus&Z.CIST_LUA?Ne(_,ge===null,"hooks cannot continue after yielding"):(ae.c_k=ge,ge!==null&&(ae.c_ctx=be),ae.funcOff=_.top-Oe-1,ae.func=_.stack[ae.funcOff],j(_,Pe)),Fe(ae.callstatus&Z.CIST_HOOKED),0},mr=function(_,Oe,be,ge,ae){let ce=_.ci,De=_.allowhook,Lr=_.nny,dr=_.errfunc;_.errfunc=ae;let xr=he(_,Oe,be);return xr!==Ke&&(ee.luaF_close(_,ge),ze(_,xr,ge),_.ci=ce,_.allowhook=De,_.nny=Lr,de(_)),_.errfunc=dr,xr},Sr=function(_,Oe,be){_.nny++,p(_,Oe,be),_.nny--},Rr=function(_,Oe,be){Oe&&b(Oe,be[0])===-1&&(y.luaO_pushfstring(_,I("attempt to load a %s chunk (mode is '%s')"),be,Oe),j(_,Me))},Cr=function(_,Oe){let be,ge=Oe.z.zgetc();ge===K[0]?(Rr(_,Oe.mode,I("binary",!0)),be=m.luaU_undump(_,Oe.z,Oe.name)):(Rr(_,Oe.mode,I("text",!0)),be=Ue.luaY_parser(_,Oe.z,Oe.buff,Oe.dyd,Oe.name,ge)),Fe(be.nupvalues===be.p.upvalues.length),ee.luaF_initupvals(_,be)};e.exports.adjust_top=nr,e.exports.luaD_call=p,e.exports.luaD_callnoyield=Sr,e.exports.luaD_checkstack=N,e.exports.luaD_growstack=R,e.exports.luaD_hook=Je,e.exports.luaD_inctop=function(_){N(_,1),_.stack[_.top++]=new y.TValue(H,null)},e.exports.luaD_pcall=mr,e.exports.luaD_poscall=Re,e.exports.luaD_precall=q,e.exports.luaD_protectedparser=function(_,Oe,be,ge){let ae=new class{constructor(De,Lr,dr){this.z=De,this.buff=new _e,this.dyd=new Ue.Dyndata,this.mode=dr,this.name=Lr}}(Oe,be,ge);_.nny++;let ce=mr(_,Cr,ae,_.top,_.errfunc);return _.nny--,ce},e.exports.luaD_rawrunprotected=he,e.exports.luaD_reallocstack=tr,e.exports.luaD_throw=j,e.exports.lua_isyieldable=function(_){return _.nny===0},e.exports.lua_resume=function(_,Oe,be){let ge=_.nny;if(_.status===Ke){if(_.ci!==_.base_ci)return or(_,"cannot resume non-suspended coroutine",be)}else if(_.status!==Pe)return or(_,"cannot resume dead coroutine",be);if(_.nCcalls=Oe?Oe.nCcalls+1:1,_.nCcalls>=He)return or(_,"JS stack overflow",be);_.nny=0,Y.api_checknelems(_,_.status===Ke?be+1:be);let ae=he(_,ir,be);if(ae===-1)ae=Be;else{for(;ae>Pe&&se(_,ae);)ae=he(_,z,ae);ae>Pe?(_.status=ae,ze(_,ae,_.top),_.ci.top=_.top):Fe(ae===_.status)}return _.nny=ge,_.nCcalls--,Fe(_.nCcalls===(Oe?Oe.nCcalls:0)),ae},e.exports.lua_yield=function(_,Oe){cr(_,Oe,0,null)},e.exports.lua_yieldk=cr},function(e,lr,h){const{constant_types:{LUA_TBOOLEAN:T,LUA_TCCL:A,LUA_TLCF:G,LUA_TLCL:S,LUA_TLIGHTUSERDATA:ue,LUA_TLNGSTR:we,LUA_TNIL:C,LUA_TNUMFLT:fe,LUA_TNUMINT:K,LUA_TSHRSTR:Ie,LUA_TTABLE:pe,LUA_TTHREAD:Le,LUA_TUSERDATA:H},to_luastring:oe}=h(1),{lua_assert:$}=h(4),Be=h(11),Me=h(6),{luaS_hashlongstr:Ke,TString:Pe}=h(10),Ye=h(12);let b=new WeakMap;const I=function(y){let W=b.get(y);return W||(W={},b.set(y,W)),W},Y=function(y,W){switch(W.type){case C:return Be.luaG_runerror(y,oe("table index is nil",!0));case fe:if(isNaN(W.value))return Be.luaG_runerror(y,oe("table index is NaN",!0));case K:case T:case pe:case S:case G:case A:case H:case Le:return W.value;case Ie:case we:return Ke(W.tsvalue());case ue:{let Ue=W.value;switch(typeof Ue){case"string":return"*"+Ue;case"number":return"#"+Ue;case"boolean":return Ue?"?true":"?false";case"function":return I(Ue);case"object":if(Ue instanceof Ye.lua_State&&Ue.l_G===y.l_G||Ue instanceof X||Ue instanceof Me.Udata||Ue instanceof Me.LClosure||Ue instanceof Me.CClosure)return I(Ue);default:return Ue}}default:throw new Error("unknown key type: "+W.type)}};class X{constructor(W){this.id=W.l_G.id_counter++,this.strong=new Map,this.dead_strong=new Map,this.dead_weak=void 0,this.f=void 0,this.l=void 0,this.metatable=null,this.flags=-1}}const ee=function(y,W,Ue,Z){y.dead_strong.clear(),y.dead_weak=void 0;let je=null,d={key:Ue,value:Z,p:je=y.l,n:void 0};y.f||(y.f=d),je&&(je.n=d),y.strong.set(W,d),y.l=d},Ne=function(y,W){let Ue=y.strong.get(W);if(Ue){Ue.key.setdeadvalue(),Ue.value=void 0;let Z=Ue.n,je=Ue.p;Ue.p=void 0,je&&(je.n=Z),Z&&(Z.p=je),y.f===Ue&&(y.f=Z),y.l===Ue&&(y.l=je),y.strong.delete(W),(function(d){return typeof d=="object"?d!==null:typeof d=="function"})(W)?(y.dead_weak||(y.dead_weak=new WeakMap),y.dead_weak.set(W,Ue)):y.dead_strong.set(W,Ue)}},Fe=function(y,W){let Ue=y.strong.get(W);return Ue?Ue.value:Me.luaO_nilobject},He=function(y,W){return $(typeof W=="number"&&(0|W)===W),Fe(y,W)};e.exports.invalidateTMcache=function(y){y.flags=0},e.exports.luaH_get=function(y,W,Ue){return $(Ue instanceof Me.TValue),Ue.ttisnil()||Ue.ttisfloat()&&isNaN(Ue.value)?Me.luaO_nilobject:Fe(W,Y(y,Ue))},e.exports.luaH_getint=He,e.exports.luaH_getn=function(y){let W=0,Ue=y.strong.size+1;for(;Ue-W>1;){let Z=Math.floor((W+Ue)/2);He(y,Z).ttisnil()?Ue=Z:W=Z}return W},e.exports.luaH_getstr=function(y,W){return $(W instanceof Pe),Fe(y,Ke(W))},e.exports.luaH_setfrom=function(y,W,Ue,Z){$(Ue instanceof Me.TValue);let je=Y(y,Ue);if(Z.ttisnil())return void Ne(W,je);let d=W.strong.get(je);if(d)d.value.setfrom(Z);else{let k,m=Ue.value;k=Ue.ttisfloat()&&(0|m)===m?new Me.TValue(K,m):new Me.TValue(Ue.type,m);let ie=new Me.TValue(Z.type,Z.value);ee(W,je,k,ie)}},e.exports.luaH_setint=function(y,W,Ue){$(typeof W=="number"&&(0|W)===W&&Ue instanceof Me.TValue);let Z=W;if(Ue.ttisnil())return void Ne(y,Z);let je=y.strong.get(Z);if(je)je.value.setfrom(Ue);else{let d=new Me.TValue(K,W),k=new Me.TValue(Ue.type,Ue.value);ee(y,Z,d,k)}},e.exports.luaH_new=function(y){return new X(y)},e.exports.luaH_next=function(y,W,Ue){let Z,je=y.stack[Ue];if(je.type===C){if(!(Z=W.f))return!1}else{let d=Y(y,je);if(Z=W.strong.get(d)){if(!(Z=Z.n))return!1}else{if(!(Z=W.dead_weak&&W.dead_weak.get(d)||W.dead_strong.get(d)))return Be.luaG_runerror(y,oe("invalid key to 'next'"));do if(!(Z=Z.n))return!1;while(Z.key.ttisdeadkey())}}return Me.setobj2s(y,Ue,Z.key),Me.setobj2s(y,Ue+1,Z.value),!0},e.exports.Table=X},function(e,lr,h){const{is_luastring:T,luastring_eq:A,luastring_from:G,to_luastring:S}=h(1),{lua_assert:ue}=h(4);class we{constructor(Ie,pe){this.hash=null,this.realstring=pe}getstr(){return this.realstring}tsslen(){return this.realstring.length}}const C=function(K){ue(T(K));let Ie=K.length,pe="|";for(let Le=0;Le<Ie;Le++)pe+=K[Le].toString(16);return pe},fe=function(K,Ie){return ue(Ie instanceof Uint8Array),new we(K,Ie)};e.exports.luaS_eqlngstr=function(K,Ie){return ue(K instanceof we),ue(Ie instanceof we),K==Ie||A(K.realstring,Ie.realstring)},e.exports.luaS_hash=C,e.exports.luaS_hashlongstr=function(K){return ue(K instanceof we),K.hash===null&&(K.hash=C(K.getstr())),K.hash},e.exports.luaS_bless=fe,e.exports.luaS_new=function(K,Ie){return fe(K,G(Ie))},e.exports.luaS_newliteral=function(K,Ie){return fe(K,S(Ie))},e.exports.TString=we},function(e,lr,h){const{LUA_HOOKCOUNT:T,LUA_HOOKLINE:A,LUA_MASKCOUNT:G,LUA_MASKLINE:S,constant_types:{LUA_TBOOLEAN:ue,LUA_TNIL:we,LUA_TTABLE:C},thread_status:{LUA_ERRRUN:fe,LUA_YIELD:K},from_userstring:Ie,luastring_eq:pe,luastring_indexOf:Le,to_luastring:H}=h(1),{api_check:oe,lua_assert:$}=h(4),{LUA_IDSIZE:Be}=h(3),Me=h(18),Ke=h(8),Pe=h(13),Ye=h(20),b=h(6),I=h(16),Y=h(12),X=h(9),ee=h(14),Ne=h(15),Fe=function(R){return $(R.callstatus&Y.CIST_LUA),R.l_savedpc-1},He=function(R){return R.func.value.p.lineinfo.length!==0?R.func.value.p.lineinfo[Fe(R)]:-1},y=function(R){if(R.status===K){let N=R.ci,de=N.funcOff;N.func=R.stack[N.extra],N.funcOff=N.extra,N.extra=de}},W=function(R,N){$(N<R.upvalues.length);let de=R.upvalues[N].name;return de===null?H("?",!0):de.getstr()},Ue=function(R,N,de){let q,Re=null;if(N.callstatus&Y.CIST_LUA){if(de<0)return(function(ar,Je){let ke=ar.func.value.p.numparams;return Je>=ar.l_base-ar.funcOff-ke?null:{pos:ar.funcOff+ke+Je,name:H("(*vararg)",!0)}})(N,-de);q=N.l_base,Re=Pe.luaF_getlocalname(N.func.value.p,de,Fe(N))}else q=N.funcOff+1;if(Re===null){if(!((N===R.ci?R.top:N.next.funcOff)-q>=de&&de>0))return null;Re=H("(*temporary)",!0)}return{pos:q+(de-1),name:Re}},Z=function(R,N){if(N===null||N instanceof b.CClosure)R.source=H("=[JS]",!0),R.linedefined=-1,R.lastlinedefined=-1,R.what=H("J",!0);else{let de=N.p;R.source=de.source?de.source.getstr():H("=?",!0),R.linedefined=de.linedefined,R.lastlinedefined=de.lastlinedefined,R.what=R.linedefined===0?H("main",!0):H("Lua",!0)}R.short_src=b.luaO_chunkid(R.source,Be)},je=function(R,N){let de={name:null,funcname:null};return N===null?null:N.callstatus&Y.CIST_FIN?(de.name=H("__gc",!0),de.funcname=H("metamethod",!0),de):!(N.callstatus&Y.CIST_TAIL)&&N.previous.callstatus&Y.CIST_LUA?ie(R,N.previous):null},d=function(R,N,de){let q={name:null,funcname:null};if(I.ISK(de)){let Re=R.k[I.INDEXK(de)];if(Re.ttisstring())return q.name=Re.svalue(),q}else{let Re=m(R,N,de);if(Re&&Re.funcname[0]===99)return Re}return q.name=H("?",!0),q},k=function(R,N){return R<N?-1:R},m=function(R,N,de){let q={name:Pe.luaF_getlocalname(R,de+1,N),funcname:null};if(q.name)return q.funcname=H("local",!0),q;let Re=(function(Je,ke,w){let le=-1,p=0,j=I.OpCodesI;for(let he=0;he<ke;he++){let g=Je.code[he],z=g.A;switch(g.opcode){case j.OP_LOADNIL:{let se=g.B;z<=w&&w<=z+se&&(le=k(he,p));break}case j.OP_TFORCALL:w>=z+2&&(le=k(he,p));break;case j.OP_CALL:case j.OP_TAILCALL:w>=z&&(le=k(he,p));break;case j.OP_JMP:{let se=he+1+g.sBx;he<se&&se<=ke&&se>p&&(p=se);break}default:I.testAMode(g.opcode)&&w===z&&(le=k(he,p))}}return le})(R,N,de),ar=I.OpCodesI;if(Re!==-1){let Je=R.code[Re];switch(Je.opcode){case ar.OP_MOVE:{let ke=Je.B;if(ke<Je.A)return m(R,Re,ke);break}case ar.OP_GETTABUP:case ar.OP_GETTABLE:{let ke=Je.C,w=Je.B,le=Je.opcode===ar.OP_GETTABLE?Pe.luaF_getlocalname(R,w+1,Re):W(R,w);return q.name=d(R,Re,ke).name,q.funcname=le&&pe(le,Ye.LUA_ENV)?H("global",!0):H("field",!0),q}case ar.OP_GETUPVAL:return q.name=W(R,Je.B),q.funcname=H("upvalue",!0),q;case ar.OP_LOADK:case ar.OP_LOADKX:{let ke=Je.opcode===ar.OP_LOADK?Je.Bx:R.code[Re+1].Ax;if(R.k[ke].ttisstring())return q.name=R.k[ke].svalue(),q.funcname=H("constant",!0),q;break}case ar.OP_SELF:{let ke=Je.C;return q.name=d(R,Re,ke).name,q.funcname=H("method",!0),q}}}return null},ie=function(R,N){let de={name:null,funcname:null},q=0,Re=N.func.value.p,ar=Fe(N),Je=Re.code[ar],ke=I.OpCodesI;if(N.callstatus&Y.CIST_HOOKED)return de.name=H("?",!0),de.funcname=H("hook",!0),de;switch(Je.opcode){case ke.OP_CALL:case ke.OP_TAILCALL:return m(Re,ar,Je.A);case ke.OP_TFORCALL:return de.name=H("for iterator",!0),de.funcname=H("for iterator",!0),de;case ke.OP_SELF:case ke.OP_GETTABUP:case ke.OP_GETTABLE:q=ee.TMS.TM_INDEX;break;case ke.OP_SETTABUP:case ke.OP_SETTABLE:q=ee.TMS.TM_NEWINDEX;break;case ke.OP_ADD:q=ee.TMS.TM_ADD;break;case ke.OP_SUB:q=ee.TMS.TM_SUB;break;case ke.OP_MUL:q=ee.TMS.TM_MUL;break;case ke.OP_MOD:q=ee.TMS.TM_MOD;break;case ke.OP_POW:q=ee.TMS.TM_POW;break;case ke.OP_DIV:q=ee.TMS.TM_DIV;break;case ke.OP_IDIV:q=ee.TMS.TM_IDIV;break;case ke.OP_BAND:q=ee.TMS.TM_BAND;break;case ke.OP_BOR:q=ee.TMS.TM_BOR;break;case ke.OP_BXOR:q=ee.TMS.TM_BXOR;break;case ke.OP_SHL:q=ee.TMS.TM_SHL;break;case ke.OP_SHR:q=ee.TMS.TM_SHR;break;case ke.OP_UNM:q=ee.TMS.TM_UNM;break;case ke.OP_BNOT:q=ee.TMS.TM_BNOT;break;case ke.OP_LEN:q=ee.TMS.TM_LEN;break;case ke.OP_CONCAT:q=ee.TMS.TM_CONCAT;break;case ke.OP_EQ:q=ee.TMS.TM_EQ;break;case ke.OP_LT:q=ee.TMS.TM_LT;break;case ke.OP_LE:q=ee.TMS.TM_LE;break;default:return null}return de.name=R.l_G.tmname[q].getstr(),de.funcname=H("metamethod",!0),de},_e=function(R,N){let de=R.ci,q=null;if(de.callstatus&Y.CIST_LUA){q=(function(ar,Je,ke){let w=Je.func.value;for(let le=0;le<w.nupvalues;le++)if(w.upvals[le]===ke)return{name:W(w.p,le),funcname:H("upvalue",!0)};return null})(0,de,N);let Re=(function(ar,Je,ke){for(let w=Je.l_base;w<Je.top;w++)if(ar.stack[w]===ke)return w;return!1})(R,de,N);!q&&Re&&(q=m(de.func.value.p,Fe(de),Re-de.l_base))}return q?b.luaO_pushfstring(R,H(" (%s '%s')",!0),q.funcname,q.name):H("",!0)},nr=function(R,N,de){let q=ee.luaT_objtypename(R,N);rr(R,H("attempt to %s a %s value%s",!0),de,q,_e(R,N))},ze=function(R,N,de,q){let Re;return Re=de?b.luaO_chunkid(de.getstr(),Be):H("?",!0),b.luaO_pushfstring(R,H("%s:%d: %s",!0),Re,q,N)},rr=function(R,N,...de){let q=R.ci,Re=b.luaO_pushvfstring(R,N,de);q.callstatus&Y.CIST_LUA&&ze(R,Re,q.func.value.p.source,He(q)),tr(R)},tr=function(R){if(R.errfunc!==0){let N=R.errfunc;b.pushobj2s(R,R.stack[R.top-1]),b.setobjs2s(R,R.top-2,N),Ke.luaD_callnoyield(R,R.top-2,1)}Ke.luaD_throw(R,fe)};e.exports.luaG_addinfo=ze,e.exports.luaG_concaterror=function(R,N,de){(N.ttisstring()||Ne.cvt2str(N))&&(N=de),nr(R,N,H("concatenate",!0))},e.exports.luaG_errormsg=tr,e.exports.luaG_opinterror=function(R,N,de,q){Ne.tonumber(N)===!1&&(de=N),nr(R,de,q)},e.exports.luaG_ordererror=function(R,N,de){let q=ee.luaT_objtypename(R,N),Re=ee.luaT_objtypename(R,de);pe(q,Re)?rr(R,H("attempt to compare two %s values",!0),q):rr(R,H("attempt to compare %s with %s",!0),q,Re)},e.exports.luaG_runerror=rr,e.exports.luaG_tointerror=function(R,N,de){Ne.tointeger(N)===!1&&(de=N),rr(R,H("number%s has no integer representation",!0),_e(R,de))},e.exports.luaG_traceexec=function(R){let N=R.ci,de=R.hookmask,q=--R.hookcount==0&&de&G;if(q)R.hookcount=R.basehookcount;else if(!(de&S))return;if(N.callstatus&Y.CIST_HOOKYIELD)N.callstatus&=~Y.CIST_HOOKYIELD;else{if(q&&Ke.luaD_hook(R,T,-1),de&S){let Re=N.func.value.p,ar=N.l_savedpc-1,Je=Re.lineinfo.length!==0?Re.lineinfo[ar]:-1;(ar===0||N.l_savedpc<=R.oldpc||Je!==(Re.lineinfo.length!==0?Re.lineinfo[R.oldpc-1]:-1))&&Ke.luaD_hook(R,A,Je)}R.oldpc=N.l_savedpc,R.status===K&&(q&&(R.hookcount=1),N.l_savedpc--,N.callstatus|=Y.CIST_HOOKYIELD,N.funcOff=R.top-1,N.func=R.stack[N.funcOff],Ke.luaD_throw(R,K))}},e.exports.luaG_typeerror=nr,e.exports.lua_gethook=function(R){return R.hook},e.exports.lua_gethookcount=function(R){return R.basehookcount},e.exports.lua_gethookmask=function(R){return R.hookmask},e.exports.lua_getinfo=function(R,N,de){let q,Re,ar,Je;return N=Ie(N),y(R),N[0]===62?(ar=null,Je=R.stack[R.top-1],oe(R,Je.ttisfunction(),"function expected"),N=N.subarray(1),R.top--):(Je=(ar=de.i_ci).func,$(ar.func.ttisfunction())),q=(function(ke,w,le,p,j){let he=1;for(;w.length>0;w=w.subarray(1))switch(w[0]){case 83:Z(le,p);break;case 108:le.currentline=j&&j.callstatus&Y.CIST_LUA?He(j):-1;break;case 117:le.nups=p===null?0:p.nupvalues,p===null||p instanceof b.CClosure?(le.isvararg=!0,le.nparams=0):(le.isvararg=p.p.is_vararg,le.nparams=p.p.numparams);break;case 116:le.istailcall=j?j.callstatus&Y.CIST_TAIL:0;break;case 110:{let g=je(ke,j);g===null?(le.namewhat=H("",!0),le.name=null):(le.namewhat=g.funcname,le.name=g.name);break}case 76:case 102:break;default:he=0}return he})(R,N,de,Re=Je.ttisclosure()?Je.value:null,ar),Le(N,102)>=0&&(b.pushobj2s(R,Je),oe(R,R.top<=R.ci.top,"stack overflow")),y(R),Le(N,76)>=0&&(function(ke,w){if(w===null||w instanceof b.CClosure)ke.stack[ke.top]=new b.TValue(we,null),Me.api_incr_top(ke);else{let le=w.p.lineinfo,p=X.luaH_new(ke);ke.stack[ke.top]=new b.TValue(C,p),Me.api_incr_top(ke);let j=new b.TValue(ue,!0);for(let he=0;he<le.length;he++)X.luaH_setint(p,le[he],j)}})(R,Re),q},e.exports.lua_getlocal=function(R,N,de){let q;if(y(R),N===null)q=R.stack[R.top-1].ttisLclosure()?Pe.luaF_getlocalname(R.stack[R.top-1].value.p,de,0):null;else{let Re=Ue(R,N.i_ci,de);Re?(q=Re.name,b.pushobj2s(R,R.stack[Re.pos]),oe(R,R.top<=R.ci.top,"stack overflow")):q=null}return y(R),q},e.exports.lua_getstack=function(R,N,de){let q,Re;if(N<0)return 0;for(q=R.ci;N>0&&q!==R.base_ci;q=q.previous)N--;return N===0&&q!==R.base_ci?(Re=1,de.i_ci=q):Re=0,Re},e.exports.lua_sethook=function(R,N,de,q){N!==null&&de!==0||(de=0,N=null),R.ci.callstatus&Y.CIST_LUA&&(R.oldpc=R.ci.l_savedpc),R.hook=N,R.basehookcount=q,R.hookcount=R.basehookcount,R.hookmask=de},e.exports.lua_setlocal=function(R,N,de){let q;y(R);let Re=Ue(R,N.i_ci,de);return Re?(q=Re.name,b.setobjs2s(R,Re.pos,R.top-1),delete R.stack[--R.top]):q=null,y(R),q}},function(e,lr,h){const{LUA_MINSTACK:T,LUA_RIDX_GLOBALS:A,LUA_RIDX_MAINTHREAD:G,constant_types:{LUA_NUMTAGS:S,LUA_TNIL:ue,LUA_TTABLE:we,LUA_TTHREAD:C},thread_status:{LUA_OK:fe}}=h(1),K=h(6),Ie=h(8),pe=h(18),Le=h(9),H=h(14),oe=2*T;class ${constructor(){this.func=null,this.funcOff=NaN,this.top=NaN,this.previous=null,this.next=null,this.l_base=NaN,this.l_code=null,this.l_savedpc=NaN,this.c_k=null,this.c_old_errfunc=null,this.c_ctx=null,this.nresults=NaN,this.callstatus=NaN}}class Be{constructor(I){this.id=I.id_counter++,this.base_ci=new $,this.top=NaN,this.stack_last=NaN,this.oldpc=NaN,this.l_G=I,this.stack=null,this.ci=null,this.errorJmp=null,this.nCcalls=0,this.hook=null,this.hookmask=0,this.basehookcount=0,this.allowhook=1,this.hookcount=this.basehookcount,this.nny=1,this.status=fe,this.errfunc=0}}const Me=function(b){b.ci.next=null},Ke=function(b,I){b.stack=new Array(oe),b.top=0,b.stack_last=oe-5;let Y=b.base_ci;Y.next=Y.previous=null,Y.callstatus=0,Y.funcOff=b.top,Y.func=b.stack[b.top],b.stack[b.top++]=new K.TValue(ue,null),Y.top=b.top+T,b.ci=Y},Pe=function(b){b.ci=b.base_ci,Me(b),b.stack=null},Ye=function(b){let I=b.l_G;Ke(b),(function(Y,X){let ee=Le.luaH_new(Y);X.l_registry.sethvalue(ee),Le.luaH_setint(ee,G,new K.TValue(C,Y)),Le.luaH_setint(ee,A,new K.TValue(we,Le.luaH_new(Y)))})(b,I),H.luaT_init(b),I.version=pe.lua_version(null)};e.exports.lua_State=Be,e.exports.CallInfo=$,e.exports.CIST_OAH=1,e.exports.CIST_LUA=2,e.exports.CIST_HOOKED=4,e.exports.CIST_FRESH=8,e.exports.CIST_YPCALL=16,e.exports.CIST_TAIL=32,e.exports.CIST_HOOKYIELD=64,e.exports.CIST_LEQ=128,e.exports.CIST_FIN=256,e.exports.EXTRA_STACK=5,e.exports.lua_close=function(b){(function(I){Pe(I)})(b=b.l_G.mainthread)},e.exports.lua_newstate=function(){let b=new class{constructor(){this.id_counter=1,this.ids=new WeakMap,this.mainthread=null,this.l_registry=new K.TValue(ue,null),this.panic=null,this.atnativeerror=null,this.version=null,this.tmname=new Array(H.TMS.TM_N),this.mt=new Array(S)}},I=new Be(b);return b.mainthread=I,Ie.luaD_rawrunprotected(I,Ye,null)!==fe&&(I=null),I},e.exports.lua_newthread=function(b){let I=b.l_G,Y=new Be(I);return b.stack[b.top]=new K.TValue(C,Y),pe.api_incr_top(b),Y.hookmask=b.hookmask,Y.basehookcount=b.basehookcount,Y.hook=b.hook,Y.hookcount=Y.basehookcount,Ke(Y),Y},e.exports.luaE_extendCI=function(b){let I=new $;return b.ci.next=I,I.previous=b.ci,I.next=null,b.ci=I,I},e.exports.luaE_freeCI=Me,e.exports.luaE_freethread=function(b,I){Pe(I)}},function(e,lr,h){const{constant_types:{LUA_TNIL:T}}=h(1),A=h(6);e.exports.MAXUPVAL=255,e.exports.Proto=class{constructor(G){this.id=G.l_G.id_counter++,this.k=[],this.p=[],this.code=[],this.cache=null,this.lineinfo=[],this.upvalues=[],this.numparams=0,this.is_vararg=!1,this.maxstacksize=0,this.locvars=[],this.linedefined=0,this.lastlinedefined=0,this.source=null}},e.exports.luaF_findupval=function(G,S){return G.stack[S]},e.exports.luaF_close=function(G,S){for(let ue=S;ue<G.top;ue++){let we=G.stack[ue];G.stack[ue]=new A.TValue(we.type,we.value)}},e.exports.luaF_getlocalname=function(G,S,ue){for(let we=0;we<G.locvars.length&&G.locvars[we].startpc<=ue;we++)if(ue<G.locvars[we].endpc&&--S==0)return G.locvars[we].varname.getstr();return null},e.exports.luaF_initupvals=function(G,S){for(let ue=0;ue<S.nupvalues;ue++)S.upvals[ue]=new A.TValue(T,null)},e.exports.luaF_newLclosure=function(G,S){return new A.LClosure(G,S)}},function(e,lr,h){const{constant_types:{LUA_TTABLE:T,LUA_TUSERDATA:A},to_luastring:G}=h(1),{lua_assert:S}=h(4),ue=h(6),we=h(8),C=h(12),{luaS_bless:fe,luaS_new:K}=h(10),Ie=h(9),pe=h(11),Le=h(15),H=["no value","nil","boolean","userdata","number","string","table","function","userdata","thread","proto"].map(b=>G(b)),oe=function(b){return H[b+1]},$={TM_INDEX:0,TM_NEWINDEX:1,TM_GC:2,TM_MODE:3,TM_LEN:4,TM_EQ:5,TM_ADD:6,TM_SUB:7,TM_MUL:8,TM_MOD:9,TM_POW:10,TM_DIV:11,TM_IDIV:12,TM_BAND:13,TM_BOR:14,TM_BXOR:15,TM_SHL:16,TM_SHR:17,TM_UNM:18,TM_BNOT:19,TM_LT:20,TM_LE:21,TM_CONCAT:22,TM_CALL:23,TM_N:24},Be=G("__name",!0),Me=function(b,I,Y,X,ee,Ne){let Fe=b.top;if(ue.pushobj2s(b,I),ue.pushobj2s(b,Y),ue.pushobj2s(b,X),Ne||ue.pushobj2s(b,ee),b.ci.callstatus&C.CIST_LUA?we.luaD_call(b,Fe,Ne):we.luaD_callnoyield(b,Fe,Ne),Ne){let He=b.stack[b.top-1];delete b.stack[--b.top],ee.setfrom(He)}},Ke=function(b,I,Y,X,ee){let Ne=Ye(b,I,ee);return Ne.ttisnil()&&(Ne=Ye(b,Y,ee)),!Ne.ttisnil()&&(Me(b,Ne,I,Y,X,1),!0)},Pe=function(b,I,Y){const X=Ie.luaH_getstr(b,Y);return S(I<=$.TM_EQ),X.ttisnil()?(b.flags|=1<<I,null):X},Ye=function(b,I,Y){let X;switch(I.ttnov()){case T:case A:X=I.value.metatable;break;default:X=b.l_G.mt[I.ttnov()]}return X?Ie.luaH_getstr(X,b.l_G.tmname[Y]):ue.luaO_nilobject};e.exports.fasttm=function(b,I,Y){return I===null||I.flags&1<<Y?null:Pe(I,Y,b.l_G.tmname[Y])},e.exports.TMS=$,e.exports.luaT_callTM=Me,e.exports.luaT_callbinTM=Ke,e.exports.luaT_trybinTM=function(b,I,Y,X,ee){if(!Ke(b,I,Y,X,ee))switch(ee){case $.TM_CONCAT:return pe.luaG_concaterror(b,I,Y);case $.TM_BAND:case $.TM_BOR:case $.TM_BXOR:case $.TM_SHL:case $.TM_SHR:case $.TM_BNOT:{let Ne=Le.tonumber(I),Fe=Le.tonumber(Y);return Ne!==!1&&Fe!==!1?pe.luaG_tointerror(b,I,Y):pe.luaG_opinterror(b,I,Y,G("perform bitwise operation on",!0))}default:return pe.luaG_opinterror(b,I,Y,G("perform arithmetic on",!0))}},e.exports.luaT_callorderTM=function(b,I,Y,X){let ee=new ue.TValue;return Ke(b,I,Y,ee,X)?!ee.l_isfalse():null},e.exports.luaT_gettm=Pe,e.exports.luaT_gettmbyobj=Ye,e.exports.luaT_init=function(b){b.l_G.tmname[$.TM_INDEX]=new K(b,G("__index",!0)),b.l_G.tmname[$.TM_NEWINDEX]=new K(b,G("__newindex",!0)),b.l_G.tmname[$.TM_GC]=new K(b,G("__gc",!0)),b.l_G.tmname[$.TM_MODE]=new K(b,G("__mode",!0)),b.l_G.tmname[$.TM_LEN]=new K(b,G("__len",!0)),b.l_G.tmname[$.TM_EQ]=new K(b,G("__eq",!0)),b.l_G.tmname[$.TM_ADD]=new K(b,G("__add",!0)),b.l_G.tmname[$.TM_SUB]=new K(b,G("__sub",!0)),b.l_G.tmname[$.TM_MUL]=new K(b,G("__mul",!0)),b.l_G.tmname[$.TM_MOD]=new K(b,G("__mod",!0)),b.l_G.tmname[$.TM_POW]=new K(b,G("__pow",!0)),b.l_G.tmname[$.TM_DIV]=new K(b,G("__div",!0)),b.l_G.tmname[$.TM_IDIV]=new K(b,G("__idiv",!0)),b.l_G.tmname[$.TM_BAND]=new K(b,G("__band",!0)),b.l_G.tmname[$.TM_BOR]=new K(b,G("__bor",!0)),b.l_G.tmname[$.TM_BXOR]=new K(b,G("__bxor",!0)),b.l_G.tmname[$.TM_SHL]=new K(b,G("__shl",!0)),b.l_G.tmname[$.TM_SHR]=new K(b,G("__shr",!0)),b.l_G.tmname[$.TM_UNM]=new K(b,G("__unm",!0)),b.l_G.tmname[$.TM_BNOT]=new K(b,G("__bnot",!0)),b.l_G.tmname[$.TM_LT]=new K(b,G("__lt",!0)),b.l_G.tmname[$.TM_LE]=new K(b,G("__le",!0)),b.l_G.tmname[$.TM_CONCAT]=new K(b,G("__concat",!0)),b.l_G.tmname[$.TM_CALL]=new K(b,G("__call",!0))},e.exports.luaT_objtypename=function(b,I){let Y;if(I.ttistable()&&(Y=I.value.metatable)!==null||I.ttisfulluserdata()&&(Y=I.value.metatable)!==null){let X=Ie.luaH_getstr(Y,fe(b,Be));if(X.ttisstring())return X.svalue()}return oe(I.ttnov())},e.exports.ttypename=oe},function(e,lr,h){const{LUA_MASKLINE:T,LUA_MASKCOUNT:A,LUA_MULTRET:G,constant_types:{LUA_TBOOLEAN:S,LUA_TLCF:ue,LUA_TLIGHTUSERDATA:we,LUA_TLNGSTR:C,LUA_TNIL:fe,LUA_TNUMBER:K,LUA_TNUMFLT:Ie,LUA_TNUMINT:pe,LUA_TSHRSTR:Le,LUA_TTABLE:H,LUA_TUSERDATA:oe},to_luastring:$}=h(1),{INDEXK:Be,ISK:Me,LFIELDS_PER_FLUSH:Ke,OpCodesI:{OP_ADD:Pe,OP_BAND:Ye,OP_BNOT:b,OP_BOR:I,OP_BXOR:Y,OP_CALL:X,OP_CLOSURE:ee,OP_CONCAT:Ne,OP_DIV:Fe,OP_EQ:He,OP_EXTRAARG:y,OP_FORLOOP:W,OP_FORPREP:Ue,OP_GETTABLE:Z,OP_GETTABUP:je,OP_GETUPVAL:d,OP_IDIV:k,OP_JMP:m,OP_LE:ie,OP_LEN:_e,OP_LOADBOOL:nr,OP_LOADK:ze,OP_LOADKX:rr,OP_LOADNIL:tr,OP_LT:R,OP_MOD:N,OP_MOVE:de,OP_MUL:q,OP_NEWTABLE:Re,OP_NOT:ar,OP_POW:Je,OP_RETURN:ke,OP_SELF:w,OP_SETLIST:le,OP_SETTABLE:p,OP_SETTABUP:j,OP_SETUPVAL:he,OP_SHL:g,OP_SHR:z,OP_SUB:se,OP_TAILCALL:or,OP_TEST:ir,OP_TESTSET:cr,OP_TFORCALL:mr,OP_TFORLOOP:Sr,OP_UNM:Rr,OP_VARARG:Cr}}=h(16),{LUA_MAXINTEGER:_,LUA_MININTEGER:Oe,lua_numbertointeger:be}=h(3),{lua_assert:ge,luai_nummod:ae}=h(4),ce=h(6),De=h(13),Lr=h(12),{luaS_bless:dr,luaS_eqlngstr:xr,luaS_hashlongstr:Mr}=h(10),Qe=h(8),sr=h(14),br=h(9),r=h(11),n=function(c,D,Ee){return D+Ee.A},l=function(c,D,Ee){return D+Ee.B},a=function(c,D,Ee,ye){return Me(ye.B)?Ee[Be(ye.B)]:c.stack[D+ye.B]},u=function(c,D,Ee,ye){return Me(ye.C)?Ee[Be(ye.C)]:c.stack[D+ye.C]},f=function(c,D,Ee,ye){let We=Ee.A;We!==0&&De.luaF_close(c,D.l_base+We-1),D.l_savedpc+=Ee.sBx+ye},s=function(c,D){f(c,D,D.l_code[D.l_savedpc],1)},U=function(c,D,Ee){if(D.ttisnumber()&&Ee.ttisnumber())return L(D,Ee)?1:0;if(D.ttisstring()&&Ee.ttisstring())return P(D.tsvalue(),Ee.tsvalue())<0?1:0;{let ye=sr.luaT_callorderTM(c,D,Ee,sr.TMS.TM_LT);return ye===null&&r.luaG_ordererror(c,D,Ee),ye?1:0}},xe=function(c,D,Ee){let ye;return D.ttisnumber()&&Ee.ttisnumber()?ne(D,Ee)?1:0:D.ttisstring()&&Ee.ttisstring()?P(D.tsvalue(),Ee.tsvalue())<=0?1:0:(ye=sr.luaT_callorderTM(c,D,Ee,sr.TMS.TM_LE))!==null?ye?1:0:(c.ci.callstatus|=Lr.CIST_LEQ,ye=sr.luaT_callorderTM(c,Ee,D,sr.TMS.TM_LT),c.ci.callstatus^=Lr.CIST_LEQ,ye===null&&r.luaG_ordererror(c,D,Ee),ye?0:1)},Ge=function(c,D,Ee){if(D.ttype()!==Ee.ttype())return D.ttnov()!==Ee.ttnov()||D.ttnov()!==K?0:D.value===Ee.value?1:0;let ye;switch(D.ttype()){case fe:return 1;case S:return D.value==Ee.value?1:0;case we:case pe:case Ie:case ue:return D.value===Ee.value?1:0;case Le:case C:return xr(D.tsvalue(),Ee.tsvalue())?1:0;case oe:case H:if(D.value===Ee.value)return 1;if(c===null)return 0;(ye=sr.fasttm(c,D.value.metatable,sr.TMS.TM_EQ))===null&&(ye=sr.fasttm(c,Ee.value.metatable,sr.TMS.TM_EQ));break;default:return D.value===Ee.value?1:0}if(ye===null)return 0;let We=new ce.TValue;return sr.luaT_callTM(c,ye,D,Ee,We,1),We.l_isfalse()?0:1},Ar=function(c,D){let Ee=!1,ye=Tr(c,D<0?2:1);if(ye===!1){let We=me(c);if(We===!1)return!1;0<We?(ye=_,D<0&&(Ee=!0)):(ye=Oe,D>=0&&(Ee=!0))}return{stopnow:Ee,ilimit:ye}},Tr=function(c,D){if(c.ttisfloat()){let Ee=c.value,ye=Math.floor(Ee);if(Ee!==ye){if(D===0)return!1;D>1&&(ye+=1)}return be(ye)}if(c.ttisinteger())return c.value;if(vr(c)){let Ee=new ce.TValue;if(ce.luaO_str2num(c.svalue(),Ee)===c.vslen()+1)return Tr(Ee,D)}return!1},M=function(c){return c.ttisinteger()?c.value:Tr(c,0)},me=function(c){if(c.ttnov()===K)return c.value;if(vr(c)){let D=new ce.TValue;if(ce.luaO_str2num(c.svalue(),D)===c.vslen()+1)return D.value}return!1},L=function(c,D){return c.value<D.value},ne=function(c,D){return c.value<=D.value},P=function(c,D){let Ee=Mr(c),ye=Mr(D);return Ee===ye?0:Ee<ye?-1:1},Ce=function(c,D,Ee){let ye;switch(Ee.ttype()){case H:{let We=Ee.value;if((ye=sr.fasttm(c,We.metatable,sr.TMS.TM_LEN))!==null)break;return void D.setivalue(br.luaH_getn(We))}case Le:case C:return void D.setivalue(Ee.vslen());default:(ye=sr.luaT_gettmbyobj(c,Ee,sr.TMS.TM_LEN)).ttisnil()&&r.luaG_typeerror(c,Ee,$("get length of",!0))}sr.luaT_callTM(c,ye,Ee,Ee,D,1)},_r=Math.imul||function(c,D){let Ee=65535&c,ye=65535&D;return Ee*ye+((c>>>16&65535)*ye+Ee*(D>>>16&65535)<<16>>>0)|0},fr=function(c,D,Ee){return Ee===0&&r.luaG_runerror(c,$("attempt to divide by zero")),0|Math.floor(D/Ee)},ur=function(c,D,Ee){return Ee===0&&r.luaG_runerror(c,$("attempt to perform 'n%%0'")),D-Math.floor(D/Ee)*Ee|0},kr=function(c,D){return D<0?D<=-32?0:c>>>-D:D>=32?0:c<<D},Br=function(c,D,Ee,ye){let We=c.cache;if(We!==null){let ve=c.upvalues,Se=ve.length;for(let Ae=0;Ae<Se;Ae++){let Xe=ve[Ae].instack?Ee[ye+ve[Ae].idx]:D[ve[Ae].idx];if(We.upvals[Ae]!==Xe)return null}}return We},hr=function(c,D,Ee,ye,We){let ve=D.upvalues.length,Se=D.upvalues,Ae=new ce.LClosure(c,ve);Ae.p=D,c.stack[We].setclLvalue(Ae);for(let Xe=0;Xe<ve;Xe++)Se[Xe].instack?Ae.upvals[Xe]=De.luaF_findupval(c,ye+Se[Xe].idx):Ae.upvals[Xe]=Ee[Se[Xe].idx];D.cache=Ae},Er=function(c){return c.ttisnumber()},vr=function(c){return c.ttisstring()},wr=function(c,D){let Ee=c.stack[D];return!!Ee.ttisstring()||!!Er(Ee)&&(ce.luaO_tostring(c,Ee),!0)},Ir=function(c){return c.ttisstring()&&c.vslen()===0},Hr=function(c,D,Ee,ye){let We=0;do{let ve=c.stack[D-Ee],Se=ve.vslen(),Ae=ve.svalue();ye.set(Ae,We),We+=Se}while(--Ee>0)},Vr=function(c,D){ge(D>=2);do{let Ee=c.top,ye=2;if((c.stack[Ee-2].ttisstring()||Er(c.stack[Ee-2]))&&wr(c,Ee-1))if(Ir(c.stack[Ee-1]))wr(c,Ee-2);else if(Ir(c.stack[Ee-2]))ce.setobjs2s(c,Ee-2,Ee-1);else{let We=c.stack[Ee-1].vslen();for(ye=1;ye<D&&wr(c,Ee-ye-1);ye++)We+=c.stack[Ee-ye-1].vslen();let ve=new Uint8Array(We);Hr(c,Ee,ye,ve);let Se=dr(c,ve);ce.setsvalue2s(c,Ee-ye,Se)}else sr.luaT_trybinTM(c,c.stack[Ee-2],c.stack[Ee-1],c.stack[Ee-2],sr.TMS.TM_CONCAT);for(D-=ye-1;c.top>Ee-(ye-1);)delete c.stack[--c.top]}while(D>1)},Xr=function(c,D,Ee,ye){for(let We=0;We<2e3;We++){let ve;if(D.ttistable()){let Se=br.luaH_get(c,D.value,Ee);if(!Se.ttisnil())return void ce.setobj2s(c,ye,Se);if((ve=sr.fasttm(c,D.value.metatable,sr.TMS.TM_INDEX))===null)return void c.stack[ye].setnilvalue()}else(ve=sr.luaT_gettmbyobj(c,D,sr.TMS.TM_INDEX)).ttisnil()&&r.luaG_typeerror(c,D,$("index",!0));if(ve.ttisfunction())return void sr.luaT_callTM(c,ve,D,Ee,c.stack[ye],1);D=ve}r.luaG_runerror(c,$("'__index' chain too long; possible loop",!0))},Fr=function(c,D,Ee,ye){for(let We=0;We<2e3;We++){let ve;if(D.ttistable()){let Se=D.value;if(!br.luaH_get(c,Se,Ee).ttisnil()||(ve=sr.fasttm(c,Se.metatable,sr.TMS.TM_NEWINDEX))===null)return br.luaH_setfrom(c,Se,Ee,ye),void br.invalidateTMcache(Se)}else(ve=sr.luaT_gettmbyobj(c,D,sr.TMS.TM_NEWINDEX)).ttisnil()&&r.luaG_typeerror(c,D,$("index",!0));if(ve.ttisfunction())return void sr.luaT_callTM(c,ve,D,Ee,ye,0);D=ve}r.luaG_runerror(c,$("'__newindex' chain too long; possible loop",!0))};e.exports.cvt2str=Er,e.exports.cvt2num=vr,e.exports.luaV_gettable=Xr,e.exports.luaV_concat=Vr,e.exports.luaV_div=fr,e.exports.luaV_equalobj=Ge,e.exports.luaV_execute=function(c){let D=c.ci;D.callstatus|=Lr.CIST_FRESH;e:for(;;){ge(D===c.ci);let Ee=D.func.value,ye=Ee.p.k,We=D.l_base,ve=D.l_code[D.l_savedpc++];c.hookmask&(T|A)&&r.luaG_traceexec(c);let Se=n(0,We,ve);switch(ve.opcode){case de:ce.setobjs2s(c,Se,l(0,We,ve));break;case ze:{let Ae=ye[ve.Bx];ce.setobj2s(c,Se,Ae);break}case rr:{ge(D.l_code[D.l_savedpc].opcode===y);let Ae=ye[D.l_code[D.l_savedpc++].Ax];ce.setobj2s(c,Se,Ae);break}case nr:c.stack[Se].setbvalue(ve.B!==0),ve.C!==0&&D.l_savedpc++;break;case tr:for(let Ae=0;Ae<=ve.B;Ae++)c.stack[Se+Ae].setnilvalue();break;case d:{let Ae=ve.B;ce.setobj2s(c,Se,Ee.upvals[Ae]);break}case je:{let Ae=Ee.upvals[ve.B],Xe=u(c,We,ye,ve);Xr(c,Ae,Xe,Se);break}case Z:{let Ae=c.stack[l(0,We,ve)],Xe=u(c,We,ye,ve);Xr(c,Ae,Xe,Se);break}case j:{let Ae=Ee.upvals[ve.A],Xe=a(c,We,ye,ve),er=u(c,We,ye,ve);Fr(c,Ae,Xe,er);break}case he:Ee.upvals[ve.B].setfrom(c.stack[Se]);break;case p:{let Ae=c.stack[Se],Xe=a(c,We,ye,ve),er=u(c,We,ye,ve);Fr(c,Ae,Xe,er);break}case Re:c.stack[Se].sethvalue(br.luaH_new(c));break;case w:{let Ae=l(0,We,ve),Xe=u(c,We,ye,ve);ce.setobjs2s(c,Se+1,Ae),Xr(c,c.stack[Ae],Xe,Se);break}case Pe:{let Ae,Xe,er=a(c,We,ye,ve),t=u(c,We,ye,ve);er.ttisinteger()&&t.ttisinteger()?c.stack[Se].setivalue(er.value+t.value|0):(Ae=me(er))!==!1&&(Xe=me(t))!==!1?c.stack[Se].setfltvalue(Ae+Xe):sr.luaT_trybinTM(c,er,t,c.stack[Se],sr.TMS.TM_ADD);break}case se:{let Ae,Xe,er=a(c,We,ye,ve),t=u(c,We,ye,ve);er.ttisinteger()&&t.ttisinteger()?c.stack[Se].setivalue(er.value-t.value|0):(Ae=me(er))!==!1&&(Xe=me(t))!==!1?c.stack[Se].setfltvalue(Ae-Xe):sr.luaT_trybinTM(c,er,t,c.stack[Se],sr.TMS.TM_SUB);break}case q:{let Ae,Xe,er=a(c,We,ye,ve),t=u(c,We,ye,ve);er.ttisinteger()&&t.ttisinteger()?c.stack[Se].setivalue(_r(er.value,t.value)):(Ae=me(er))!==!1&&(Xe=me(t))!==!1?c.stack[Se].setfltvalue(Ae*Xe):sr.luaT_trybinTM(c,er,t,c.stack[Se],sr.TMS.TM_MUL);break}case N:{let Ae,Xe,er=a(c,We,ye,ve),t=u(c,We,ye,ve);er.ttisinteger()&&t.ttisinteger()?c.stack[Se].setivalue(ur(c,er.value,t.value)):(Ae=me(er))!==!1&&(Xe=me(t))!==!1?c.stack[Se].setfltvalue(ae(c,Ae,Xe)):sr.luaT_trybinTM(c,er,t,c.stack[Se],sr.TMS.TM_MOD);break}case Je:{let Ae,Xe,er=a(c,We,ye,ve),t=u(c,We,ye,ve);(Ae=me(er))!==!1&&(Xe=me(t))!==!1?c.stack[Se].setfltvalue(Math.pow(Ae,Xe)):sr.luaT_trybinTM(c,er,t,c.stack[Se],sr.TMS.TM_POW);break}case Fe:{let Ae,Xe,er=a(c,We,ye,ve),t=u(c,We,ye,ve);(Ae=me(er))!==!1&&(Xe=me(t))!==!1?c.stack[Se].setfltvalue(Ae/Xe):sr.luaT_trybinTM(c,er,t,c.stack[Se],sr.TMS.TM_DIV);break}case k:{let Ae,Xe,er=a(c,We,ye,ve),t=u(c,We,ye,ve);er.ttisinteger()&&t.ttisinteger()?c.stack[Se].setivalue(fr(c,er.value,t.value)):(Ae=me(er))!==!1&&(Xe=me(t))!==!1?c.stack[Se].setfltvalue(Math.floor(Ae/Xe)):sr.luaT_trybinTM(c,er,t,c.stack[Se],sr.TMS.TM_IDIV);break}case Ye:{let Ae,Xe,er=a(c,We,ye,ve),t=u(c,We,ye,ve);(Ae=M(er))!==!1&&(Xe=M(t))!==!1?c.stack[Se].setivalue(Ae&Xe):sr.luaT_trybinTM(c,er,t,c.stack[Se],sr.TMS.TM_BAND);break}case I:{let Ae,Xe,er=a(c,We,ye,ve),t=u(c,We,ye,ve);(Ae=M(er))!==!1&&(Xe=M(t))!==!1?c.stack[Se].setivalue(Ae|Xe):sr.luaT_trybinTM(c,er,t,c.stack[Se],sr.TMS.TM_BOR);break}case Y:{let Ae,Xe,er=a(c,We,ye,ve),t=u(c,We,ye,ve);(Ae=M(er))!==!1&&(Xe=M(t))!==!1?c.stack[Se].setivalue(Ae^Xe):sr.luaT_trybinTM(c,er,t,c.stack[Se],sr.TMS.TM_BXOR);break}case g:{let Ae,Xe,er=a(c,We,ye,ve),t=u(c,We,ye,ve);(Ae=M(er))!==!1&&(Xe=M(t))!==!1?c.stack[Se].setivalue(kr(Ae,Xe)):sr.luaT_trybinTM(c,er,t,c.stack[Se],sr.TMS.TM_SHL);break}case z:{let Ae,Xe,er=a(c,We,ye,ve),t=u(c,We,ye,ve);(Ae=M(er))!==!1&&(Xe=M(t))!==!1?c.stack[Se].setivalue(kr(Ae,-Xe)):sr.luaT_trybinTM(c,er,t,c.stack[Se],sr.TMS.TM_SHR);break}case Rr:{let Ae,Xe=c.stack[l(0,We,ve)];Xe.ttisinteger()?c.stack[Se].setivalue(0|-Xe.value):(Ae=me(Xe))!==!1?c.stack[Se].setfltvalue(-Ae):sr.luaT_trybinTM(c,Xe,Xe,c.stack[Se],sr.TMS.TM_UNM);break}case b:{let Ae=c.stack[l(0,We,ve)];Ae.ttisinteger()?c.stack[Se].setivalue(~Ae.value):sr.luaT_trybinTM(c,Ae,Ae,c.stack[Se],sr.TMS.TM_BNOT);break}case ar:{let Ae=c.stack[l(0,We,ve)];c.stack[Se].setbvalue(Ae.l_isfalse());break}case _e:Ce(c,c.stack[Se],c.stack[l(0,We,ve)]);break;case Ne:{let Ae=ve.B,Xe=ve.C;c.top=We+Xe+1,Vr(c,Xe-Ae+1);let er=We+Ae;ce.setobjs2s(c,Se,er),Qe.adjust_top(c,D.top);break}case m:f(c,D,ve,0);break;case He:Ge(c,a(c,We,ye,ve),u(c,We,ye,ve))!==ve.A?D.l_savedpc++:s(c,D);break;case R:U(c,a(c,We,ye,ve),u(c,We,ye,ve))!==ve.A?D.l_savedpc++:s(c,D);break;case ie:xe(c,a(c,We,ye,ve),u(c,We,ye,ve))!==ve.A?D.l_savedpc++:s(c,D);break;case ir:(ve.C?c.stack[Se].l_isfalse():!c.stack[Se].l_isfalse())?D.l_savedpc++:s(c,D);break;case cr:{let Ae=l(0,We,ve),Xe=c.stack[Ae];(ve.C?Xe.l_isfalse():!Xe.l_isfalse())?D.l_savedpc++:(ce.setobjs2s(c,Se,Ae),s(c,D));break}case X:{let Ae=ve.B,Xe=ve.C-1;if(Ae!==0&&Qe.adjust_top(c,Se+Ae),!Qe.luaD_precall(c,Se,Xe)){D=c.ci;continue e}Xe>=0&&Qe.adjust_top(c,D.top);break}case or:{let Ae=ve.B;if(Ae!==0&&Qe.adjust_top(c,Se+Ae),!Qe.luaD_precall(c,Se,G)){let Xe=c.ci,er=Xe.previous,t=Xe.func,v=Xe.funcOff,O=er.funcOff,F=Xe.l_base+t.value.p.numparams;Ee.p.p.length>0&&De.luaF_close(c,er.l_base);for(let V=0;v+V<F;V++)ce.setobjs2s(c,O+V,v+V);er.l_base=O+(Xe.l_base-v),er.top=O+(c.top-v),Qe.adjust_top(c,er.top),er.l_code=Xe.l_code,er.l_savedpc=Xe.l_savedpc,er.callstatus|=Lr.CIST_TAIL,er.next=null,D=c.ci=er,ge(c.top===er.l_base+c.stack[O].value.p.maxstacksize);continue e}break}case ke:{Ee.p.p.length>0&&De.luaF_close(c,We);let Ae=Qe.luaD_poscall(c,D,Se,ve.B!==0?ve.B-1:c.top-Se);if(D.callstatus&Lr.CIST_FRESH)return;D=c.ci,Ae&&Qe.adjust_top(c,D.top),ge(D.callstatus&Lr.CIST_LUA),ge(D.l_code[D.l_savedpc-1].opcode===X);continue e}case W:if(c.stack[Se].ttisinteger()){let Ae=c.stack[Se+2].value,Xe=c.stack[Se].value+Ae|0,er=c.stack[Se+1].value;(0<Ae?Xe<=er:er<=Xe)&&(D.l_savedpc+=ve.sBx,c.stack[Se].chgivalue(Xe),c.stack[Se+3].setivalue(Xe))}else{let Ae=c.stack[Se+2].value,Xe=c.stack[Se].value+Ae,er=c.stack[Se+1].value;(0<Ae?Xe<=er:er<=Xe)&&(D.l_savedpc+=ve.sBx,c.stack[Se].chgfltvalue(Xe),c.stack[Se+3].setfltvalue(Xe))}break;case Ue:{let Ae,Xe=c.stack[Se],er=c.stack[Se+1],t=c.stack[Se+2];if(Xe.ttisinteger()&&t.ttisinteger()&&(Ae=Ar(er,t.value))){let v=Ae.stopnow?0:Xe.value;er.value=Ae.ilimit,Xe.value=v-t.value|0}else{let v,O,F;(v=me(er))===!1&&r.luaG_runerror(c,$("'for' limit must be a number",!0)),c.stack[Se+1].setfltvalue(v),(O=me(t))===!1&&r.luaG_runerror(c,$("'for' step must be a number",!0)),c.stack[Se+2].setfltvalue(O),(F=me(Xe))===!1&&r.luaG_runerror(c,$("'for' initial value must be a number",!0)),c.stack[Se].setfltvalue(F-O)}D.l_savedpc+=ve.sBx;break}case mr:{let Ae=Se+3;ce.setobjs2s(c,Ae+2,Se+2),ce.setobjs2s(c,Ae+1,Se+1),ce.setobjs2s(c,Ae,Se),Qe.adjust_top(c,Ae+3),Qe.luaD_call(c,Ae,ve.C),Qe.adjust_top(c,D.top),ve=D.l_code[D.l_savedpc++],Se=n(0,We,ve),ge(ve.opcode===Sr)}case Sr:c.stack[Se+1].ttisnil()||(ce.setobjs2s(c,Se,Se+1),D.l_savedpc+=ve.sBx);break;case le:{let Ae=ve.B,Xe=ve.C;Ae===0&&(Ae=c.top-Se-1),Xe===0&&(ge(D.l_code[D.l_savedpc].opcode===y),Xe=D.l_code[D.l_savedpc++].Ax);let er=c.stack[Se].value,t=(Xe-1)*Ke+Ae;for(;Ae>0;Ae--)br.luaH_setint(er,t--,c.stack[Se+Ae]);Qe.adjust_top(c,D.top);break}case ee:{let Ae=Ee.p.p[ve.Bx],Xe=Br(Ae,Ee.upvals,c.stack,We);Xe===null?hr(c,Ae,Ee.upvals,We,Se):c.stack[Se].setclLvalue(Xe);break}case Cr:{let Ae,Xe=ve.B-1,er=We-D.funcOff-Ee.p.numparams-1;for(er<0&&(er=0),Xe<0&&(Xe=er,Qe.luaD_checkstack(c,er),Qe.adjust_top(c,Se+er)),Ae=0;Ae<Xe&&Ae<er;Ae++)ce.setobjs2s(c,Se+Ae,We-er+Ae);for(;Ae<Xe;Ae++)c.stack[Se+Ae].setnilvalue();break}case y:throw Error("invalid opcode")}}},e.exports.luaV_finishOp=function(c){let D=c.ci,Ee=D.l_base,ye=D.l_code[D.l_savedpc-1],We=ye.opcode;switch(We){case Pe:case se:case q:case Fe:case k:case Ye:case I:case Y:case g:case z:case N:case Je:case Rr:case b:case _e:case je:case Z:case w:ce.setobjs2s(c,Ee+ye.A,c.top-1),delete c.stack[--c.top];break;case ie:case R:case He:{let ve=!c.stack[c.top-1].l_isfalse();delete c.stack[--c.top],D.callstatus&Lr.CIST_LEQ&&(ge(We===ie),D.callstatus^=Lr.CIST_LEQ,ve=!ve),ge(D.l_code[D.l_savedpc].opcode===m),ve!==!!ye.A&&D.l_savedpc++;break}case Ne:{let ve=c.top-1,Se=ve-1-(Ee+ye.B);ce.setobjs2s(c,ve-2,ve),Se>1&&(c.top=ve-1,Vr(c,Se)),ce.setobjs2s(c,D.l_base+ye.A,c.top-1),Qe.adjust_top(c,D.top);break}case mr:ge(D.l_code[D.l_savedpc].opcode===Sr),Qe.adjust_top(c,D.top);break;case X:ye.C-1>=0&&Qe.adjust_top(c,D.top)}},e.exports.luaV_imul=_r,e.exports.luaV_lessequal=xe,e.exports.luaV_lessthan=U,e.exports.luaV_mod=ur,e.exports.luaV_objlen=Ce,e.exports.luaV_rawequalobj=function(c,D){return Ge(null,c,D)},e.exports.luaV_shiftl=kr,e.exports.luaV_tointeger=Tr,e.exports.settable=Fr,e.exports.tointeger=M,e.exports.tonumber=me},function(e,lr,h){const T=[96,113,65,84,80,80,92,108,60,16,60,84,108,124,124,124,124,124,124,124,124,124,124,124,124,96,96,96,96,104,34,188,188,188,132,228,84,84,16,98,98,4,98,20,81,80,23],A=function(C,fe){return~(-1<<C)<<fe},G=function(C,fe){return~A(C,fe)},S=function(C,fe,K,Ie){return C.code=C.code&G(Ie,K)|fe<<K&A(Ie,K),we(C)},ue=function(C,fe){return S(C,fe,14,18)},we=function(C){if(typeof C=="number")return{code:C,opcode:C>>0&A(6,0),A:C>>6&A(8,0),B:C>>23&A(9,0),C:C>>14&A(9,0),Bx:C>>14&A(18,0),Ax:C>>6&A(26,0),sBx:(C>>14&A(18,0))-131071};{let fe=C.code;return C.opcode=fe>>0&A(6,0),C.A=fe>>6&A(8,0),C.B=fe>>23&A(9,0),C.C=fe>>14&A(9,0),C.Bx=fe>>14&A(18,0),C.Ax=fe>>6&A(26,0),C.sBx=(fe>>14&A(18,0))-131071,C}};e.exports.BITRK=256,e.exports.CREATE_ABC=function(C,fe,K,Ie){return we(C<<0|fe<<6|K<<23|Ie<<14)},e.exports.CREATE_ABx=function(C,fe,K){return we(C<<0|fe<<6|K<<14)},e.exports.CREATE_Ax=function(C,fe){return we(C<<0|fe<<6)},e.exports.GET_OPCODE=function(C){return C.opcode},e.exports.GETARG_A=function(C){return C.A},e.exports.GETARG_B=function(C){return C.B},e.exports.GETARG_C=function(C){return C.C},e.exports.GETARG_Bx=function(C){return C.Bx},e.exports.GETARG_Ax=function(C){return C.Ax},e.exports.GETARG_sBx=function(C){return C.sBx},e.exports.INDEXK=function(C){return-257&C},e.exports.ISK=function(C){return 256&C},e.exports.LFIELDS_PER_FLUSH=50,e.exports.MAXARG_A=255,e.exports.MAXARG_Ax=67108863,e.exports.MAXARG_B=511,e.exports.MAXARG_Bx=262143,e.exports.MAXARG_C=511,e.exports.MAXARG_sBx=131071,e.exports.MAXINDEXRK=255,e.exports.NO_REG=255,e.exports.OpArgK=3,e.exports.OpArgN=0,e.exports.OpArgR=2,e.exports.OpArgU=1,e.exports.OpCodes=["MOVE","LOADK","LOADKX","LOADBOOL","LOADNIL","GETUPVAL","GETTABUP","GETTABLE","SETTABUP","SETUPVAL","SETTABLE","NEWTABLE","SELF","ADD","SUB","MUL","MOD","POW","DIV","IDIV","BAND","BOR","BXOR","SHL","SHR","UNM","BNOT","NOT","LEN","CONCAT","JMP","EQ","LT","LE","TEST","TESTSET","CALL","TAILCALL","RETURN","FORLOOP","FORPREP","TFORCALL","TFORLOOP","SETLIST","CLOSURE","VARARG","EXTRAARG"],e.exports.OpCodesI={OP_MOVE:0,OP_LOADK:1,OP_LOADKX:2,OP_LOADBOOL:3,OP_LOADNIL:4,OP_GETUPVAL:5,OP_GETTABUP:6,OP_GETTABLE:7,OP_SETTABUP:8,OP_SETUPVAL:9,OP_SETTABLE:10,OP_NEWTABLE:11,OP_SELF:12,OP_ADD:13,OP_SUB:14,OP_MUL:15,OP_MOD:16,OP_POW:17,OP_DIV:18,OP_IDIV:19,OP_BAND:20,OP_BOR:21,OP_BXOR:22,OP_SHL:23,OP_SHR:24,OP_UNM:25,OP_BNOT:26,OP_NOT:27,OP_LEN:28,OP_CONCAT:29,OP_JMP:30,OP_EQ:31,OP_LT:32,OP_LE:33,OP_TEST:34,OP_TESTSET:35,OP_CALL:36,OP_TAILCALL:37,OP_RETURN:38,OP_FORLOOP:39,OP_FORPREP:40,OP_TFORCALL:41,OP_TFORLOOP:42,OP_SETLIST:43,OP_CLOSURE:44,OP_VARARG:45,OP_EXTRAARG:46},e.exports.POS_A=6,e.exports.POS_Ax=6,e.exports.POS_B=23,e.exports.POS_Bx=14,e.exports.POS_C=14,e.exports.POS_OP=0,e.exports.RKASK=function(C){return 256|C},e.exports.SETARG_A=function(C,fe){return S(C,fe,6,8)},e.exports.SETARG_Ax=function(C,fe){return S(C,fe,6,26)},e.exports.SETARG_B=function(C,fe){return S(C,fe,23,9)},e.exports.SETARG_Bx=ue,e.exports.SETARG_C=function(C,fe){return S(C,fe,14,9)},e.exports.SETARG_sBx=function(C,fe){return ue(C,fe+131071)},e.exports.SET_OPCODE=function(C,fe){return C.code=C.code&G(6,0)|fe<<0&A(6,0),we(C)},e.exports.SIZE_A=8,e.exports.SIZE_Ax=26,e.exports.SIZE_B=9,e.exports.SIZE_Bx=18,e.exports.SIZE_C=9,e.exports.SIZE_OP=6,e.exports.fullins=we,e.exports.getBMode=function(C){return T[C]>>4&3},e.exports.getCMode=function(C){return T[C]>>2&3},e.exports.getOpMode=function(C){return 3&T[C]},e.exports.iABC=0,e.exports.iABx=1,e.exports.iAsBx=2,e.exports.iAx=3,e.exports.testAMode=function(C){return 64&T[C]},e.exports.testTMode=function(C){return 128&T[C]}},function(e,lr,h){const{LUA_VERSION_MAJOR:T,LUA_VERSION_MINOR:A}=h(2),G="_"+T+"_"+A;e.exports.LUA_VERSUFFIX=G,e.exports.lua_assert=function(ue){},e.exports.luaopen_base=h(24).luaopen_base,e.exports.LUA_COLIBNAME="coroutine",e.exports.luaopen_coroutine=h(25).luaopen_coroutine,e.exports.LUA_TABLIBNAME="table",e.exports.luaopen_table=h(26).luaopen_table,e.exports.LUA_OSLIBNAME="os",e.exports.luaopen_os=h(27).luaopen_os,e.exports.LUA_STRLIBNAME="string",e.exports.luaopen_string=h(28).luaopen_string,e.exports.LUA_UTF8LIBNAME="utf8",e.exports.luaopen_utf8=h(29).luaopen_utf8,e.exports.LUA_BITLIBNAME="bit32",e.exports.LUA_MATHLIBNAME="math",e.exports.luaopen_math=h(30).luaopen_math,e.exports.LUA_DBLIBNAME="debug",e.exports.luaopen_debug=h(31).luaopen_debug,e.exports.LUA_LOADLIBNAME="package",e.exports.luaopen_package=h(32).luaopen_package,e.exports.LUA_FENGARILIBNAME="fengari",e.exports.luaopen_fengari=h(33).luaopen_fengari;const S=h(39);e.exports.luaL_openlibs=S.luaL_openlibs},function(e,lr,h){const{LUA_MULTRET:T,LUA_OPBNOT:A,LUA_OPEQ:G,LUA_OPLE:S,LUA_OPLT:ue,LUA_OPUNM:we,LUA_REGISTRYINDEX:C,LUA_RIDX_GLOBALS:fe,LUA_VERSION_NUM:K,constant_types:{LUA_NUMTAGS:Ie,LUA_TBOOLEAN:pe,LUA_TCCL:Le,LUA_TFUNCTION:H,LUA_TLCF:oe,LUA_TLCL:$,LUA_TLIGHTUSERDATA:Be,LUA_TLNGSTR:Me,LUA_TNIL:Ke,LUA_TNONE:Pe,LUA_TNUMFLT:Ye,LUA_TNUMINT:b,LUA_TSHRSTR:I,LUA_TTABLE:Y,LUA_TTHREAD:X,LUA_TUSERDATA:ee},thread_status:{LUA_OK:Ne},from_userstring:Fe,to_luastring:He}=h(1),{api_check:y}=h(4),W=h(11),Ue=h(8),{luaU_dump:Z}=h(37),je=h(13),d=h(6),k=h(12),{luaS_bless:m,luaS_new:ie,luaS_newliteral:_e}=h(10),nr=h(14),{LUAI_MAXSTACK:ze}=h(3),rr=h(15),tr=h(9),{ZIO:R}=h(19),N=d.TValue,de=d.CClosure,q=function(r){r.top++,y(r,r.top<=r.ci.top,"stack overflow")},Re=function(r,n){y(r,n<r.top-r.ci.funcOff,"not enough elements in the stack")},ar=function(r){if(!r)throw TypeError("invalid argument")},Je=function(r){ar(typeof r=="number"&&(0|r)===r)},ke=function(r){return r!==d.luaO_nilobject},w=function(r,n){let l=r.ci;if(n>0){let a=l.funcOff+n;return y(r,n<=l.top-(l.funcOff+1),"unacceptable index"),a>=r.top?d.luaO_nilobject:r.stack[a]}return n>C?(y(r,n!==0&&-n<=r.top,"invalid index"),r.stack[r.top+n]):n===C?r.l_G.l_registry:(y(r,(n=C-n)<=je.MAXUPVAL+1,"upvalue index too large"),l.func.ttislcf()?d.luaO_nilobject:n<=l.func.value.nupvalues?l.func.value.upvalue[n-1]:d.luaO_nilobject)},le=function(r,n){let l=r.ci;if(n>0){let a=l.funcOff+n;return y(r,n<=l.top-(l.funcOff+1),"unacceptable index"),a>=r.top?null:a}if(n>C)return y(r,n!==0&&-n<=r.top,"invalid index"),r.top+n;throw Error("attempt to use pseudo-index")},p=function(r,n){let l,a=r.ci.funcOff;n>=0?(y(r,n<=r.stack_last-(a+1),"new top too large"),l=a+1+n):(y(r,-(n+1)<=r.top-(a+1),"invalid new top"),l=r.top+n+1),Ue.adjust_top(r,l)},j=function(r,n){p(r,-n-1)},he=function(r,n,l){for(;n<l;n++,l--){let a=r.stack[n],u=new N(a.type,a.value);d.setobjs2s(r,n,l),d.setobj2s(r,l,u)}},g=function(r,n,l){let a=r.top-1,u=le(r,n),f=r.stack[u];y(r,ke(f)&&n>C,"index not in the stack"),y(r,(l>=0?l:-l)<=a-u+1,"invalid 'n'");let s=l>=0?a-l:u-l-1;he(r,u,s),he(r,s+1,r.top-1),he(r,u,r.top-1)},z=function(r,n,l){let a=w(r,n);w(r,l).setfrom(a)},se=function(r,n,l){if(ar(typeof n=="function"),Je(l),l===0)r.stack[r.top]=new N(oe,n);else{Re(r,l),y(r,l<=je.MAXUPVAL,"upvalue index too large");let a=new de(r,n,l);for(let u=0;u<l;u++)a.upvalue[u].setfrom(r.stack[r.top-l+u]);for(let u=1;u<l;u++)delete r.stack[--r.top];l>0&&--r.top,r.stack[r.top].setclCvalue(a)}q(r)},or=se,ir=function(r,n){se(r,n,0)},cr=ir,mr=function(r,n,l){let a=ie(r,Fe(l));Re(r,1),d.pushsvalue2s(r,a),y(r,r.top<=r.ci.top,"stack overflow"),rr.settable(r,n,r.stack[r.top-1],r.stack[r.top-2]),delete r.stack[--r.top],delete r.stack[--r.top]},Sr=function(r,n){mr(r,tr.luaH_getint(r.l_G.l_registry.value,fe),n)},Rr=function(r,n,l){let a=ie(r,Fe(l));return d.pushsvalue2s(r,a),y(r,r.top<=r.ci.top,"stack overflow"),rr.luaV_gettable(r,n,r.stack[r.top-1],r.top-1),r.stack[r.top-1].ttnov()},Cr=function(r,n,l){let a=w(r,n);return Je(l),y(r,a.ttistable(),"table expected"),d.pushobj2s(r,tr.luaH_getint(a.value,l)),y(r,r.top<=r.ci.top,"stack overflow"),r.stack[r.top-1].ttnov()},_=function(r,n,l){let a=new d.TValue(Y,tr.luaH_new(r));r.stack[r.top]=a,q(r)},Oe=function(r,n,l){switch(Je(l),n.ttype()){case Le:{let a=n.value;return 1<=l&&l<=a.nupvalues?{name:He("",!0),val:a.upvalue[l-1]}:null}case $:{let a=n.value,u=a.p;if(!(1<=l&&l<=u.upvalues.length))return null;let f=u.upvalues[l-1].name;return{name:f?f.getstr():He("(*no name)",!0),val:a.upvals[l-1]}}default:return null}},be=function(r,n){let l=w(r,n);if(!l.ttisstring()){if(!rr.cvt2str(l))return null;d.luaO_tostring(r,l)}return l.svalue()},ge=be,ae=function(r,n){return rr.tointeger(w(r,n))},ce=function(r,n){return rr.tonumber(w(r,n))},De=new WeakMap,Lr=function(r,n){Ue.luaD_callnoyield(r,n.funcOff,n.nresults)},dr=function(r,n){let l=w(r,n);return ke(l)?l.ttnov():Pe},xr=He("?"),Mr=function(r,n,l){y(r,l===T||r.ci.top-r.top>=l-n,"results from function overflow current stack size")},Qe=function(r,n,l,a,u){y(r,u===null||!(r.ci.callstatus&k.CIST_LUA),"cannot use continuations inside hooks"),Re(r,n+1),y(r,r.status===Ne,"cannot do calls on non-normal thread"),Mr(r,n,l);let f=r.top-(n+1);u!==null&&r.nny===0?(r.ci.c_k=u,r.ci.c_ctx=a,Ue.luaD_call(r,f,l)):Ue.luaD_callnoyield(r,f,l),l===T&&r.ci.top<r.top&&(r.ci.top=r.top)},sr=function(r,n,l,a,u,f){let s,U;y(r,f===null||!(r.ci.callstatus&k.CIST_LUA),"cannot use continuations inside hooks"),Re(r,n+1),y(r,r.status===Ne,"cannot do calls on non-normal thread"),Mr(r,n,l),U=a===0?0:le(r,a);let xe=r.top-(n+1);if(f===null||r.nny>0){let Ge={funcOff:xe,nresults:l};s=Ue.luaD_pcall(r,Lr,Ge,xe,U)}else{let Ge=r.ci;Ge.c_k=f,Ge.c_ctx=u,Ge.extra=xe,Ge.c_old_errfunc=r.errfunc,r.errfunc=U,Ge.callstatus&=~k.CIST_OAH|r.allowhook,Ge.callstatus|=k.CIST_YPCALL,Ue.luaD_call(r,xe,l),Ge.callstatus&=~k.CIST_YPCALL,r.errfunc=Ge.c_old_errfunc,s=Ne}return l===T&&r.ci.top<r.top&&(r.ci.top=r.top),s},br=function(r,n,l){let a=w(r,n);y(r,a.ttisLclosure(),"Lua function expected");let u=a.value;return Je(l),y(r,1<=l&&l<=u.p.upvalues.length,"invalid upvalue index"),{f:u,i:l-1}};e.exports.api_incr_top=q,e.exports.api_checknelems=Re,e.exports.lua_absindex=function(r,n){return n>0||n<=C?n:r.top-r.ci.funcOff+n},e.exports.lua_arith=function(r,n){n!==we&&n!==A?Re(r,2):(Re(r,1),d.pushobj2s(r,r.stack[r.top-1]),y(r,r.top<=r.ci.top,"stack overflow")),d.luaO_arith(r,n,r.stack[r.top-2],r.stack[r.top-1],r.stack[r.top-2]),delete r.stack[--r.top]},e.exports.lua_atpanic=function(r,n){let l=r.l_G.panic;return r.l_G.panic=n,l},e.exports.lua_atnativeerror=function(r,n){let l=r.l_G.atnativeerror;return r.l_G.atnativeerror=n,l},e.exports.lua_call=function(r,n,l){Qe(r,n,l,0,null)},e.exports.lua_callk=Qe,e.exports.lua_checkstack=function(r,n){let l,a=r.ci;return y(r,n>=0,"negative 'n'"),r.stack_last-r.top>n?l=!0:r.top+k.EXTRA_STACK>ze-n?l=!1:(Ue.luaD_growstack(r,n),l=!0),l&&a.top<r.top+n&&(a.top=r.top+n),l},e.exports.lua_compare=function(r,n,l,a){let u=w(r,n),f=w(r,l),s=0;if(ke(u)&&ke(f))switch(a){case G:s=rr.luaV_equalobj(r,u,f);break;case ue:s=rr.luaV_lessthan(r,u,f);break;case S:s=rr.luaV_lessequal(r,u,f);break;default:y(r,!1,"invalid option")}return s},e.exports.lua_concat=function(r,n){Re(r,n),n>=2?rr.luaV_concat(r,n):n===0&&(d.pushsvalue2s(r,m(r,He("",!0))),y(r,r.top<=r.ci.top,"stack overflow"))},e.exports.lua_copy=z,e.exports.lua_createtable=_,e.exports.lua_dump=function(r,n,l,a){Re(r,1);let u=r.stack[r.top-1];return u.ttisLclosure()?Z(r,u.value.p,n,l,a):1},e.exports.lua_error=function(r){Re(r,1),W.luaG_errormsg(r)},e.exports.lua_gc=function(){},e.exports.lua_getallocf=function(){return console.warn("lua_getallocf is not available"),0},e.exports.lua_getextraspace=function(){return console.warn("lua_getextraspace is not available"),0},e.exports.lua_getfield=function(r,n,l){return Rr(r,w(r,n),l)},e.exports.lua_getglobal=function(r,n){return Rr(r,tr.luaH_getint(r.l_G.l_registry.value,fe),n)},e.exports.lua_geti=function(r,n,l){let a=w(r,n);return Je(l),r.stack[r.top]=new N(b,l),q(r),rr.luaV_gettable(r,a,r.stack[r.top-1],r.top-1),r.stack[r.top-1].ttnov()},e.exports.lua_getmetatable=function(r,n){let l,a=w(r,n),u=!1;switch(a.ttnov()){case Y:case ee:l=a.value.metatable;break;default:l=r.l_G.mt[a.ttnov()]}return l!=null&&(r.stack[r.top]=new N(Y,l),q(r),u=!0),u},e.exports.lua_gettable=function(r,n){let l=w(r,n);return rr.luaV_gettable(r,l,r.stack[r.top-1],r.top-1),r.stack[r.top-1].ttnov()},e.exports.lua_gettop=function(r){return r.top-(r.ci.funcOff+1)},e.exports.lua_getupvalue=function(r,n,l){let a=Oe(0,w(r,n),l);if(a){let u=a.name,f=a.val;return d.pushobj2s(r,f),y(r,r.top<=r.ci.top,"stack overflow"),u}return null},e.exports.lua_getuservalue=function(r,n){let l=w(r,n);y(r,l.ttisfulluserdata(),"full userdata expected");let a=l.value.uservalue;return r.stack[r.top]=new N(a.type,a.value),q(r),r.stack[r.top-1].ttnov()},e.exports.lua_insert=function(r,n){g(r,n,1)},e.exports.lua_isboolean=function(r,n){return dr(r,n)===pe},e.exports.lua_iscfunction=function(r,n){let l=w(r,n);return l.ttislcf(l)||l.ttisCclosure()},e.exports.lua_isfunction=function(r,n){return dr(r,n)===H},e.exports.lua_isinteger=function(r,n){return w(r,n).ttisinteger()},e.exports.lua_islightuserdata=function(r,n){return dr(r,n)===Be},e.exports.lua_isnil=function(r,n){return dr(r,n)===Ke},e.exports.lua_isnone=function(r,n){return dr(r,n)===Pe},e.exports.lua_isnoneornil=function(r,n){return dr(r,n)<=0},e.exports.lua_isnumber=function(r,n){return rr.tonumber(w(r,n))!==!1},e.exports.lua_isproxy=function(r,n){let l=De.get(r);return!!l&&(n===null||n.l_G===l)},e.exports.lua_isstring=function(r,n){let l=w(r,n);return l.ttisstring()||rr.cvt2str(l)},e.exports.lua_istable=function(r,n){return w(r,n).ttistable()},e.exports.lua_isthread=function(r,n){return dr(r,n)===X},e.exports.lua_isuserdata=function(r,n){let l=w(r,n);return l.ttisfulluserdata(l)||l.ttislightuserdata()},e.exports.lua_len=function(r,n){let l=w(r,n),a=new N;rr.luaV_objlen(r,a,l),r.stack[r.top]=a,q(r)},e.exports.lua_load=function(r,n,l,a,u){a=a?Fe(a):xr,u!==null&&(u=Fe(u));let f=new R(r,n,l),s=Ue.luaD_protectedparser(r,f,a,u);if(s===Ne){let U=r.stack[r.top-1].value;if(U.nupvalues>=1){let xe=tr.luaH_getint(r.l_G.l_registry.value,fe);U.upvals[0].setfrom(xe)}}return s},e.exports.lua_newtable=function(r){_(r)},e.exports.lua_newuserdata=function(r,n){let l=(function(a,u){return new d.Udata(a,u)})(r,n);return r.stack[r.top]=new d.TValue(ee,l),q(r),l.data},e.exports.lua_next=function(r,n){let l=w(r,n);return y(r,l.ttistable(),"table expected"),r.stack[r.top]=new N,tr.luaH_next(r,l.value,r.top-1)?(q(r),1):(delete r.stack[r.top],delete r.stack[--r.top],0)},e.exports.lua_pcall=function(r,n,l,a){return sr(r,n,l,a,0,null)},e.exports.lua_pcallk=sr,e.exports.lua_pop=j,e.exports.lua_pushboolean=function(r,n){r.stack[r.top]=new N(pe,!!n),q(r)},e.exports.lua_pushcclosure=se,e.exports.lua_pushcfunction=ir,e.exports.lua_pushfstring=function(r,n,...l){return n=Fe(n),d.luaO_pushvfstring(r,n,l)},e.exports.lua_pushglobaltable=function(r){Cr(r,C,fe)},e.exports.lua_pushinteger=function(r,n){Je(n),r.stack[r.top]=new N(b,n),q(r)},e.exports.lua_pushjsclosure=or,e.exports.lua_pushjsfunction=cr,e.exports.lua_pushlightuserdata=function(r,n){r.stack[r.top]=new N(Be,n),q(r)},e.exports.lua_pushliteral=function(r,n){if(n==null)r.stack[r.top]=new N(Ke,null),r.top++;else{ar(typeof n=="string");let l=_e(r,n);d.pushsvalue2s(r,l),n=l.getstr()}return y(r,r.top<=r.ci.top,"stack overflow"),n},e.exports.lua_pushlstring=function(r,n,l){let a;return Je(l),l===0?(n=He("",!0),a=m(r,n)):(n=Fe(n),y(r,n.length>=l,"invalid length to lua_pushlstring"),a=ie(r,n.subarray(0,l))),d.pushsvalue2s(r,a),y(r,r.top<=r.ci.top,"stack overflow"),a.value},e.exports.lua_pushnil=function(r){r.stack[r.top]=new N(Ke,null),q(r)},e.exports.lua_pushnumber=function(r,n){ar(typeof n=="number"),r.stack[r.top]=new N(Ye,n),q(r)},e.exports.lua_pushstring=function(r,n){if(n==null)r.stack[r.top]=new N(Ke,null),r.top++;else{let l=ie(r,Fe(n));d.pushsvalue2s(r,l),n=l.getstr()}return y(r,r.top<=r.ci.top,"stack overflow"),n},e.exports.lua_pushthread=function(r){return r.stack[r.top]=new N(X,r),q(r),r.l_G.mainthread===r},e.exports.lua_pushvalue=function(r,n){d.pushobj2s(r,w(r,n)),y(r,r.top<=r.ci.top,"stack overflow")},e.exports.lua_pushvfstring=function(r,n,l){return n=Fe(n),d.luaO_pushvfstring(r,n,l)},e.exports.lua_rawequal=function(r,n,l){let a=w(r,n),u=w(r,l);return ke(a)&&ke(u)?rr.luaV_equalobj(null,a,u):0},e.exports.lua_rawget=function(r,n){let l=w(r,n);return y(r,l.ttistable(l),"table expected"),d.setobj2s(r,r.top-1,tr.luaH_get(r,l.value,r.stack[r.top-1])),r.stack[r.top-1].ttnov()},e.exports.lua_rawgeti=Cr,e.exports.lua_rawgetp=function(r,n,l){let a=w(r,n);y(r,a.ttistable(),"table expected");let u=new N(Be,l);return d.pushobj2s(r,tr.luaH_get(r,a.value,u)),y(r,r.top<=r.ci.top,"stack overflow"),r.stack[r.top-1].ttnov()},e.exports.lua_rawlen=function(r,n){let l=w(r,n);switch(l.ttype()){case I:case Me:return l.vslen();case ee:return l.value.len;case Y:return tr.luaH_getn(l.value);default:return 0}},e.exports.lua_rawset=function(r,n){Re(r,2);let l=w(r,n);y(r,l.ttistable(),"table expected");let a=r.stack[r.top-2],u=r.stack[r.top-1];tr.luaH_setfrom(r,l.value,a,u),tr.invalidateTMcache(l.value),delete r.stack[--r.top],delete r.stack[--r.top]},e.exports.lua_rawseti=function(r,n,l){Je(l),Re(r,1);let a=w(r,n);y(r,a.ttistable(),"table expected"),tr.luaH_setint(a.value,l,r.stack[r.top-1]),delete r.stack[--r.top]},e.exports.lua_rawsetp=function(r,n,l){Re(r,1);let a=w(r,n);y(r,a.ttistable(),"table expected");let u=new N(Be,l),f=r.stack[r.top-1];tr.luaH_setfrom(r,a.value,u,f),delete r.stack[--r.top]},e.exports.lua_register=function(r,n,l){ir(r,l),Sr(r,n)},e.exports.lua_remove=function(r,n){g(r,n,-1),j(r,1)},e.exports.lua_replace=function(r,n){z(r,-1,n),j(r,1)},e.exports.lua_rotate=g,e.exports.lua_setallocf=function(){return console.warn("lua_setallocf is not available"),0},e.exports.lua_setfield=function(r,n,l){mr(r,w(r,n),l)},e.exports.lua_setglobal=Sr,e.exports.lua_seti=function(r,n,l){Je(l),Re(r,1);let a=w(r,n);r.stack[r.top]=new N(b,l),q(r),rr.settable(r,a,r.stack[r.top-1],r.stack[r.top-2]),delete r.stack[--r.top],delete r.stack[--r.top]},e.exports.lua_setmetatable=function(r,n){let l;Re(r,1);let a=w(r,n);switch(r.stack[r.top-1].ttisnil()?l=null:(y(r,r.stack[r.top-1].ttistable(),"table expected"),l=r.stack[r.top-1].value),a.ttnov()){case ee:case Y:a.value.metatable=l;break;default:r.l_G.mt[a.ttnov()]=l}return delete r.stack[--r.top],!0},e.exports.lua_settable=function(r,n){Re(r,2);let l=w(r,n);rr.settable(r,l,r.stack[r.top-2],r.stack[r.top-1]),delete r.stack[--r.top],delete r.stack[--r.top]},e.exports.lua_settop=p,e.exports.lua_setupvalue=function(r,n,l){let a=w(r,n);Re(r,1);let u=Oe(0,a,l);if(u){let f=u.name;return u.val.setfrom(r.stack[r.top-1]),delete r.stack[--r.top],f}return null},e.exports.lua_setuservalue=function(r,n){Re(r,1);let l=w(r,n);y(r,l.ttisfulluserdata(),"full userdata expected"),l.value.uservalue.setfrom(r.stack[r.top-1]),delete r.stack[--r.top]},e.exports.lua_status=function(r){return r.status},e.exports.lua_stringtonumber=function(r,n){let l=new N,a=d.luaO_str2num(n,l);return a!==0&&(r.stack[r.top]=l,q(r)),a},e.exports.lua_toboolean=function(r,n){return!w(r,n).l_isfalse()},e.exports.lua_tocfunction=function(r,n){let l=w(r,n);return l.ttislcf()||l.ttisCclosure()?l.value:null},e.exports.lua_todataview=function(r,n){let l=be(r,n);return new DataView(l.buffer,l.byteOffset,l.byteLength)},e.exports.lua_tointeger=function(r,n){let l=ae(r,n);return l===!1?0:l},e.exports.lua_tointegerx=ae,e.exports.lua_tojsstring=function(r,n){let l=w(r,n);if(!l.ttisstring()){if(!rr.cvt2str(l))return null;d.luaO_tostring(r,l)}return l.jsstring()},e.exports.lua_tolstring=be,e.exports.lua_tonumber=function(r,n){let l=ce(r,n);return l===!1?0:l},e.exports.lua_tonumberx=ce,e.exports.lua_topointer=function(r,n){let l=w(r,n);switch(l.ttype()){case Y:case $:case Le:case oe:case X:case ee:case Be:return l.value;default:return null}},e.exports.lua_toproxy=function(r,n){let l=w(r,n);return(function(a,u,f){let s=function(U){y(U,U instanceof k.lua_State&&a===U.l_G,"must be from same global state"),U.stack[U.top]=new N(u,f),q(U)};return De.set(s,a),s})(r.l_G,l.type,l.value)},e.exports.lua_tostring=ge,e.exports.lua_tothread=function(r,n){let l=w(r,n);return l.ttisthread()?l.value:null},e.exports.lua_touserdata=function(r,n){let l=w(r,n);switch(l.ttnov()){case ee:return l.value.data;case Be:return l.value;default:return null}},e.exports.lua_type=dr,e.exports.lua_typename=function(r,n){return y(r,Pe<=n&&n<Ie,"invalid tag"),nr.ttypename(n)},e.exports.lua_upvalueid=function(r,n,l){let a=w(r,n);switch(a.ttype()){case $:{let u=br(r,n,l);return u.f.upvals[u.i]}case Le:{let u=a.value;return y(r,(0|l)===l&&l>0&&l<=u.nupvalues,"invalid upvalue index"),u.upvalue[l-1]}default:return y(r,!1,"closure expected"),null}},e.exports.lua_upvaluejoin=function(r,n,l,a,u){let f=br(r,n,l),s=br(r,a,u),U=s.f.upvals[s.i];f.f.upvals[f.i]=U},e.exports.lua_version=function(r){return r===null?K:r.l_G.version},e.exports.lua_xmove=function(r,n,l){if(r!==n){Re(r,l),y(r,r.l_G===n.l_G,"moving among independent states"),y(r,n.ci.top-n.top>=l,"stack overflow"),r.top-=l;for(let a=0;a<l;a++)n.stack[n.top]=new d.TValue,d.setobj2s(n,n.top,r.stack[r.top+a]),delete r.stack[r.top+a],n.top++}}},function(e,lr,h){const{lua_assert:T}=h(4),A=function(G){let S=G.reader(G.L,G.data);if(S===null)return-1;T(S instanceof Uint8Array,"Should only load binary of array of bytes");let ue=S.length;return ue===0?-1:(G.buffer=S,G.off=0,G.n=ue-1,G.buffer[G.off++])};e.exports.EOZ=-1,e.exports.luaZ_buffer=function(G){return G.buffer.subarray(0,G.n)},e.exports.luaZ_buffremove=function(G,S){G.n-=S},e.exports.luaZ_fill=A,e.exports.luaZ_read=function(G,S,ue,we){for(;we;){if(G.n===0){if(A(G)===-1)return we;G.n++,G.off--}let C=we<=G.n?we:G.n;for(let fe=0;fe<C;fe++)S[ue++]=G.buffer[G.off++];G.n-=C,G.n===0&&(G.buffer=null),we-=C}return 0},e.exports.luaZ_resetbuffer=function(G){G.n=0},e.exports.luaZ_resizebuffer=function(G,S,ue){let we=new Uint8Array(ue);S.buffer&&we.set(S.buffer),S.buffer=we},e.exports.MBuffer=class{constructor(){this.buffer=null,this.n=0}},e.exports.ZIO=class{constructor(G,S,ue){this.L=G,T(typeof S=="function","ZIO requires a reader"),this.reader=S,this.data=ue,this.n=0,this.buffer=null,this.off=0}zgetc(){return this.n-- >0?this.buffer[this.off++]:A(this)}}},function(e,lr,h){const{constant_types:{LUA_TBOOLEAN:T,LUA_TLNGSTR:A},thread_status:{LUA_ERRSYNTAX:G},to_luastring:S}=h(1),{LUA_MINBUFFER:ue,MAX_INT:we,lua_assert:C}=h(4),fe=h(11),K=h(8),{lisdigit:Ie,lislalnum:pe,lislalpha:Le,lisspace:H,lisxdigit:oe}=h(22),$=h(6),{luaS_bless:Be,luaS_hash:Me,luaS_hashlongstr:Ke,luaS_new:Pe}=h(10),Ye=h(9),{EOZ:b,luaZ_buffer:I,luaZ_buffremove:Y,luaZ_resetbuffer:X,luaZ_resizebuffer:ee}=h(19),Ne=S("_ENV",!0),Fe={TK_AND:257,TK_BREAK:258,TK_DO:259,TK_ELSE:260,TK_ELSEIF:261,TK_END:262,TK_FALSE:263,TK_FOR:264,TK_FUNCTION:265,TK_GOTO:266,TK_IF:267,TK_IN:268,TK_LOCAL:269,TK_NIL:270,TK_NOT:271,TK_OR:272,TK_REPEAT:273,TK_RETURN:274,TK_THEN:275,TK_TRUE:276,TK_UNTIL:277,TK_WHILE:278,TK_IDIV:279,TK_CONCAT:280,TK_DOTS:281,TK_EQ:282,TK_GE:283,TK_LE:284,TK_NE:285,TK_SHL:286,TK_SHR:287,TK_DBCOLON:288,TK_EOS:289,TK_FLT:290,TK_INT:291,TK_NAME:292,TK_STRING:293},He=["and","break","do","else","elseif","end","false","for","function","goto","if","in","local","nil","not","or","repeat","return","then","true","until","while","//","..","...","==",">=","<=","~=","<<",">>","::","<eof>","<number>","<integer>","<name>","<string>"].map((p,j)=>S(p));class y{constructor(){this.r=NaN,this.i=NaN,this.ts=null}}class W{constructor(){this.token=NaN,this.seminfo=new y}}const Ue=function(p,j){let he=p.buff;if(he.n+1>he.buffer.length){he.buffer.length>=we/2&&tr(p,S("lexical element too long",!0),0);let g=2*he.buffer.length;ee(p.L,he,g)}he.buffer[he.n++]=j<0?255+j+1:j},Z=function(p,j){if(j<257)return $.luaO_pushfstring(p.L,S("'%c'",!0),j);{let he=He[j-257];return j<289?$.luaO_pushfstring(p.L,S("'%s'",!0),he):he}},je=function(p){return p.current===10||p.current===13},d=function(p){p.current=p.z.zgetc()},k=function(p){Ue(p,p.current),d(p)},m=new $.TValue(T,!0),ie=function(p,j){let he=p.L,g=Pe(he,j),z=p.h.strong.get(Ke(g));if(z)g=z.key.tsvalue();else{let se=new $.TValue(A,g);Ye.luaH_setfrom(he,p.h,se,m)}return g},_e=function(p){let j=p.current;C(je(p)),d(p),je(p)&&p.current!==j&&d(p),++p.linenumber>=we&&tr(p,S("chunk has too many lines",!0),0)},nr=function(p,j){return p.current===j&&(d(p),!0)},ze=function(p,j){return(p.current===j[0].charCodeAt(0)||p.current===j[1].charCodeAt(0))&&(k(p),!0)},rr=function(p,j){let he="Ee",g=p.current;for(C(Ie(p.current)),k(p),g===48&&ze(p,"xX")&&(he="Pp");;)if(ze(p,he)&&ze(p,"-+"),oe(p.current))k(p);else{if(p.current!==46)break;k(p)}let z=new $.TValue;return $.luaO_str2num(I(p.buff),z)===0&&tr(p,S("malformed number",!0),290),z.ttisinteger()?(j.i=z.value,291):(C(z.ttisfloat()),j.r=z.value,290)},tr=function(p,j,he){j=fe.luaG_addinfo(p.L,j,p.source,p.linenumber),he&&$.luaO_pushfstring(p.L,S("%s near %s"),j,(function(g,z){switch(z){case 292:case 293:case 290:case 291:return $.luaO_pushfstring(g.L,S("'%s'",!0),I(g.buff));default:return Z(g,z)}})(p,he)),K.luaD_throw(p.L,G)},R=function(p){let j=0,he=p.current;for(C(he===91||he===93),k(p);p.current===61;)k(p),j++;return p.current===he?j:-j-1},N=function(p,j,he){let g=p.linenumber;k(p),je(p)&&_e(p);let z=!1;for(;!z;)switch(p.current){case b:tr(p,S(`unfinished long ${j?"string":"comment"} (starting at line ${g})`),289);break;case 93:R(p)===he&&(k(p),z=!0);break;case 10:case 13:Ue(p,10),_e(p),j||X(p.buff);break;default:j?k(p):d(p)}j&&(j.ts=ie(p,p.buff.buffer.subarray(2+he,p.buff.n-(2+he))))},de=function(p,j,he){j||(p.current!==b&&k(p),tr(p,he,293))},q=function(p){return k(p),de(p,oe(p.current),S("hexadecimal digit expected",!0)),$.luaO_hexavalue(p.current)},Re=function(p){let j=q(p);return j=(j<<4)+q(p),Y(p.buff,2),j},ar=function(p){let j=new Uint8Array($.UTF8BUFFSZ),he=$.luaO_utf8esc(j,(function(g){let z=4;k(g),de(g,g.current===123,S("missing '{'",!0));let se=q(g);for(k(g);oe(g.current);)z++,se=(se<<4)+$.luaO_hexavalue(g.current),de(g,se<=1114111,S("UTF-8 value too large",!0)),k(g);return de(g,g.current===125,S("missing '}'",!0)),d(g),Y(g.buff,z),se})(p));for(;he>0;he--)Ue(p,j[$.UTF8BUFFSZ-he])},Je=function(p){let j,he=0;for(j=0;j<3&&Ie(p.current);j++)he=10*he+p.current-48,k(p);return de(p,he<=255,S("decimal escape too large",!0)),Y(p.buff,j),he},ke=function(p,j,he){for(k(p);p.current!==j;)switch(p.current){case b:tr(p,S("unfinished string",!0),289);break;case 10:case 13:tr(p,S("unfinished string",!0),293);break;case 92:{let g,z;switch(k(p),p.current){case 97:z=7,g="read_save";break;case 98:z=8,g="read_save";break;case 102:z=12,g="read_save";break;case 110:z=10,g="read_save";break;case 114:z=13,g="read_save";break;case 116:z=9,g="read_save";break;case 118:z=11,g="read_save";break;case 120:z=Re(p),g="read_save";break;case 117:ar(p),g="no_save";break;case 10:case 13:_e(p),z=10,g="only_save";break;case 92:case 34:case 39:z=p.current,g="read_save";break;case b:g="no_save";break;case 122:for(Y(p.buff,1),d(p);H(p.current);)je(p)?_e(p):d(p);g="no_save";break;default:de(p,Ie(p.current),S("invalid escape sequence",!0)),z=Je(p),g="only_save"}g==="read_save"&&d(p),g!=="read_save"&&g!=="only_save"||(Y(p.buff,1),Ue(p,z));break}default:k(p)}k(p),he.ts=ie(p,p.buff.buffer.subarray(1,p.buff.n-1))},w=Object.create(null);He.forEach((p,j)=>w[Me(p)]=j);const le=function(p,j){for(X(p.buff);;)switch(C(typeof p.current=="number"),p.current){case 10:case 13:_e(p);break;case 32:case 12:case 9:case 11:d(p);break;case 45:if(d(p),p.current!==45)return 45;if(d(p),p.current===91){let he=R(p);if(X(p.buff),he>=0){N(p,null,he),X(p.buff);break}}for(;!je(p)&&p.current!==b;)d(p);break;case 91:{let he=R(p);return he>=0?(N(p,j,he),293):(he!==-1&&tr(p,S("invalid long string delimiter",!0),293),91)}case 61:return d(p),nr(p,61)?282:61;case 60:return d(p),nr(p,61)?284:nr(p,60)?286:60;case 62:return d(p),nr(p,61)?283:nr(p,62)?287:62;case 47:return d(p),nr(p,47)?279:47;case 126:return d(p),nr(p,61)?285:126;case 58:return d(p),nr(p,58)?288:58;case 34:case 39:return ke(p,p.current,j),293;case 46:return k(p),nr(p,46)?nr(p,46)?281:280:Ie(p.current)?rr(p,j):46;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return rr(p,j);case b:return 289;default:if(Le(p.current)){do k(p);while(pe(p.current));let he=ie(p,I(p.buff));j.ts=he;let g=w[Ke(he)];return g!==void 0&&g<=22?g+257:292}{let he=p.current;return d(p),he}}};e.exports.FIRST_RESERVED=257,e.exports.LUA_ENV=Ne,e.exports.LexState=class{constructor(){this.current=NaN,this.linenumber=NaN,this.lastline=NaN,this.t=new W,this.lookahead=new W,this.fs=null,this.L=null,this.z=null,this.buff=null,this.h=null,this.dyd=null,this.source=null,this.envn=null}},e.exports.RESERVED=Fe,e.exports.isreserved=function(p){let j=w[Ke(p)];return j!==void 0&&j<=22},e.exports.luaX_lookahead=function(p){return C(p.lookahead.token===289),p.lookahead.token=le(p,p.lookahead.seminfo),p.lookahead.token},e.exports.luaX_newstring=ie,e.exports.luaX_next=function(p){p.lastline=p.linenumber,p.lookahead.token!==289?(p.t.token=p.lookahead.token,p.t.seminfo.i=p.lookahead.seminfo.i,p.t.seminfo.r=p.lookahead.seminfo.r,p.t.seminfo.ts=p.lookahead.seminfo.ts,p.lookahead.token=289):p.t.token=le(p,p.t.seminfo)},e.exports.luaX_setinput=function(p,j,he,g,z){j.t={token:0,seminfo:new y},j.L=p,j.current=z,j.lookahead={token:289,seminfo:new y},j.z=he,j.fs=null,j.linenumber=1,j.lastline=1,j.source=g,j.envn=Be(p,Ne),ee(p,j.buff,ue)},e.exports.luaX_syntaxerror=function(p,j){tr(p,j,p.t.token)},e.exports.luaX_token2str=Z,e.exports.luaX_tokens=He},function(e,lr,h){const{lua:T,lauxlib:A,lualib:G,to_luastring:S}=h(0),{LUA_MULTRET:ue,LUA_OK:we,LUA_REGISTRYINDEX:C,LUA_RIDX_MAINTHREAD:fe,LUA_TBOOLEAN:K,LUA_TFUNCTION:Ie,LUA_TLIGHTUSERDATA:pe,LUA_TNIL:Le,LUA_TNONE:H,LUA_TNUMBER:oe,LUA_TSTRING:$,LUA_TTABLE:Be,LUA_TTHREAD:Me,LUA_TUSERDATA:Ke,lua_atnativeerror:Pe,lua_call:Ye,lua_getfield:b,lua_gettable:I,lua_gettop:Y,lua_isnil:X,lua_isproxy:ee,lua_newuserdata:Ne,lua_pcall:Fe,lua_pop:He,lua_pushboolean:y,lua_pushcfunction:W,lua_pushinteger:Ue,lua_pushlightuserdata:Z,lua_pushliteral:je,lua_pushnil:d,lua_pushnumber:k,lua_pushstring:m,lua_pushvalue:ie,lua_rawgeti:_e,lua_rawgetp:nr,lua_rawsetp:ze,lua_rotate:rr,lua_setfield:tr,lua_settable:R,lua_settop:N,lua_toboolean:de,lua_tojsstring:q,lua_tonumber:Re,lua_toproxy:ar,lua_tothread:Je,lua_touserdata:ke,lua_type:w}=T,{luaL_argerror:le,luaL_checkany:p,luaL_checkoption:j,luaL_checkstack:he,luaL_checkudata:g,luaL_error:z,luaL_getmetafield:se,luaL_newlib:or,luaL_newmetatable:ir,luaL_requiref:cr,luaL_setfuncs:mr,luaL_setmetatable:Sr,luaL_testudata:Rr,luaL_tolstring:Cr}=A,{luaopen_base:_}=G,Oe=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:(0,eval)("this");let be,ge,ae;if(typeof Reflect<"u")be=Reflect.apply,ge=Reflect.construct,ae=Reflect.deleteProperty;else{const L=Function.apply,ne=Function.bind;be=function(P,Ce,_r){return L.call(P,Ce,_r)},ge=function(P,Ce){switch(Ce.length){case 0:return new P;case 1:return new P(Ce[0]);case 2:return new P(Ce[0],Ce[1]);case 3:return new P(Ce[0],Ce[1],Ce[2]);case 4:return new P(Ce[0],Ce[1],Ce[2],Ce[3])}let _r=[null];return _r.push.apply(_r,Ce),new(ne.apply(P,_r))},ae=Function("t","k","delete t[k]")}const ce=String.prototype.concat.bind(""),De=function(L){return typeof L=="object"?L!==null:typeof L=="function"},Lr=S("js object"),dr=function(L,ne){let P=Rr(L,ne,Lr);return P?P.data:void 0},xr=function(L,ne){return g(L,ne,Lr).data},Mr=function(L,ne){Ne(L).data=ne,Sr(L,Lr)},Qe=function(L){_e(L,C,fe);let ne=Je(L,-1);return He(L,1),ne},sr=new WeakMap,br=function(L,ne){switch(typeof ne){case"undefined":d(L);break;case"number":k(L,ne);break;case"string":m(L,S(ne));break;case"boolean":y(L,ne);break;case"symbol":Z(L,ne);break;case"function":if(ee(ne,L)){ne(L);break}case"object":if(ne===null){if(nr(L,C,null)!==Ke)throw Error("js library not loaded into lua_State");break}default:{let P=sr.get(Qe(L));if(!P)throw Error("js library not loaded into lua_State");let Ce=P.get(ne);Ce?Ce(L):(Mr(L,ne),Ce=ar(L,-1),P.set(ne,Ce))}}},r=function(L){let ne=ke(L,1);return br(L,ne),1},n=function(L,ne){switch(w(L,ne)){case H:case Le:return;case K:return de(L,ne);case pe:return ke(L,ne);case oe:return Re(L,ne);case $:return q(L,ne);case Ke:{let P=dr(L,ne);if(P!==void 0)return P}case Be:case Ie:case Me:default:return Tr(L,ar(L,ne))}},l=function(L,ne){let P=Fe(L,ne,1,0),Ce=n(L,-1);switch(He(L,1),P){case we:return Ce;default:throw Ce}},a=function(L,ne,P,Ce,_r){if(!De(Ce))throw new TypeError("`args` argument must be an object");let fr=+Ce.length;fr>=0||(fr=0),he(L,2+fr,null);let ur=Y(L);ne(L),br(L,P);for(let kr=0;kr<fr;kr++)br(L,Ce[kr]);switch(Fe(L,1+fr,_r,0)){case we:{let kr=Y(L)-ur,Br=new Array(kr);for(let hr=0;hr<kr;hr++)Br[hr]=n(L,ur+hr+1);return N(L,ur),Br}default:{let kr=n(L,-1);throw N(L,ur),kr}}},u=function(L){return I(L,1),1},f=function(L,ne,P){return he(L,3,null),W(L,u),ne(L),br(L,P),l(L,2)},s=function(L,ne,P){switch(he(L,3,null),W(L,u),ne(L),br(L,P),Fe(L,2,1,0)){case we:{let Ce=X(L,-1);return He(L,1),!Ce}default:{let Ce=n(L,-1);throw He(L,1),Ce}}},U=function(L,ne,P,Ce){switch(he(L,4,null),W(L,function(_r){return R(_r,1),0}),ne(L),br(L,P),br(L,Ce),Fe(L,3,0,0)){case we:return;default:{let _r=n(L,-1);throw He(L,1),_r}}},xe=function(L,ne,P){switch(he(L,4,null),W(L,function(Ce){return R(Ce,1),0}),ne(L),br(L,P),d(L),Fe(L,3,0,0)){case we:return;default:{let Ce=n(L,-1);throw He(L,1),Ce}}},Ge=function(L,ne){return he(L,2,null),W(L,function(P){return Cr(P,1),1}),ne(L),l(L,1)},Ar=function(){let L=this.L;he(L,3,null);let ne=Y(L);switch(this.iter(L),this.state(L),this.last(L),Fe(L,2,ue,0)){case we:{let P;if(this.last=ar(L,ne+1),X(L,-1))P={done:!0,value:void 0};else{let Ce=Y(L)-ne,_r=new Array(Ce);for(let fr=0;fr<Ce;fr++)_r[fr]=n(L,ne+fr+1);P={done:!1,value:_r}}return N(L,ne),P}default:{let P=n(L,-1);throw He(L,1),P}}},Tr=function(L,ne){const P=Qe(L);let Ce=function(){return a(P,ne,this,arguments,1)[0]};Ce.apply=function(fr,ur){return a(P,ne,fr,ur,1)[0]},Ce.invoke=function(fr,ur){return a(P,ne,fr,ur,ue)},Ce.get=function(fr){return f(P,ne,fr)},Ce.has=function(fr){return s(P,ne,fr)},Ce.set=function(fr,ur){return U(P,ne,fr,ur)},Ce.delete=function(fr){return xe(P,ne,fr)},Ce.toString=function(){return Ge(P,ne)},typeof Symbol=="function"&&(Ce[Symbol.toStringTag]="Fengari object",Ce[Symbol.iterator]=function(){return(function(fr,ur){switch(he(fr,1,null),W(fr,function(kr){return cr(kr,S("_G"),_,0),b(kr,-1,S("pairs")),ur(kr),Ye(kr,1,3),3}),Fe(fr,0,3,0)){case we:{let kr=ar(fr,-3),Br=ar(fr,-2),hr=ar(fr,-1);return He(fr,3),{L:fr,iter:kr,state:Br,last:hr,next:Ar}}default:{let kr=n(fr,-1);throw He(fr,1),kr}}})(P,ne)},Symbol.toPrimitive&&(Ce[Symbol.toPrimitive]=function(fr){if(fr==="string")return Ge(P,ne)}));let _r=sr.get(P);if(!_r)throw Error("js library not loaded into lua_State");return _r.set(Ce,ne),Ce},M={new:function(L){let ne=n(L,1),P=Y(L)-1,Ce=new Array(P);for(let _r=0;_r<P;_r++)Ce[_r]=n(L,_r+2);return br(L,ge(ne,Ce)),1},tonumber:function(L){let ne=n(L,1);return k(L,+ne),1},tostring:function(L){let ne=n(L,1);return je(L,ce(ne)),1},instanceof:function(L){let ne=n(L,1),P=n(L,2);return y(L,ne instanceof P),1},typeof:function(L){let ne=n(L,1);return je(L,typeof ne),1}};if(typeof Symbol=="function"&&Symbol.iterator){const L=function(P,Ce){let _r=xr(P,Ce),fr=_r[Symbol.iterator];fr||le(P,Ce,S("object not iterable"));let ur=be(fr,_r,[]);return De(ur)||le(P,Ce,S("Result of the Symbol.iterator method is not an object")),ur},ne=function(P){let Ce=n(P,1).next();return Ce.done?0:(br(P,Ce.value),1)};M.of=function(P){let Ce=L(P,1);return W(P,ne),br(P,Ce),2}}if(typeof Proxy=="function"&&typeof Symbol=="function"){const L=Symbol("lua_State"),ne=Symbol("fengari-proxy"),P={apply:function(hr,Er,vr){return a(hr[L],hr[ne],Er,vr,1)[0]},construct:function(hr,Er){let vr=hr[L],wr=hr[ne],Ir=Er.length;he(vr,2+Ir,null),wr(vr);let Hr=Y(vr);if(se(vr,Hr,S("construct"))===Le)throw He(vr,1),new TypeError("not a constructor");rr(vr,Hr,1);for(let Vr=0;Vr<Ir;Vr++)br(vr,Er[Vr]);return l(vr,1+Ir)},defineProperty:function(hr,Er,vr){let wr=hr[L],Ir=hr[ne];return he(wr,4,null),Ir(wr),se(wr,-1,S("defineProperty"))===Le?(He(wr,1),!1):(rr(wr,-2,1),br(wr,Er),br(wr,vr),l(wr,3))},deleteProperty:function(hr,Er){return xe(hr[L],hr[ne],Er)},get:function(hr,Er){return f(hr[L],hr[ne],Er)},getOwnPropertyDescriptor:function(hr,Er){let vr=hr[L],wr=hr[ne];if(he(vr,3,null),wr(vr),se(vr,-1,S("getOwnPropertyDescriptor"))!==Le)return rr(vr,-2,1),br(vr,Er),l(vr,2);He(vr,1)},getPrototypeOf:function(hr){let Er=hr[L],vr=hr[ne];return he(Er,2,null),vr(Er),se(Er,-1,S("getPrototypeOf"))===Le?(He(Er,1),null):(rr(Er,-2,1),l(Er,1))},has:function(hr,Er){return s(hr[L],hr[ne],Er)},ownKeys:function(hr){let Er=hr[L],vr=hr[ne];if(he(Er,2,null),vr(Er),se(Er,-1,S("ownKeys"))===Le)throw He(Er,1),Error("ownKeys unknown for fengari object");return rr(Er,-2,1),l(Er,1)},set:function(hr,Er,vr){return U(hr[L],hr[ne],Er,vr),!0},setPrototypeOf:function(hr,Er){let vr=hr[L],wr=hr[ne];return he(vr,3,null),wr(vr),se(vr,-1,S("setPrototypeOf"))===Le?(He(vr,1),!1):(rr(vr,-2,1),br(vr,Er),l(vr,2))}},Ce=function(){let hr=(function(){}).bind();return delete hr.length,delete hr.name,hr},_r=Function("return ()=>void 0;"),fr=function(){let hr=_r();return delete hr.length,delete hr.name,hr},ur=function(hr,Er,vr){const wr=Qe(hr);let Ir;switch(vr){case"function":Ir=Ce();break;case"arrow_function":Ir=fr();break;case"object":Ir={};break;default:throw TypeError("invalid type to createproxy")}return Ir[ne]=Er,Ir[L]=wr,new Proxy(Ir,P)},kr=["function","arrow_function","object"],Br=kr.map(hr=>S(hr));M.createproxy=function(hr){p(hr,1);let Er=kr[j(hr,2,Br[0],Br)],vr=ur(hr,ar(hr,1),Er);return br(hr,vr),1}}let me={__index:function(L){let ne=xr(L,1),P=n(L,2);return br(L,ne[P]),1},__newindex:function(L){let ne=xr(L,1),P=n(L,2),Ce=n(L,3);return Ce===void 0?ae(ne,P):ne[P]=Ce,0},__tostring:function(L){let ne=xr(L,1),P=ce(ne);return m(L,S(P)),1},__call:function(L){let ne,P=xr(L,1),Ce=Y(L)-1,_r=new Array(Math.max(0,Ce-1));if(Ce>0&&(ne=n(L,2),Ce-- >0))for(let fr=0;fr<Ce;fr++)_r[fr]=n(L,fr+3);return br(L,be(P,ne,_r)),1},__pairs:function(L){let ne,P,Ce,_r,fr=xr(L,1);if(typeof Symbol!="function"||(ne=fr[Symbol.for("__pairs")])===void 0)P=function(ur){if(this.index>=this.keys.length)return;let kr=this.keys[this.index++];return[kr,this.object[kr]]},Ce={object:fr,keys:Object.keys(fr),index:0};else{let ur=be(ne,fr,[]);ur===void 0&&z(L,S("bad '__pairs' result (object with keys 'iter', 'state', 'first' expected)")),(P=ur.iter)===void 0&&z(L,S("bad '__pairs' result (object.iter is missing)")),Ce=ur.state,_r=ur.first}return W(L,function(){let ur=n(L,1),kr=n(L,2),Br=be(P,ur,[kr]);if(Br===void 0)return 0;Array.isArray(Br)||z(L,S("bad iterator result (Array or undefined expected)")),he(L,Br.length,null);for(let hr=0;hr<Br.length;hr++)br(L,Br[hr]);return Br.length}),br(L,Ce),br(L,_r),3},__len:function(L){let ne,P,Ce=xr(L,1);return P=typeof Symbol!="function"||(ne=Ce[Symbol.for("__len")])===void 0?Ce.length:be(ne,Ce,[]),br(L,P),1}};e.exports.FENGARI_INTEROP_VERSION="0.1",e.exports.FENGARI_INTEROP_VERSION_NUM=1,e.exports.FENGARI_INTEROP_RELEASE="0.1.2",e.exports.checkjs=xr,e.exports.testjs=dr,e.exports.pushjs=Mr,e.exports.push=br,e.exports.tojs=n,e.exports.luaopen_js=function(L){return sr.set(Qe(L),new WeakMap),Pe(L,r),or(L,M),je(L,"0.1"),tr(L,-2,S("_VERSION")),Ue(L,1),tr(L,-2,S("_VERSION_NUM")),je(L,"0.1.2"),tr(L,-2,S("_RELEASE")),ir(L,Lr),mr(L,me,0),He(L,1),Mr(L,null),ie(L,-1),ze(L,C,null),tr(L,-2,S("null")),br(L,Oe),tr(L,-2,S("global")),1}},function(e,lr,h){const{luastring_of:T}=h(1),A=T(0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,22,22,22,22,22,22,22,22,22,22,4,4,4,4,4,4,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,5,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);e.exports.lisdigit=function(G){return(2&A[G+1])!=0},e.exports.lislalnum=function(G){return(3&A[G+1])!=0},e.exports.lislalpha=function(G){return(1&A[G+1])!=0},e.exports.lisprint=function(G){return(4&A[G+1])!=0},e.exports.lisspace=function(G){return(8&A[G+1])!=0},e.exports.lisxdigit=function(G){return(16&A[G+1])!=0}},function(e,lr,h){const{LUA_MULTRET:T,to_luastring:A}=h(1),{BinOpr:{OPR_ADD:G,OPR_AND:S,OPR_BAND:ue,OPR_BOR:we,OPR_BXOR:C,OPR_CONCAT:fe,OPR_DIV:K,OPR_EQ:Ie,OPR_GE:pe,OPR_GT:Le,OPR_IDIV:H,OPR_LE:oe,OPR_LT:$,OPR_MOD:Be,OPR_MUL:Me,OPR_NE:Ke,OPR_NOBINOPR:Pe,OPR_OR:Ye,OPR_POW:b,OPR_SHL:I,OPR_SHR:Y,OPR_SUB:X},UnOpr:{OPR_BNOT:ee,OPR_LEN:Ne,OPR_MINUS:Fe,OPR_NOT:He,OPR_NOUNOPR:y},NO_JUMP:W,getinstruction:Ue,luaK_checkstack:Z,luaK_codeABC:je,luaK_codeABx:d,luaK_codeAsBx:k,luaK_codek:m,luaK_concat:ie,luaK_dischargevars:_e,luaK_exp2RK:nr,luaK_exp2anyreg:ze,luaK_exp2anyregup:rr,luaK_exp2nextreg:tr,luaK_exp2val:R,luaK_fixline:N,luaK_getlabel:de,luaK_goiffalse:q,luaK_goiftrue:Re,luaK_indexed:ar,luaK_infix:Je,luaK_intK:ke,luaK_jump:w,luaK_jumpto:le,luaK_nil:p,luaK_patchclose:j,luaK_patchlist:he,luaK_patchtohere:g,luaK_posfix:z,luaK_prefix:se,luaK_reserveregs:or,luaK_ret:ir,luaK_self:cr,luaK_setlist:mr,luaK_setmultret:Sr,luaK_setoneret:Rr,luaK_setreturns:Cr,luaK_storevar:_,luaK_stringK:Oe}=h(35),be=h(8),ge=h(13),ae=h(20),{LUAI_MAXCCALLS:ce,MAX_INT:De,lua_assert:Lr}=h(4),dr=h(6),{OpCodesI:{OP_CALL:xr,OP_CLOSURE:Mr,OP_FORLOOP:Qe,OP_FORPREP:sr,OP_GETUPVAL:br,OP_MOVE:r,OP_NEWTABLE:n,OP_SETTABLE:l,OP_TAILCALL:a,OP_TFORCALL:u,OP_TFORLOOP:f,OP_VARARG:s},LFIELDS_PER_FLUSH:U,SETARG_B:xe,SETARG_C:Ge,SET_OPCODE:Ar}=h(16),{luaS_eqlngstr:Tr,luaS_new:M,luaS_newliteral:me}=h(10),L=h(9),ne=ge.Proto,P=ae.RESERVED,Ce=function(i){return i===ur.VCALL||i===ur.VVARARG},_r=function(i,E){return Tr(i,E)};class fr{constructor(){this.previous=null,this.firstlabel=NaN,this.firstgoto=NaN,this.nactvar=NaN,this.upval=NaN,this.isloop=NaN}}const ur={VVOID:0,VNIL:1,VTRUE:2,VFALSE:3,VK:4,VKFLT:5,VKINT:6,VNONRELOC:7,VLOCAL:8,VUPVAL:9,VINDEXED:10,VJMP:11,VRELOCABLE:12,VCALL:13,VVARARG:14};class kr{constructor(){this.k=NaN,this.u={ival:NaN,nval:NaN,info:NaN,ind:{idx:NaN,t:NaN,vt:NaN}},this.t=NaN,this.f=NaN}to(E){this.k=E.k,this.u=E.u,this.t=E.t,this.f=E.f}}class Br{constructor(){this.f=null,this.prev=null,this.ls=null,this.bl=null,this.pc=NaN,this.lasttarget=NaN,this.jpc=NaN,this.nk=NaN,this.np=NaN,this.firstlocal=NaN,this.nlocvars=NaN,this.nactvar=NaN,this.nups=NaN,this.freereg=NaN}}class hr{constructor(){this.arr=[],this.n=NaN,this.size=NaN}}const Er=function(i,E){i.t.token=0,ae.luaX_syntaxerror(i,E)},vr=function(i,E){ae.luaX_syntaxerror(i,dr.luaO_pushfstring(i.L,A("%s expected",!0),ae.luaX_token2str(i,E)))},wr=function(i,E,re,Te){E>re&&(function(te,J,Ve){let Ze=te.ls.L,Ur=te.f.linedefined,Pr=Ur===0?A("main function",!0):dr.luaO_pushfstring(Ze,A("function at line %d",!0),Ur),zr=dr.luaO_pushfstring(Ze,A("too many %s (limit is %d) in %s",!0),Ve,J,Pr);ae.luaX_syntaxerror(te.ls,zr)})(i,re,Te)},Ir=function(i,E){return i.t.token===E&&(ae.luaX_next(i),!0)},Hr=function(i,E){i.t.token!==E&&vr(i,E)},Vr=function(i,E){Hr(i,E),ae.luaX_next(i)},Xr=function(i,E,re){E||ae.luaX_syntaxerror(i,re)},Fr=function(i,E,re,Te){Ir(i,E)||(Te===i.linenumber?vr(i,E):ae.luaX_syntaxerror(i,dr.luaO_pushfstring(i.L,A("%s expected (to close %s at line %d)"),ae.luaX_token2str(i,E),ae.luaX_token2str(i,re),Te)))},c=function(i){Hr(i,P.TK_NAME);let E=i.t.seminfo.ts;return ae.luaX_next(i),E},D=function(i,E,re){i.f=i.t=W,i.k=E,i.u.info=re},Ee=function(i,E,re){D(E,ur.VK,Oe(i.fs,re))},ye=function(i,E){Ee(i,E,c(i))},We=function(i,E){let re=i.fs,Te=i.dyd,te=(function(J,Ve){let Ze=J.fs,Ur=Ze.f;return Ur.locvars[Ze.nlocvars]=new dr.LocVar,Ur.locvars[Ze.nlocvars].varname=Ve,Ze.nlocvars++})(i,E);wr(re,Te.actvar.n+1-re.firstlocal,200,A("local variables",!0)),Te.actvar.arr[Te.actvar.n]=new class{constructor(){this.idx=NaN}},Te.actvar.arr[Te.actvar.n].idx=te,Te.actvar.n++},ve=function(i,E){We(i,ae.luaX_newstring(i,A(E,!0)))},Se=function(i,E){let re=i.ls.dyd.actvar.arr[i.firstlocal+E].idx;return Lr(re<i.nlocvars),i.f.locvars[re]},Ae=function(i,E){let re=i.fs;for(re.nactvar=re.nactvar+E;E;E--)Se(re,re.nactvar-E).startpc=re.pc},Xe=function(i,E,re){let Te=i.f;return wr(i,i.nups+1,ge.MAXUPVAL,A("upvalues",!0)),Te.upvalues[i.nups]={instack:re.k===ur.VLOCAL,idx:re.u.info,name:E},i.nups++},er=function(i,E,re,Te){if(i===null)D(re,ur.VVOID,0);else{let te=(function(J,Ve){for(let Ze=J.nactvar-1;Ze>=0;Ze--)if(_r(Ve,Se(J,Ze).varname))return Ze;return-1})(i,E);if(te>=0)D(re,ur.VLOCAL,te),Te||(function(J,Ve){let Ze=J.bl;for(;Ze.nactvar>Ve;)Ze=Ze.previous;Ze.upval=1})(i,te);else{let J=(function(Ve,Ze){let Ur=Ve.f.upvalues;for(let Pr=0;Pr<Ve.nups;Pr++)if(_r(Ur[Pr].name,Ze))return Pr;return-1})(i,E);if(J<0){if(er(i.prev,E,re,0),re.k===ur.VVOID)return;J=Xe(i,E,re)}D(re,ur.VUPVAL,J)}}},t=function(i,E){let re=c(i),Te=i.fs;if(er(Te,re,E,1),E.k===ur.VVOID){let te=new kr;er(Te,i.envn,E,1),Lr(E.k!==ur.VVOID),Ee(i,te,re),ar(Te,E,te)}},v=function(i,E,re,Te){let te=i.fs,J=E-re;if(Ce(Te.k))++J<0&&(J=0),Cr(te,Te,J),J>1&&or(te,J-1);else if(Te.k!==ur.VVOID&&tr(te,Te),J>0){let Ve=te.freereg;or(te,J),p(te,Ve,J)}re>E&&(i.fs.freereg-=re-E)},O=function(i){let E=i.L;++E.nCcalls,wr(i.fs,E.nCcalls,ce,A("JS levels",!0))},F=function(i){return i.L.nCcalls--},V=function(i,E,re){let Te=i.fs,te=i.dyd.gt,J=te.arr[E];if(Lr(_r(J.name,re.name)),J.nactvar<re.nactvar){let Ve=Se(Te,J.nactvar).varname,Ze=dr.luaO_pushfstring(i.L,A("<goto %s> at line %d jumps into the scope of local '%s'"),J.name.getstr(),J.line,Ve.getstr());Er(i,Ze)}he(Te,J.pc,re.pc);for(let Ve=E;Ve<te.n-1;Ve++)te.arr[Ve]=te.arr[Ve+1];te.n--},B=function(i,E){let re=i.fs.bl,Te=i.dyd,te=Te.gt.arr[E];for(let J=re.firstlabel;J<Te.label.n;J++){let Ve=Te.label.arr[J];if(_r(Ve.name,te.name))return te.nactvar>Ve.nactvar&&(re.upval||Te.label.n>re.firstlabel)&&j(i.fs,te.pc,Ve.nactvar),V(i,E,Ve),!0}return!1},$e=function(i,E,re,Te,te){let J=E.n;return E.arr[J]=new class{constructor(){this.name=null,this.pc=NaN,this.line=NaN,this.nactvar=NaN}},E.arr[J].name=re,E.arr[J].line=Te,E.arr[J].nactvar=i.fs.nactvar,E.arr[J].pc=te,E.n=J+1,J},pr=function(i,E){let re=i.dyd.gt,Te=i.fs.bl.firstgoto;for(;Te<re.n;)_r(re.arr[Te].name,E.name)?V(i,Te,E):Te++},gr=function(i,E,re){E.isloop=re,E.nactvar=i.nactvar,E.firstlabel=i.ls.dyd.label.n,E.firstgoto=i.ls.dyd.gt.n,E.upval=0,E.previous=i.bl,i.bl=E,Lr(i.freereg===i.nactvar)},Nr=function(i,E,re){E.prev=i.fs,E.ls=i,i.fs=E,E.pc=0,E.lasttarget=0,E.jpc=W,E.freereg=0,E.nk=0,E.np=0,E.nups=0,E.nlocvars=0,E.nactvar=0,E.firstlocal=i.dyd.actvar.n,E.bl=null;let Te=E.f;Te.source=i.source,Te.maxstacksize=2,gr(E,re,!1)},o=function(i){let E=i.bl,re=i.ls;if(E.previous&&E.upval){let Te=w(i);j(i,Te,E.nactvar),g(i,Te)}E.isloop&&(function(Te){let te=me(Te.L,"break"),J=$e(Te,Te.dyd.label,te,0,Te.fs.pc);pr(Te,Te.dyd.label.arr[J])})(re),i.bl=E.previous,(function(Te,te){for(Te.ls.dyd.actvar.n-=Te.nactvar-te;Te.nactvar>te;)Se(Te,--Te.nactvar).endpc=Te.pc})(i,E.nactvar),Lr(E.nactvar===i.nactvar),i.freereg=i.nactvar,re.dyd.label.n=E.firstlabel,E.previous?(function(Te,te){let J=te.firstgoto,Ve=Te.ls.dyd.gt;for(;J<Ve.n;){let Ze=Ve.arr[J];Ze.nactvar>te.nactvar&&(te.upval&&j(Te,Ze.pc,te.nactvar),Ze.nactvar=te.nactvar),B(Te.ls,J)||J++}})(i,E):E.firstgoto<re.dyd.gt.n&&(function(Te,te){let J=ae.isreserved(te.name)?"<%s> at line %d not inside a loop":"no visible label '%s' for <goto> at line %d";J=dr.luaO_pushfstring(Te.L,A(J),te.name.getstr(),te.line),Er(Te,J)})(re,re.dyd.gt.arr[E.firstgoto])},x=function(i){let E=i.fs;ir(E,0,0),o(E),Lr(E.bl===null),i.fs=E.prev},Q=function(i,E){switch(i.t.token){case P.TK_ELSE:case P.TK_ELSEIF:case P.TK_END:case P.TK_EOS:return!0;case P.TK_UNTIL:return E;default:return!1}},qe=function(i){for(;!Q(i,1);){if(i.t.token===P.TK_RETURN)return void _n(i);_n(i)}},Or=function(i,E){let re=i.fs,Te=new kr;rr(re,E),ae.luaX_next(i),ye(i,Te),ar(re,E,Te)},yr=function(i,E){ae.luaX_next(i),Wr(i,E),R(i.fs,E),Vr(i,93)},jr=function(i,E){let re=i.fs,Te=i.fs.freereg,te=new kr,J=new kr;i.t.token===P.TK_NAME?(wr(re,E.nh,De,A("items in a constructor",!0)),ye(i,te)):yr(i,te),E.nh++,Vr(i,61);let Ve=nr(re,te);Wr(i,J),je(re,l,E.t.u.info,Ve,nr(re,J)),re.freereg=Te},Zr=function(i,E){E.v.k!==ur.VVOID&&(tr(i,E.v),E.v.k=ur.VVOID,E.tostore===U&&(mr(i,E.t.u.info,E.na,E.tostore),E.tostore=0))},Qr=function(i,E){Wr(i,E.v),wr(i.fs,E.na,De,A("items in a constructor",!0)),E.na++,E.tostore++},$r=function(i,E){switch(i.t.token){case P.TK_NAME:ae.luaX_lookahead(i)!==61?Qr(i,E):jr(i,E);break;case 91:jr(i,E);break;default:Qr(i,E)}},Jr=function(i,E){let re=i.fs,Te=i.linenumber,te=je(re,n,0,0,0),J=new class{constructor(){this.v=new kr,this.t=new kr,this.nh=NaN,this.na=NaN,this.tostore=NaN}};J.na=J.nh=J.tostore=0,J.t=E,D(E,ur.VRELOCABLE,te),D(J.v,ur.VVOID,0),tr(i.fs,E),Vr(i,123);do{if(Lr(J.v.k===ur.VVOID||J.tostore>0),i.t.token===125)break;Zr(re,J),$r(i,J)}while(Ir(i,44)||Ir(i,59));Fr(i,125,123,Te),(function(Ve,Ze){Ze.tostore!==0&&(Ce(Ze.v.k)?(Sr(Ve,Ze.v),mr(Ve,Ze.t.u.info,Ze.na,T),Ze.na--):(Ze.v.k!==ur.VVOID&&tr(Ve,Ze.v),mr(Ve,Ze.t.u.info,Ze.na,Ze.tostore)))})(re,J),xe(re.f.code[te],dr.luaO_int2fb(J.na)),Ge(re.f.code[te],dr.luaO_int2fb(J.nh))},Gr=function(i,E,re,Te){let te=new Br,J=new fr;te.f=(function(Ve){let Ze=Ve.L,Ur=new ne(Ze),Pr=Ve.fs;return Pr.f.p[Pr.np++]=Ur,Ur})(i),te.f.linedefined=Te,Nr(i,te,J),Vr(i,40),re&&(ve(i,"self"),Ae(i,1)),(function(Ve){let Ze=Ve.fs,Ur=Ze.f,Pr=0;if(Ur.is_vararg=!1,Ve.t.token!==41)do switch(Ve.t.token){case P.TK_NAME:We(Ve,c(Ve)),Pr++;break;case P.TK_DOTS:ae.luaX_next(Ve),Ur.is_vararg=!0;break;default:ae.luaX_syntaxerror(Ve,A("<name> or '...' expected",!0))}while(!Ur.is_vararg&&Ir(Ve,44));Ae(Ve,Pr),Ur.numparams=Ze.nactvar,or(Ze,Ze.nactvar)})(i),Vr(i,41),qe(i),te.f.lastlinedefined=i.linenumber,Fr(i,P.TK_END,P.TK_FUNCTION,Te),(function(Ve,Ze){let Ur=Ve.fs.prev;D(Ze,ur.VRELOCABLE,d(Ur,Mr,0,Ur.np-1)),tr(Ur,Ze)})(i,E),x(i)},qr=function(i,E){let re=1;for(Wr(i,E);Ir(i,44);)tr(i.fs,E),Wr(i,E),re++;return re},pn=function(i,E,re){let Te,te=i.fs,J=new kr;switch(i.t.token){case 40:ae.luaX_next(i),i.t.token===41?J.k=ur.VVOID:(qr(i,J),Sr(te,J)),Fr(i,41,40,re);break;case 123:Jr(i,J);break;case P.TK_STRING:Ee(i,J,i.t.seminfo.ts),ae.luaX_next(i);break;default:ae.luaX_syntaxerror(i,A("function arguments expected",!0))}Lr(E.k===ur.VNONRELOC);let Ve=E.u.info;Ce(J.k)?Te=T:(J.k!==ur.VVOID&&tr(te,J),Te=te.freereg-(Ve+1)),D(E,ur.VCALL,je(te,xr,Ve,Te+1,2)),N(te,re),te.freereg=Ve+1},sn=function(i,E){let re=i.fs,Te=i.linenumber;for(!(function(te,J){switch(te.t.token){case 40:{let Ve=te.linenumber;return ae.luaX_next(te),Wr(te,J),Fr(te,41,40,Ve),void _e(te.fs,J)}case P.TK_NAME:return void t(te,J);default:ae.luaX_syntaxerror(te,A("unexpected symbol",!0))}})(i,E);;)switch(i.t.token){case 46:Or(i,E);break;case 91:{let te=new kr;rr(re,E),yr(i,te),ar(re,E,te);break}case 58:{let te=new kr;ae.luaX_next(i),ye(i,te),cr(re,E,te),pn(i,E,Te);break}case 40:case P.TK_STRING:case 123:tr(re,E),pn(i,E,Te);break;default:return}},hn=[{left:10,right:10},{left:10,right:10},{left:11,right:11},{left:11,right:11},{left:14,right:13},{left:11,right:11},{left:11,right:11},{left:6,right:6},{left:4,right:4},{left:5,right:5},{left:7,right:7},{left:7,right:7},{left:9,right:8},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:2,right:2},{left:1,right:1}],on=function(i,E,re){O(i);let Te=(function(J){switch(J){case P.TK_NOT:return He;case 45:return Fe;case 126:return ee;case 35:return Ne;default:return y}})(i.t.token);if(Te!==y){let J=i.linenumber;ae.luaX_next(i),on(i,E,12),se(i.fs,Te,E,J)}else(function(J,Ve){switch(J.t.token){case P.TK_FLT:D(Ve,ur.VKFLT,0),Ve.u.nval=J.t.seminfo.r;break;case P.TK_INT:D(Ve,ur.VKINT,0),Ve.u.ival=J.t.seminfo.i;break;case P.TK_STRING:Ee(J,Ve,J.t.seminfo.ts);break;case P.TK_NIL:D(Ve,ur.VNIL,0);break;case P.TK_TRUE:D(Ve,ur.VTRUE,0);break;case P.TK_FALSE:D(Ve,ur.VFALSE,0);break;case P.TK_DOTS:{let Ze=J.fs;Xr(J,Ze.f.is_vararg,A("cannot use '...' outside a vararg function",!0)),D(Ve,ur.VVARARG,je(Ze,s,0,1,0));break}case 123:return void Jr(J,Ve);case P.TK_FUNCTION:return ae.luaX_next(J),void Gr(J,Ve,0,J.linenumber);default:return void sn(J,Ve)}ae.luaX_next(J)})(i,E);let te=(function(J){switch(J){case 43:return G;case 45:return X;case 42:return Me;case 37:return Be;case 94:return b;case 47:return K;case P.TK_IDIV:return H;case 38:return ue;case 124:return we;case 126:return C;case P.TK_SHL:return I;case P.TK_SHR:return Y;case P.TK_CONCAT:return fe;case P.TK_NE:return Ke;case P.TK_EQ:return Ie;case 60:return $;case P.TK_LE:return oe;case 62:return Le;case P.TK_GE:return pe;case P.TK_AND:return S;case P.TK_OR:return Ye;default:return Pe}})(i.t.token);for(;te!==Pe&&hn[te].left>re;){let J=new kr,Ve=i.linenumber;ae.luaX_next(i),Je(i.fs,te,E);let Ze=on(i,J,hn[te].right);z(i.fs,te,E,J,Ve),te=Ze}return F(i),te},Wr=function(i,E){on(i,E,0)},an=function(i){let E=i.fs,re=new fr;gr(E,re,0),qe(i),o(E)};class Ln{constructor(){this.prev=null,this.v=new kr}}const dn=function(i,E,re){let Te=new kr;if(Xr(i,(function(te){return ur.VLOCAL<=te&&te<=ur.VINDEXED})(E.v.k),A("syntax error",!0)),Ir(i,44)){let te=new Ln;te.prev=E,sn(i,te.v),te.v.k!==ur.VINDEXED&&(function(J,Ve,Ze){let Ur=J.fs,Pr=Ur.freereg,zr=!1;for(;Ve;Ve=Ve.prev)Ve.v.k===ur.VINDEXED&&(Ve.v.u.ind.vt===Ze.k&&Ve.v.u.ind.t===Ze.u.info&&(zr=!0,Ve.v.u.ind.vt=ur.VLOCAL,Ve.v.u.ind.t=Pr),Ze.k===ur.VLOCAL&&Ve.v.u.ind.idx===Ze.u.info&&(zr=!0,Ve.v.u.ind.idx=Pr));if(zr){let nn=Ze.k===ur.VLOCAL?r:br;je(Ur,nn,Pr,Ze.u.info,0),or(Ur,1)}})(i,E,te.v),wr(i.fs,re+i.L.nCcalls,ce,A("JS levels",!0)),dn(i,te,re+1)}else{Vr(i,61);let te=qr(i,Te);if(te===re)return Rr(i.fs,Te),void _(i.fs,E.v,Te);v(i,re,te,Te)}D(Te,ur.VNONRELOC,i.fs.freereg-1),_(i.fs,E.v,Te)},An=function(i){let E=new kr;return Wr(i,E),E.k===ur.VNIL&&(E.k=ur.VFALSE),Re(i.fs,E),E.f},gn=function(i,E){let re,Te=i.linenumber;Ir(i,P.TK_GOTO)?re=c(i):(ae.luaX_next(i),re=me(i.L,"break"));let te=$e(i,i.dyd.gt,re,Te,E);B(i,te)},En=function(i,E,re){let Te,te=i.fs,J=i.dyd.label;(function(Ve,Ze,Ur){for(let Pr=Ve.bl.firstlabel;Pr<Ze.n;Pr++)if(_r(Ur,Ze.arr[Pr].name)){let zr=dr.luaO_pushfstring(Ve.ls.L,A("label '%s' already defined on line %d",!0),Ur.getstr(),Ze.arr[Pr].line);Er(Ve.ls,zr)}})(te,J,E),Vr(i,P.TK_DBCOLON),Te=$e(i,J,E,re,de(te)),(function(Ve){for(;Ve.t.token===59||Ve.t.token===P.TK_DBCOLON;)_n(Ve)})(i),Q(i,0)&&(J.arr[Te].nactvar=te.bl.nactvar),pr(i,J.arr[Te])},cn=function(i){let E=new kr;return Wr(i,E),tr(i.fs,E),Lr(E.k===ur.VNONRELOC),E.u.info},Tn=function(i,E,re,Te,te){let J,Ve=new fr,Ze=i.fs;Ae(i,3),Vr(i,P.TK_DO);let Ur=te?k(Ze,sr,E,W):w(Ze);gr(Ze,Ve,0),Ae(i,Te),or(Ze,Te),an(i),o(Ze),g(Ze,Ur),te?J=k(Ze,Qe,E,W):(je(Ze,u,E,0,Te),N(Ze,re),J=k(Ze,f,E+2,W)),he(Ze,J,Ur+1),N(Ze,re)},mn=function(i,E){let re=i.fs,Te=new fr;gr(re,Te,1),ae.luaX_next(i);let te=c(i);switch(i.t.token){case 61:(function(J,Ve,Ze){let Ur=J.fs,Pr=Ur.freereg;ve(J,"(for index)"),ve(J,"(for limit)"),ve(J,"(for step)"),We(J,Ve),Vr(J,61),cn(J),Vr(J,44),cn(J),Ir(J,44)?cn(J):(m(Ur,Ur.freereg,ke(Ur,1)),or(Ur,1)),Tn(J,Pr,Ze,1,1)})(i,te,E);break;case 44:case P.TK_IN:(function(J,Ve){let Ze=J.fs,Ur=new kr,Pr=4,zr=Ze.freereg;for(ve(J,"(for generator)"),ve(J,"(for state)"),ve(J,"(for control)"),We(J,Ve);Ir(J,44);)We(J,c(J)),Pr++;Vr(J,P.TK_IN);let nn=J.linenumber;v(J,3,qr(J,Ur),Ur),Z(Ze,3),Tn(J,zr,nn,Pr-3,0)})(i,te);break;default:ae.luaX_syntaxerror(i,A("'=' or 'in' expected",!0))}Fr(i,P.TK_END,P.TK_FOR,E),o(re)},xn=function(i,E){let re,Te=new fr,te=i.fs,J=new kr;if(ae.luaX_next(i),Wr(i,J),Vr(i,P.TK_THEN),i.t.token===P.TK_GOTO||i.t.token===P.TK_BREAK){for(q(i.fs,J),gr(te,Te,!1),gn(i,J.t);Ir(i,59););if(Q(i,0))return o(te),E;re=w(te)}else Re(i.fs,J),gr(te,Te,!1),re=J.f;return qe(i),o(te),i.t.token!==P.TK_ELSE&&i.t.token!==P.TK_ELSEIF||(E=ie(te,E,w(te))),g(te,re),E},Un=function(i,E){let re=new kr,Te=new kr;ae.luaX_next(i);let te=(function(J,Ve){let Ze=0;for(t(J,Ve);J.t.token===46;)Or(J,Ve);return J.t.token===58&&(Ze=1,Or(J,Ve)),Ze})(i,re);Gr(i,Te,te,E),_(i.fs,re,Te),N(i.fs,E)},_n=function(i){let E=i.linenumber;switch(O(i),i.t.token){case 59:ae.luaX_next(i);break;case P.TK_IF:(function(re,Te){let te=re.fs,J=W;for(J=xn(re,J);re.t.token===P.TK_ELSEIF;)J=xn(re,J);Ir(re,P.TK_ELSE)&&an(re),Fr(re,P.TK_END,P.TK_IF,Te),g(te,J)})(i,E);break;case P.TK_WHILE:(function(re,Te){let te=re.fs,J=new fr;ae.luaX_next(re);let Ve=de(te),Ze=An(re);gr(te,J,1),Vr(re,P.TK_DO),an(re),le(te,Ve),Fr(re,P.TK_END,P.TK_WHILE,Te),o(te),g(te,Ze)})(i,E);break;case P.TK_DO:ae.luaX_next(i),an(i),Fr(i,P.TK_END,P.TK_DO,E);break;case P.TK_FOR:mn(i,E);break;case P.TK_REPEAT:(function(re,Te){let te=re.fs,J=de(te),Ve=new fr,Ze=new fr;gr(te,Ve,1),gr(te,Ze,0),ae.luaX_next(re),qe(re),Fr(re,P.TK_UNTIL,P.TK_REPEAT,Te);let Ur=An(re);Ze.upval&&j(te,Ur,Ze.nactvar),o(te),he(te,Ur,J),o(te)})(i,E);break;case P.TK_FUNCTION:Un(i,E);break;case P.TK_LOCAL:ae.luaX_next(i),Ir(i,P.TK_FUNCTION)?(function(re){let Te=new kr,te=re.fs;We(re,c(re)),Ae(re,1),Gr(re,Te,0,re.linenumber),Se(te,Te.u.info).startpc=te.pc})(i):(function(re){let Te,te=0,J=new kr;do We(re,c(re)),te++;while(Ir(re,44));Ir(re,61)?Te=qr(re,J):(J.k=ur.VVOID,Te=0),v(re,te,Te,J),Ae(re,te)})(i);break;case P.TK_DBCOLON:ae.luaX_next(i),En(i,c(i),E);break;case P.TK_RETURN:ae.luaX_next(i),(function(re){let Te,te,J=re.fs,Ve=new kr;Q(re,1)||re.t.token===59?Te=te=0:(te=qr(re,Ve),Ce(Ve.k)?(Sr(J,Ve),Ve.k===ur.VCALL&&te===1&&(Ar(Ue(J,Ve),a),Lr(Ue(J,Ve).A===J.nactvar)),Te=J.nactvar,te=T):te===1?Te=ze(J,Ve):(tr(J,Ve),Te=J.nactvar,Lr(te===J.freereg-Te))),ir(J,Te,te),Ir(re,59)})(i);break;case P.TK_BREAK:case P.TK_GOTO:gn(i,w(i.fs));break;default:(function(re){let Te=re.fs,te=new Ln;sn(re,te.v),re.t.token===61||re.t.token===44?(te.prev=null,dn(re,te,1)):(Xr(re,te.v.k===ur.VCALL,A("syntax error",!0)),Ge(Ue(Te,te.v),1))})(i)}Lr(i.fs.f.maxstacksize>=i.fs.freereg&&i.fs.freereg>=i.fs.nactvar),i.fs.freereg=i.fs.nactvar,F(i)};e.exports.Dyndata=class{constructor(){this.actvar={arr:[],n:NaN,size:NaN},this.gt=new hr,this.label=new hr}},e.exports.expkind=ur,e.exports.expdesc=kr,e.exports.luaY_parser=function(i,E,re,Te,te,J){let Ve=new ae.LexState,Ze=new Br,Ur=ge.luaF_newLclosure(i,1);return be.luaD_inctop(i),i.stack[i.top-1].setclLvalue(Ur),Ve.h=L.luaH_new(i),be.luaD_inctop(i),i.stack[i.top-1].sethvalue(Ve.h),Ze.f=Ur.p=new ne(i),Ze.f.source=M(i,te),Ve.buff=re,Ve.dyd=Te,Te.actvar.n=Te.gt.n=Te.label.n=0,ae.luaX_setinput(i,Ve,E,Ze.f.source,J),(function(Pr,zr){let nn=new fr,bn=new kr;Nr(Pr,zr,nn),zr.f.is_vararg=!0,D(bn,ur.VLOCAL,0),Xe(zr,Pr.envn,bn),ae.luaX_next(Pr),qe(Pr),Hr(Pr,P.TK_EOS),x(Pr)})(Ve,Ze),Lr(!Ze.prev&&Ze.nups===1&&!Ve.fs),Lr(Te.actvar.n===0&&Te.gt.n===0&&Te.label.n===0),delete i.stack[--i.top],Ur},e.exports.vkisinreg=function(i){return i===ur.VNONRELOC||i===ur.VLOCAL}},function(e,lr,h){const{LUA_MULTRET:T,LUA_OK:A,LUA_TFUNCTION:G,LUA_TNIL:S,LUA_TNONE:ue,LUA_TNUMBER:we,LUA_TSTRING:C,LUA_TTABLE:fe,LUA_VERSION:K,LUA_YIELD:Ie,lua_call:pe,lua_callk:Le,lua_concat:H,lua_error:oe,lua_getglobal:$,lua_geti:Be,lua_getmetatable:Me,lua_gettop:Ke,lua_insert:Pe,lua_isnil:Ye,lua_isnone:b,lua_isstring:I,lua_load:Y,lua_next:X,lua_pcallk:ee,lua_pop:Ne,lua_pushboolean:Fe,lua_pushcfunction:He,lua_pushglobaltable:y,lua_pushinteger:W,lua_pushliteral:Ue,lua_pushnil:Z,lua_pushstring:je,lua_pushvalue:d,lua_rawequal:k,lua_rawget:m,lua_rawlen:ie,lua_rawset:_e,lua_remove:nr,lua_replace:ze,lua_rotate:rr,lua_setfield:tr,lua_setmetatable:R,lua_settop:N,lua_setupvalue:de,lua_stringtonumber:q,lua_toboolean:Re,lua_tolstring:ar,lua_tostring:Je,lua_type:ke,lua_typename:w}=h(2),{luaL_argcheck:le,luaL_checkany:p,luaL_checkinteger:j,luaL_checkoption:he,luaL_checkstack:g,luaL_checktype:z,luaL_error:se,luaL_getmetafield:or,luaL_loadbufferx:ir,luaL_loadfile:cr,luaL_loadfilex:mr,luaL_optinteger:Sr,luaL_optstring:Rr,luaL_setfuncs:Cr,luaL_tolstring:_,luaL_where:Oe}=h(7),{to_jsstring:be,to_luastring:ge}=h(5);let ae,ce;if(typeof TextDecoder=="function"){let n="",l=new TextDecoder("utf-8");ae=function(u){n+=l.decode(u,{stream:!0})};let a=new Uint8Array(0);ce=function(){n+=l.decode(a),console.log(n),n=""}}else{let n=[];ae=function(l){try{l=be(l)}catch{let u=new Uint8Array(l.length);u.set(l),l=u}n.push(l)},ce=function(){console.log.apply(console.log,n),n=[]}}const De=["stop","restart","collect","count","step","setpause","setstepmul","isrunning"].map(n=>ge(n)),Lr=function(n){return z(n,1,fe),N(n,2),X(n,1)?2:(Z(n),1)},dr=function(n){let l=j(n,2)+1;return W(n,l),Be(n,1,l)===S?1:2},xr=function(n){let l=Sr(n,2,1);return N(n,1),ke(n,1)===C&&l>0&&(Oe(n,l),d(n,1),H(n,2)),oe(n)},Mr=function(n,l,a){return l!==A&&l!==Ie?(Fe(n,0),d(n,-2),2):Ke(n)-a},Qe=function(n,l,a){return l===A?(a!==0&&(d(n,a),de(n,-2,1)||Ne(n,1)),1):(Z(n),Pe(n,-2),2)},sr=function(n,l){return g(n,2,"too many nested functions"),d(n,1),pe(n,0,1),Ye(n,-1)?(Ne(n,1),null):(I(n,-1)||se(n,ge("reader function must return a string")),ze(n,5),Je(n,5))},br=function(n,l,a){return Ke(n)-1},r={assert:function(n){return Re(n,1)?Ke(n):(p(n,1),nr(n,1),Ue(n,"assertion failed!"),N(n,1),xr(n))},collectgarbage:function(n){he(n,1,"collect",De),Sr(n,2,0),se(n,ge("lua_gc not implemented"))},dofile:function(n){let l=Rr(n,1,null);return N(n,1),cr(n,l)!==A?oe(n):(Le(n,0,T,0,br),br(n))},error:xr,getmetatable:function(n){return p(n,1),Me(n,1)?(or(n,1,ge("__metatable",!0)),1):(Z(n),1)},ipairs:function(n){return p(n,1),He(n,dr),d(n,1),W(n,0),3},load:function(n){let l,a=Je(n,1),u=Rr(n,3,"bt"),f=b(n,4)?0:4;if(a!==null){let s=Rr(n,2,a);l=ir(n,a,a.length,s,u)}else{let s=Rr(n,2,"=(load)");z(n,1,G),N(n,5),l=Y(n,sr,null,s,u)}return Qe(n,l,f)},loadfile:function(n){let l=Rr(n,1,null),a=Rr(n,2,null),u=b(n,3)?0:3,f=mr(n,l,a);return Qe(n,f,u)},next:Lr,pairs:function(n){return(function(l,a,u,f){return p(l,1),or(l,1,a)===S?(He(l,f),d(l,1),Z(l)):(d(l,1),pe(l,1,3)),3})(n,ge("__pairs",!0),0,Lr)},pcall:function(n){p(n,1),Fe(n,1),Pe(n,1);let l=ee(n,Ke(n)-2,T,0,0,Mr);return Mr(n,l,0)},print:function(n){let l=Ke(n);$(n,ge("tostring",!0));for(let a=1;a<=l;a++){d(n,-1),d(n,a),pe(n,1,1);let u=ar(n,-1);if(u===null)return se(n,ge("'tostring' must return a string to 'print'"));a>1&&ae(ge("	")),ae(u),Ne(n,1)}return ce(),0},rawequal:function(n){return p(n,1),p(n,2),Fe(n,k(n,1,2)),1},rawget:function(n){return z(n,1,fe),p(n,2),N(n,2),m(n,1),1},rawlen:function(n){let l=ke(n,1);return le(n,l===fe||l===C,1,"table or string expected"),W(n,ie(n,1)),1},rawset:function(n){return z(n,1,fe),p(n,2),p(n,3),N(n,3),_e(n,1),1},select:function(n){let l=Ke(n);if(ke(n,1)===C&&Je(n,1)[0]===35)return W(n,l-1),1;{let a=j(n,1);return a<0?a=l+a:a>l&&(a=l),le(n,1<=a,1,"index out of range"),l-a}},setmetatable:function(n){let l=ke(n,2);return z(n,1,fe),le(n,l===S||l===fe,2,"nil or table expected"),or(n,1,ge("__metatable",!0))!==S?se(n,ge("cannot change a protected metatable")):(N(n,2),R(n,1),1)},tonumber:function(n){if(ke(n,2)<=0){if(p(n,1),ke(n,1)===we)return N(n,1),1;{let l=Je(n,1);if(l!==null&&q(n,l)===l.length+1)return 1}}else{let l=j(n,2);z(n,1,C);let a=Je(n,1);le(n,2<=l&&l<=36,2,"base out of range");let u=(function(f,s){try{f=be(f)}catch{return null}let U=/^[\t\v\f \n\r]*([+-]?)0*([0-9A-Za-z]+)[\t\v\f \n\r]*$/.exec(f);if(!U)return null;let xe=parseInt(U[1]+U[2],s);return isNaN(xe)?null:0|xe})(a,l);if(u!==null)return W(n,u),1}return Z(n),1},tostring:function(n){return p(n,1),_(n,1),1},type:function(n){let l=ke(n,1);return le(n,l!==ue,1,"value expected"),je(n,w(n,l)),1},xpcall:function(n){let l=Ke(n);z(n,2,G),Fe(n,1),d(n,1),rr(n,3,2);let a=ee(n,l-2,T,2,2,Mr);return Mr(n,a,2)}};e.exports.luaopen_base=function(n){return y(n),Cr(n,r,0),d(n,-1),tr(n,-2,ge("_G")),Ue(n,K),tr(n,-2,ge("_VERSION")),1}},function(e,lr,h){const{LUA_OK:T,LUA_TFUNCTION:A,LUA_TSTRING:G,LUA_YIELD:S,lua_Debug:ue,lua_checkstack:we,lua_concat:C,lua_error:fe,lua_getstack:K,lua_gettop:Ie,lua_insert:pe,lua_isyieldable:Le,lua_newthread:H,lua_pop:oe,lua_pushboolean:$,lua_pushcclosure:Be,lua_pushliteral:Me,lua_pushthread:Ke,lua_pushvalue:Pe,lua_resume:Ye,lua_status:b,lua_tothread:I,lua_type:Y,lua_upvalueindex:X,lua_xmove:ee,lua_yield:Ne}=h(2),{luaL_argcheck:Fe,luaL_checktype:He,luaL_newlib:y,luaL_where:W}=h(7),Ue=function(m){let ie=I(m,1);return Fe(m,ie,1,"thread expected"),ie},Z=function(m,ie,_e){if(!we(ie,_e))return Me(m,"too many arguments to resume"),-1;if(b(ie)===T&&Ie(ie)===0)return Me(m,"cannot resume dead coroutine"),-1;ee(m,ie,_e);let nr=Ye(ie,m,_e);if(nr===T||nr===S){let ze=Ie(ie);return we(m,ze+1)?(ee(ie,m,ze),ze):(oe(ie,ze),Me(m,"too many results to resume"),-1)}return ee(ie,m,1),-1},je=function(m){let ie=I(m,X(1)),_e=Z(m,ie,Ie(m));return _e<0?(Y(m,-1)===G&&(W(m,1),pe(m,-2),C(m,2)),fe(m)):_e},d=function(m){He(m,1,A);let ie=H(m);return Pe(m,1),ee(m,ie,1),1},k={create:d,isyieldable:function(m){return $(m,Le(m)),1},resume:function(m){let ie=Ue(m),_e=Z(m,ie,Ie(m)-1);return _e<0?($(m,0),pe(m,-2),2):($(m,1),pe(m,-(_e+1)),_e+1)},running:function(m){return $(m,Ke(m)),2},status:function(m){let ie=Ue(m);if(m===ie)Me(m,"running");else switch(b(ie)){case S:Me(m,"suspended");break;case T:{let _e=new ue;K(ie,0,_e)>0?Me(m,"normal"):Ie(ie)===0?Me(m,"dead"):Me(m,"suspended");break}default:Me(m,"dead")}return 1},wrap:function(m){return d(m),Be(m,je,1),1},yield:function(m){return Ne(m,Ie(m))}};e.exports.luaopen_coroutine=function(m){return y(m,k),1}},function(e,lr,h){const{LUA_MAXINTEGER:T}=h(3),{LUA_OPEQ:A,LUA_OPLT:G,LUA_TFUNCTION:S,LUA_TNIL:ue,LUA_TTABLE:we,lua_call:C,lua_checkstack:fe,lua_compare:K,lua_createtable:Ie,lua_geti:pe,lua_getmetatable:Le,lua_gettop:H,lua_insert:oe,lua_isnil:$,lua_isnoneornil:Be,lua_isstring:Me,lua_pop:Ke,lua_pushinteger:Pe,lua_pushnil:Ye,lua_pushstring:b,lua_pushvalue:I,lua_rawget:Y,lua_setfield:X,lua_seti:ee,lua_settop:Ne,lua_toboolean:Fe,lua_type:He}=h(2),{luaL_Buffer:y,luaL_addlstring:W,luaL_addvalue:Ue,luaL_argcheck:Z,luaL_buffinit:je,luaL_checkinteger:d,luaL_checktype:k,luaL_error:m,luaL_len:ie,luaL_newlib:_e,luaL_opt:nr,luaL_optinteger:ze,luaL_optlstring:rr,luaL_pushresult:tr,luaL_typename:R}=h(7),N=h(17),{to_luastring:de}=h(5),q=function(g,z,se){return b(g,z),Y(g,-se)!==ue},Re=function(g,z,se){if(He(g,z)!==we){let or=1;!Le(g,z)||1&se&&!q(g,de("__index",!0),++or)||2&se&&!q(g,de("__newindex",!0),++or)||4&se&&!q(g,de("__len",!0),++or)?k(g,z,we):Ke(g,or)}},ar=function(g,z,se){return Re(g,z,4|se),ie(g,z)},Je=function(g,z,se){pe(g,1,se),Me(g,-1)||m(g,de("invalid value (%s) at index %d in table for 'concat'"),R(g,-1),se),Ue(z)},ke=function(g,z,se){ee(g,1,z),ee(g,1,se)},w=function(g,z,se){if($(g,2))return K(g,z,se,G);{I(g,2),I(g,z-1),I(g,se-2),C(g,2,1);let or=Fe(g,-1);return Ke(g,1),or}},le=function(g,z,se){let or=z,ir=se-1;for(;;){for(;pe(g,1,++or),w(g,-1,-2);)or==se-1&&m(g,de("invalid order function for sorting")),Ke(g,1);for(;pe(g,1,--ir),w(g,-3,-1);)ir<or&&m(g,de("invalid order function for sorting")),Ke(g,1);if(ir<or)return Ke(g,1),ke(g,se-1,or),or;ke(g,or,ir)}},p=function(g,z,se){let or=Math.floor((z-g)/4),ir=se%(2*or)+(g+or);return N.lua_assert(g+or<=ir&&ir<=z-or),ir},j=function(g,z,se,or){for(;z<se;){if(pe(g,1,z),pe(g,1,se),w(g,-1,-2)?ke(g,z,se):Ke(g,2),se-z==1)return;let ir,cr;if(ir=se-z<100||or===0?Math.floor((z+se)/2):p(z,se,or),pe(g,1,ir),pe(g,1,z),w(g,-2,-1)?ke(g,ir,z):(Ke(g,1),pe(g,1,se),w(g,-1,-2)?ke(g,ir,se):Ke(g,2)),se-z==2)return;pe(g,1,ir),I(g,-1),pe(g,1,se-1),ke(g,ir,se-1),(ir=le(g,z,se))-z<se-ir?(j(g,z,ir-1,or),cr=ir-z,z=ir+1):(j(g,ir+1,se,or),cr=se-ir,se=ir-1),(se-z)/128>cr&&(or=Math.floor(4294967296*Math.random()))}},he={concat:function(g){let z=ar(g,1,1),se=rr(g,2,""),or=se.length,ir=ze(g,3,1);z=ze(g,4,z);let cr=new y;for(je(g,cr);ir<z;ir++)Je(g,cr,ir),W(cr,se,or);return ir===z&&Je(g,cr,ir),tr(cr),1},insert:function(g){let z,se=ar(g,1,3)+1;switch(H(g)){case 2:z=se;break;case 3:z=d(g,2),Z(g,1<=z&&z<=se,2,"position out of bounds");for(let or=se;or>z;or--)pe(g,1,or-1),ee(g,1,or);break;default:return m(g,"wrong number of arguments to 'insert'")}return ee(g,1,z),0},move:function(g){let z=d(g,2),se=d(g,3),or=d(g,4),ir=Be(g,5)?1:5;if(Re(g,1,1),Re(g,ir,2),se>=z){Z(g,z>0||se<T+z,3,"too many elements to move");let cr=se-z+1;if(Z(g,or<=T-cr+1,4,"destination wrap around"),or>se||or<=z||ir!==1&&K(g,1,ir,A)!==1)for(let mr=0;mr<cr;mr++)pe(g,1,z+mr),ee(g,ir,or+mr);else for(let mr=cr-1;mr>=0;mr--)pe(g,1,z+mr),ee(g,ir,or+mr)}return I(g,ir),1},pack:function(g){let z=H(g);Ie(g,z,1),oe(g,1);for(let se=z;se>=1;se--)ee(g,1,se);return Pe(g,z),X(g,1,de("n")),1},remove:function(g){let z=ar(g,1,3),se=ze(g,2,z);for(se!==z&&Z(g,1<=se&&se<=z+1,1,"position out of bounds"),pe(g,1,se);se<z;se++)pe(g,1,se+1),ee(g,1,se);return Ye(g),ee(g,1,se),1},sort:function(g){let z=ar(g,1,3);return z>1&&(Z(g,z<T,1,"array too big"),Be(g,2)||k(g,2,S),Ne(g,2),j(g,1,z,0)),0},unpack:function(g){let z=ze(g,2,1),se=nr(g,d,3,ie(g,1));if(z>se)return 0;let or=se-z;if(or>=Number.MAX_SAFE_INTEGER||!fe(g,++or))return m(g,de("too many results to unpack"));for(;z<se;z++)pe(g,1,z);return pe(g,1,se),or}};e.exports.luaopen_table=function(g){return _e(g,he),1}},function(e,lr,h){const{LUA_TNIL:T,LUA_TTABLE:A,lua_close:G,lua_createtable:S,lua_getfield:ue,lua_isboolean:we,lua_isnoneornil:C,lua_pop:fe,lua_pushboolean:K,lua_pushfstring:Ie,lua_pushinteger:pe,lua_pushliteral:Le,lua_pushnil:H,lua_pushnumber:oe,lua_pushstring:$,lua_setfield:Be,lua_settop:Me,lua_toboolean:Ke,lua_tointegerx:Pe}=h(2),{luaL_Buffer:Ye,luaL_addchar:b,luaL_addstring:I,luaL_argerror:Y,luaL_buffinit:X,luaL_checkinteger:ee,luaL_checkstring:Ne,luaL_checktype:Fe,luaL_error:He,luaL_execresult:y,luaL_fileresult:W,luaL_newlib:Ue,luaL_optinteger:Z,luaL_optlstring:je,luaL_optstring:d,luaL_pushresult:k}=h(7),{luastring_eq:m,to_jsstring:ie,to_luastring:_e}=h(5),nr=_e("aAbBcCdDeFhHIjklmMnpPrRStTuUwWxXyYzZ%"),ze=function(w,le,p){pe(w,p),Be(w,-2,_e(le,!0))},rr=function(w,le,p){ze(w,"sec",p?le.getUTCSeconds():le.getSeconds()),ze(w,"min",p?le.getUTCMinutes():le.getMinutes()),ze(w,"hour",p?le.getUTCHours():le.getHours()),ze(w,"day",p?le.getUTCDate():le.getDate()),ze(w,"month",(p?le.getUTCMonth():le.getMonth())+1),ze(w,"year",p?le.getUTCFullYear():le.getFullYear()),ze(w,"wday",(p?le.getUTCDay():le.getDay())+1),ze(w,"yday",Math.floor((le-new Date(le.getFullYear(),0,0))/864e5))},tr=Number.MAX_SAFE_INTEGER/2,R=function(w,le,p,j){let he=ue(w,-1,_e(le,!0)),g=Pe(w,-1);if(g===!1){if(he!==T)return He(w,_e("field '%s' is not an integer"),le);if(p<0)return He(w,_e("field '%s' missing in date table"),le);g=p}else{if(!(-tr<=g&&g<=tr))return He(w,_e("field '%s' is out-of-bound"),le);g-=j}return fe(w,1),g},N={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(w=>_e(w)),shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(w=>_e(w)),months:["January","February","March","April","May","June","July","August","September","October","November","December"].map(w=>_e(w)),shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(w=>_e(w)),AM:_e("AM"),PM:_e("PM"),am:_e("am"),pm:_e("pm"),formats:{c:_e("%a %b %e %H:%M:%S %Y"),D:_e("%m/%d/%y"),F:_e("%Y-%m-%d"),R:_e("%H:%M"),r:_e("%I:%M:%S %p"),T:_e("%H:%M:%S"),X:_e("%T"),x:_e("%D")}},de=function(w,le){let p=w.getDay();le==="monday"&&(p===0?p=6:p--);let j=(w-new Date(w.getFullYear(),0,1))/864e5;return Math.floor((j+7-p)/7)},q=function(w,le,p){le<10&&b(w,p),I(w,_e(String(le)))},Re=function(w,le,p,j){let he=0;for(;he<p.length;)if(p[he]!==37)b(le,p[he++]);else{let g=ar(w,p,++he);switch(p[he]){case 37:b(le,37);break;case 65:I(le,N.days[j.getDay()]);break;case 66:I(le,N.months[j.getMonth()]);break;case 67:q(le,Math.floor(j.getFullYear()/100),48);break;case 68:Re(w,le,N.formats.D,j);break;case 70:Re(w,le,N.formats.F,j);break;case 72:q(le,j.getHours(),48);break;case 73:q(le,(j.getHours()+11)%12+1,48);break;case 77:q(le,j.getMinutes(),48);break;case 80:I(le,j.getHours()<12?N.am:N.pm);break;case 82:Re(w,le,N.formats.R,j);break;case 83:q(le,j.getSeconds(),48);break;case 84:Re(w,le,N.formats.T,j);break;case 85:q(le,de(j,"sunday"),48);break;case 87:q(le,de(j,"monday"),48);break;case 88:Re(w,le,N.formats.X,j);break;case 89:I(le,_e(String(j.getFullYear())));break;case 90:{let z=j.toString().match(/\(([\w\s]+)\)/);z&&I(le,_e(z[1]));break}case 97:I(le,N.shortDays[j.getDay()]);break;case 98:case 104:I(le,N.shortMonths[j.getMonth()]);break;case 99:Re(w,le,N.formats.c,j);break;case 100:q(le,j.getDate(),48);break;case 101:q(le,j.getDate(),32);break;case 106:{let z=Math.floor((j-new Date(j.getFullYear(),0,1))/864e5);z<100&&(z<10&&b(le,48),b(le,48)),I(le,_e(String(z)));break}case 107:q(le,j.getHours(),32);break;case 108:q(le,(j.getHours()+11)%12+1,32);break;case 109:q(le,j.getMonth()+1,48);break;case 110:b(le,10);break;case 112:I(le,j.getHours()<12?N.AM:N.PM);break;case 114:Re(w,le,N.formats.r,j);break;case 115:I(le,_e(String(Math.floor(j/1e3))));break;case 116:b(le,8);break;case 117:{let z=j.getDay();I(le,_e(String(z===0?7:z)));break}case 119:I(le,_e(String(j.getDay())));break;case 120:Re(w,le,N.formats.x,j);break;case 121:q(le,j.getFullYear()%100,48);break;case 122:{let z=j.getTimezoneOffset();z>0?b(le,45):(z=-z,b(le,43)),q(le,Math.floor(z/60),48),q(le,z%60,48);break}}he+=g}},ar=function(w,le,p){let j=nr,he=0,g=1;for(;he<j.length&&g<=le.length-p;he+=g)if(j[he]===124)g++;else if(m(le.subarray(p,p+g),j.subarray(he,he+g)))return g;Y(w,1,Ie(w,_e("invalid conversion specifier '%%%s'"),le))},Je=function(w,le){return ee(w,le)},ke={date:function(w){let le=je(w,1,"%c"),p=C(w,2)?new Date:new Date(1e3*Je(w,2)),j=!1,he=0;if(le[he]===33&&(j=!0,he++),le[he]===42&&le[he+1]===116)S(w,0,9),rr(w,p,j);else{new Uint8Array(4)[0]=37;let g=new Ye;X(w,g),Re(w,g,le,p),k(g)}return 1},difftime:function(w){let le=Je(w,1),p=Je(w,2);return oe(w,le-p),1},time:function(w){let le;return C(w,1)?le=new Date:(Fe(w,1,A),Me(w,1),le=new Date(R(w,"year",-1,0),R(w,"month",-1,1),R(w,"day",-1,0),R(w,"hour",12,0),R(w,"min",0,0),R(w,"sec",0,0)),rr(w,le)),pe(w,Math.floor(le/1e3)),1},clock:function(w){return oe(w,performance.now()/1e3),1}};e.exports.luaopen_os=function(w){return Ue(w,ke),1}},function(e,lr,h){const{sprintf:T}=h(38),{LUA_INTEGER_FMT:A,LUA_INTEGER_FRMLEN:G,LUA_MININTEGER:S,LUA_NUMBER_FMT:ue,LUA_NUMBER_FRMLEN:we,frexp:C,lua_getlocaledecpoint:fe}=h(3),{LUA_TBOOLEAN:K,LUA_TFUNCTION:Ie,LUA_TNIL:pe,LUA_TNUMBER:Le,LUA_TSTRING:H,LUA_TTABLE:oe,lua_call:$,lua_createtable:Be,lua_dump:Me,lua_gettable:Ke,lua_gettop:Pe,lua_isinteger:Ye,lua_isstring:b,lua_pop:I,lua_pushcclosure:Y,lua_pushinteger:X,lua_pushlightuserdata:ee,lua_pushliteral:Ne,lua_pushlstring:Fe,lua_pushnil:He,lua_pushnumber:y,lua_pushstring:W,lua_pushvalue:Ue,lua_remove:Z,lua_setfield:je,lua_setmetatable:d,lua_settop:k,lua_toboolean:m,lua_tointeger:ie,lua_tonumber:_e,lua_tostring:nr,lua_touserdata:ze,lua_type:rr,lua_upvalueindex:tr}=h(2),{luaL_Buffer:R,luaL_addchar:N,luaL_addlstring:de,luaL_addsize:q,luaL_addstring:Re,luaL_addvalue:ar,luaL_argcheck:Je,luaL_argerror:ke,luaL_buffinit:w,luaL_buffinitsize:le,luaL_checkinteger:p,luaL_checknumber:j,luaL_checkstack:he,luaL_checkstring:g,luaL_checktype:z,luaL_error:se,luaL_newlib:or,luaL_optinteger:ir,luaL_optstring:cr,luaL_prepbuffsize:mr,luaL_pushresult:Sr,luaL_pushresultsize:Rr,luaL_tolstring:Cr,luaL_typename:_}=h(7),Oe=h(17),{luastring_eq:be,luastring_indexOf:ge,to_jsstring:ae,to_luastring:ce}=h(5),De=37,Lr=function(t){let v=ge(t,0);return v>-1?v:t.length},dr=function(t,v){return t>=0?t:0-t>v?0:v+t+1},xr=function(t,v,O,F){return de(F,v,O),0},Mr=we.length+1,Qe=function(t,v,O){let F=(function(V){if(Object.is(V,1/0))return ce("inf");if(Object.is(V,-1/0))return ce("-inf");if(Number.isNaN(V))return ce("nan");if(V===0){let B=T(ue+"x0p+0",V);return Object.is(V,-0)&&(B="-"+B),ce(B)}{let B="",$e=C(V),pr=$e[0],gr=$e[1];return pr<0&&(B+="-",pr=-pr),B+="0x",B+=(2*pr).toString(16),B+=T("p%+d",gr-=1),ce(B)}})(O);if(v[Mr]===65)for(let V=0;V<F.length;V++){let B=F[V];B>=97&&(F[V]=223&B)}else v[Mr]!==97&&se(t,ce("modifiers for format '%%a'/'%%A' not implemented"));return F},sr=ce("-+ #0"),br=t=>97<=t&&t<=122||65<=t&&t<=90,r=t=>48<=t&&t<=57,n=t=>0<=t&&t<=31||t===127,l=t=>33<=t&&t<=126,a=t=>97<=t&&t<=122,u=t=>65<=t&&t<=90,f=t=>97<=t&&t<=122||65<=t&&t<=90||48<=t&&t<=57,s=t=>l(t)&&!f(t),U=t=>t===32||t>=9&&t<=13,xe=t=>48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102,Ge=function(t,v,O){switch(rr(t,O)){case H:{let F=nr(t,O);(function(V,B,$e){N(V,34);let pr=0;for(;$e--;){if(B[pr]===34||B[pr]===92||B[pr]===10)N(V,92),N(V,B[pr]);else if(n(B[pr])){let gr=""+B[pr];r(B[pr+1])&&(gr="0".repeat(3-gr.length)+gr),Re(V,ce("\\"+gr))}else N(V,B[pr]);pr++}N(V,34)})(v,F,F.length);break}case Le:{let F;if(Ye(t,O)){let V=ie(t,O);F=ce(T(V===S?"0x%"+G+"x":A,V))}else{let V=_e(t,O);(function(B){if(ge(B,46)<0){let $e=fe(),pr=ge(B,$e);pr&&(B[pr]=46)}})(F=Qe(t,ce(`%${G}a`),V))}Re(v,F);break}case pe:case K:Cr(t,O),ar(v);break;default:ke(t,O,ce("value has no literal form"))}},Ar=function(t,v,O,F){let V=O;for(;v[V]!==0&&ge(sr,v[V])>=0;)V++;V-O>=sr.length&&se(t,ce("invalid format (repeated flags)")),r(v[V])&&V++,r(v[V])&&V++,v[V]===46&&(r(v[++V])&&V++,r(v[V])&&V++),r(v[V])&&se(t,ce("invalid format (width or precision too long)")),F[0]=37;for(let B=0;B<V-O+1;B++)F[B+1]=v[O+B];return V},Tr=function(t,v){let O=t.length,F=v.length,V=t[O-1];for(let B=0;B<F;B++)t[B+O-1]=v[B];t[O+F-1]=V};class M{constructor(v){this.L=v,this.islittle=!0,this.maxalign=1}}const me=r,L=function(t,v){if(t.off>=t.s.length||!me(t.s[t.off]))return v;{let O=0;do O=10*O+(t.s[t.off++]-48);while(t.off<t.s.length&&me(t.s[t.off])&&O<=2147483638e-1);return O}},ne=function(t,v,O){let F=L(v,O);return(F>16||F<=0)&&se(t.L,ce("integral size (%d) out of limits [1,%d]"),F,16),F},P=function(t,v){let O={opt:v.s[v.off++],size:0};switch(O.opt){case 98:return O.size=1,O.opt=0,O;case 66:return O.size=1,O.opt=1,O;case 104:return O.size=2,O.opt=0,O;case 72:return O.size=2,O.opt=1,O;case 108:return O.size=4,O.opt=0,O;case 76:return O.size=4,O.opt=1,O;case 106:return O.size=4,O.opt=0,O;case 74:case 84:return O.size=4,O.opt=1,O;case 102:return O.size=4,O.opt=2,O;case 100:case 110:return O.size=8,O.opt=2,O;case 105:return O.size=ne(t,v,4),O.opt=0,O;case 73:return O.size=ne(t,v,4),O.opt=1,O;case 115:return O.size=ne(t,v,4),O.opt=4,O;case 99:return O.size=L(v,-1),O.size===-1&&se(t.L,ce("missing size for format option 'c'")),O.opt=3,O;case 122:return O.opt=5,O;case 120:return O.size=1,O.opt=6,O;case 88:return O.opt=7,O;case 32:break;case 60:t.islittle=!0;break;case 62:t.islittle=!1;break;case 61:t.islittle=!0;break;case 33:t.maxalign=ne(t,v,8);break;default:se(t.L,ce("invalid format option '%c'"),O.opt)}return O.opt=8,O},Ce=function(t,v,O){let F={opt:NaN,size:NaN,ntoalign:NaN},V=P(t,O);F.size=V.size,F.opt=V.opt;let B=F.size;if(F.opt===7)if(O.off>=O.s.length||O.s[O.off]===0)ke(t.L,1,ce("invalid next option for option 'X'"));else{let $e=P(t,O);B=$e.size,($e=$e.opt)!==3&&B!==0||ke(t.L,1,ce("invalid next option for option 'X'"))}return B<=1||F.opt===3?F.ntoalign=0:(B>t.maxalign&&(B=t.maxalign),(B&B-1)!=0&&ke(t.L,1,ce("format asks for alignment not power of 2")),F.ntoalign=B-(v&B-1)&B-1),F},_r=function(t,v,O,F,V){let B=mr(t,F);B[O?0:F-1]=255&v;for(let $e=1;$e<F;$e++)v>>=8,B[O?$e:F-1-$e]=255&v;if(V&&F>4)for(let $e=4;$e<F;$e++)B[O?$e:F-1-$e]=255;q(t,F)},fr=function(t,v,O,F,V){let B=0,$e=F<=4?F:4;for(let pr=$e-1;pr>=0;pr--)B<<=8,B|=v[O?pr:F-1-pr];if(F<4){if(V){let pr=1<<8*F-1;B=(B^pr)-pr}}else if(F>4){let pr=!V||B>=0?0:255;for(let gr=$e;gr<F;gr++)v[O?gr:F-1-gr]!==pr&&se(t,ce("%d-byte integer does not fit into Lua Integer"),F)}return B},ur=function(t,v,O,F){Oe.lua_assert(v.length>=F);let V=new DataView(new ArrayBuffer(F));for(let B=0;B<F;B++)V.setUint8(B,v[B],O);return F==4?V.getFloat32(0,O):V.getFloat64(0,O)},kr=ce("^$*+?.([%-");class Br{constructor(v){this.src=null,this.src_init=null,this.src_end=null,this.p=null,this.p_end=null,this.L=v,this.matchdepth=NaN,this.level=NaN,this.capture=[]}}const hr=function(t,v){switch(t.p[v++]){case De:return v===t.p_end&&se(t.L,ce("malformed pattern (ends with '%%')")),v+1;case 91:t.p[v]===94&&v++;do v===t.p_end&&se(t.L,ce("malformed pattern (missing ']')")),t.p[v++]===De&&v<t.p_end&&v++;while(t.p[v]!==93);return v+1;default:return v}},Er=function(t,v){switch(v){case 97:return br(t);case 65:return!br(t);case 99:return n(t);case 67:return!n(t);case 100:return r(t);case 68:return!r(t);case 103:return l(t);case 71:return!l(t);case 108:return a(t);case 76:return!a(t);case 112:return s(t);case 80:return!s(t);case 115:return U(t);case 83:return!U(t);case 117:return u(t);case 85:return!u(t);case 119:return f(t);case 87:return!f(t);case 120:return xe(t);case 88:return!xe(t);case 122:return t===0;case 90:return t!==0;default:return v===t}},vr=function(t,v,O,F){let V=!0;for(t.p[O+1]===94&&(V=!1,O++);++O<F;)if(t.p[O]===De){if(O++,Er(v,t.p[O]))return V}else if(t.p[O+1]===45&&O+2<F){if(O+=2,t.p[O-2]<=v&&v<=t.p[O])return V}else if(t.p[O]===v)return V;return!V},wr=function(t,v,O,F){if(v>=t.src_end)return!1;{let V=t.src[v];switch(t.p[O]){case 46:return!0;case De:return Er(V,t.p[O+1]);case 91:return vr(t,V,O,F-1);default:return t.p[O]===V}}},Ir=function(t,v,O){if(O>=t.p_end-1&&se(t.L,ce("malformed pattern (missing arguments to '%%b'")),t.src[v]!==t.p[O])return null;{let F=t.p[O],V=t.p[O+1],B=1;for(;++v<t.src_end;)if(t.src[v]===V){if(--B==0)return v+1}else t.src[v]===F&&B++}return null},Hr=function(t,v,O,F){let V=0;for(;wr(t,v+V,O,F);)V++;for(;V>=0;){let B=D(t,v+V,F+1);if(B)return B;V--}return null},Vr=function(t,v,O,F){for(;;){let V=D(t,v,F+1);if(V!==null)return V;if(!wr(t,v,O,F))return null;v++}},Xr=function(t,v,O,F){let V,B=t.level;return B>=32&&se(t.L,ce("too many captures")),t.capture[B]=t.capture[B]?t.capture[B]:{},t.capture[B].init=v,t.capture[B].len=F,t.level=B+1,(V=D(t,v,O))===null&&t.level--,V},Fr=function(t,v,O){let F,V=(function(B){let $e=B.level;for($e--;$e>=0;$e--)if(B.capture[$e].len===-1)return $e;return se(B.L,ce("invalid pattern capture"))})(t);return t.capture[V].len=v-t.capture[V].init,(F=D(t,v,O))===null&&(t.capture[V].len=-1),F},c=function(t,v,O){O=(function(V,B){return(B-=49)<0||B>=V.level||V.capture[B].len===-1?se(V.L,ce("invalid capture index %%%d"),B+1):B})(t,O);let F=t.capture[O].len;return t.src_end-v>=F&&(function(V,B,$e,pr,gr){return be(V.subarray(B,B+gr),$e.subarray(pr,pr+gr))})(t.src,t.capture[O].init,t.src,v,F)?v+F:null},D=function(t,v,O){let F=!1,V=!0;for(t.matchdepth--==0&&se(t.L,ce("pattern too complex"));V||F;)if(V=!1,O!==t.p_end)switch(F?void 0:t.p[O]){case 40:v=t.p[O+1]===41?Xr(t,v,O+2,-2):Xr(t,v,O+1,-1);break;case 41:v=Fr(t,v,O+1);break;case 36:if(O+1!==t.p_end){F=!0;break}v=t.src.length-v==0?v:null;break;case De:switch(t.p[O+1]){case 98:(v=Ir(t,v,O+2))!==null&&(O+=4,V=!0);break;case 102:{O+=2,t.p[O]!==91&&se(t.L,ce("missing '[' after '%%f' in pattern"));let B=hr(t,O),$e=v===t.src_init?0:t.src[v-1];if(!vr(t,$e,O,B-1)&&vr(t,v===t.src_end?0:t.src[v],O,B-1)){O=B,V=!0;break}v=null;break}case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:(v=c(t,v,t.p[O+1]))!==null&&(O+=2,V=!0);break;default:F=!0}break;default:{F=!1;let B=hr(t,O);if(wr(t,v,O,B))switch(t.p[B]){case 63:{let $e;($e=D(t,v+1,B+1))!==null?v=$e:(O=B+1,V=!0);break}case 43:v++;case 42:v=Hr(t,v,O,B);break;case 45:v=Vr(t,v,O,B);break;default:v++,O=B,V=!0}else{if(t.p[B]===42||t.p[B]===63||t.p[B]===45){O=B+1,V=!0;break}v=null}break}}return t.matchdepth++,v},Ee=function(t,v,O,F){if(v>=t.level)v===0?Fe(t.L,t.src.subarray(O,F),F-O):se(t.L,ce("invalid capture index %%%d"),v+1);else{let V=t.capture[v].len;V===-1&&se(t.L,ce("unfinished capture")),V===-2?X(t.L,t.capture[v].init-t.src_init+1):Fe(t.L,t.src.subarray(t.capture[v].init),V)}},ye=function(t,v,O){let F=t.level===0&&t.src.subarray(v)?1:t.level;he(t.L,F,"too many captures");for(let V=0;V<F;V++)Ee(t,V,v,O);return F},We=function(t,v,O,F,V,B){t.L=v,t.matchdepth=200,t.src=O,t.src_init=0,t.src_end=F,t.p=V,t.p_end=B},ve=function(t){t.level=0,Oe.lua_assert(t.matchdepth===200)},Se=function(t,v){let O=g(t,1),F=g(t,2),V=O.length,B=F.length,$e=dr(ir(t,3,1),V);if($e<1)$e=1;else if($e>V+1)return He(t),1;if(v&&(m(t,4)||(function(pr,gr){for(let Nr=0;Nr<gr;Nr++)if(ge(kr,pr[Nr])!==-1)return!1;return!0})(F,B))){let pr=(function(gr,Nr,o){var x=o>>>0,Q=Nr.length;if(Q===0)return x;for(;(x=gr.indexOf(Nr[0],x))!==-1;x++)if(be(gr.subarray(x,x+Q),Nr))return x;return-1})(O.subarray($e-1),F,0);if(pr>-1)return X(t,$e+pr),X(t,$e+pr+B-1),2}else{let pr=new Br(t),gr=$e-1,Nr=F[0]===94;Nr&&(F=F.subarray(1),B--),We(pr,t,O,V,F,B);do{let o;if(ve(pr),(o=D(pr,gr,0))!==null)return v?(X(t,gr+1),X(t,o),ye(pr,null,0)+2):ye(pr,gr,o)}while(gr++<pr.src_end&&!Nr)}return He(t),1},Ae=function(t){let v=ze(t,tr(3));v.ms.L=t;for(let O=v.src;O<=v.ms.src_end;O++){let F;if(ve(v.ms),(F=D(v.ms,O,v.p))!==null&&F!==v.lastmatch)return v.src=v.lastmatch=F,ye(v.ms,O,F)}return 0},Xe=function(t,v,O,F,V){let B=t.L;switch(V){case Ie:{Ue(B,3);let $e=ye(t,O,F);$(B,$e,1);break}case oe:Ee(t,0,O,F),Ke(B,3);break;default:return void(function($e,pr,gr,Nr){let o=$e.L,x=nr(o,3),Q=x.length;for(let qe=0;qe<Q;qe++)x[qe]!==De?N(pr,x[qe]):r(x[++qe])?x[qe]===48?de(pr,$e.src.subarray(gr,Nr),Nr-gr):(Ee($e,x[qe]-49,gr,Nr),Cr(o,-1),Z(o,-2),ar(pr)):(x[qe]!==De&&se(o,ce("invalid use of '%c' in replacement string"),De),N(pr,x[qe]))})(t,v,O,F)}m(B,-1)?b(B,-1)||se(B,ce("invalid replacement value (a %s)"),_(B,-1)):(I(B,1),Fe(B,t.src.subarray(O,F),F-O)),ar(v)},er={byte:function(t){let v=g(t,1),O=v.length,F=dr(ir(t,2,1),O),V=dr(ir(t,3,F),O);if(F<1&&(F=1),V>O&&(V=O),F>V)return 0;if(V-F>=Number.MAX_SAFE_INTEGER)return se(t,"string slice too long");let B=V-F+1;he(t,B,"string slice too long");for(let $e=0;$e<B;$e++)X(t,v[F+$e-1]);return B},char:function(t){let v=Pe(t),O=new R,F=le(t,O,v);for(let V=1;V<=v;V++){let B=p(t,V);Je(t,B>=0&&B<=255,"value out of range"),F[V-1]=B}return Rr(O,v),1},dump:function(t){let v=new R,O=m(t,2);return z(t,1,Ie),k(t,1),w(t,v),Me(t,xr,v,O)!==0?se(t,ce("unable to dump given function")):(Sr(v),1)},find:function(t){return Se(t,1)},format:function(t){let v=Pe(t),O=1,F=g(t,O),V=0,B=new R;for(w(t,B);V<F.length;)if(F[V]!==De)N(B,F[V++]);else if(F[++V]===De)N(B,F[V++]);else{let $e=[];switch(++O>v&&ke(t,O,ce("no value")),V=Ar(t,F,V,$e),String.fromCharCode(F[V++])){case"c":N(B,p(t,O));break;case"d":case"i":case"o":case"u":case"x":case"X":{let pr=p(t,O);Tr($e,ce(G,!0)),Re(B,ce(T(String.fromCharCode(...$e),pr)));break}case"a":case"A":Tr($e,ce(G,!0)),Re(B,Qe(t,$e,j(t,O)));break;case"e":case"E":case"f":case"g":case"G":{let pr=j(t,O);Tr($e,ce(G,!0)),Re(B,ce(T(String.fromCharCode(...$e),pr)));break}case"q":Ge(t,B,O);break;case"s":{let pr=Cr(t,O);$e.length<=2||$e[2]===0?ar(B):(Je(t,pr.length===Lr(pr),O,"string contains zeros"),ge($e,46)<0&&pr.length>=100?ar(B):(Re(B,ce(T(String.fromCharCode(...$e),ae(pr)))),I(t,1)));break}default:return se(t,ce("invalid option '%%%c' to 'format'"),F[V-1])}}return Sr(B),1},gmatch:function(t){let v=g(t,1),O=g(t,2),F=v.length,V=O.length;k(t,2);let B=new class{constructor(){this.src=NaN,this.p=NaN,this.lastmatch=NaN,this.ms=new Br}};return ee(t,B),We(B.ms,t,v,F,O,V),B.src=0,B.p=0,B.lastmatch=null,Y(t,Ae,3),1},gsub:function(t){let v=g(t,1),O=v.length,F=g(t,2),V=F.length,B=null,$e=rr(t,3),pr=ir(t,4,O+1),gr=F[0]===94,Nr=0,o=new Br(t),x=new R;for(Je(t,$e===Le||$e===H||$e===Ie||$e===oe,3,"string/function/table expected"),w(t,x),gr&&(F=F.subarray(1),V--),We(o,t,v,O,F,V),v=0,F=0;Nr<pr;){let Q;if(ve(o),(Q=D(o,v,F))!==null&&Q!==B)Nr++,Xe(o,x,v,Q,$e),v=B=Q;else{if(!(v<o.src_end))break;N(x,o.src[v++])}if(gr)break}return de(x,o.src.subarray(v,o.src_end),o.src_end-v),Sr(x),X(t,Nr),2},len:function(t){return X(t,g(t,1).length),1},lower:function(t){let v=g(t,1),O=v.length,F=new Uint8Array(O);for(let V=0;V<O;V++){let B=v[V];u(B)&&(B|=32),F[V]=B}return W(t,F),1},match:function(t){return Se(t,0)},pack:function(t){let v=new R,O=new M(t),F={s:g(t,1),off:0},V=1,B=0;for(He(t),w(t,v);F.off<F.s.length;){let $e=Ce(O,B,F),pr=$e.opt,gr=$e.size,Nr=$e.ntoalign;for(B+=Nr+gr;Nr-- >0;)N(v,0);switch(V++,pr){case 0:{let o=p(t,V);if(gr<4){let x=1<<8*gr-1;Je(t,-x<=o&&o<x,V,"integer overflow")}_r(v,o,O.islittle,gr,o<0);break}case 1:{let o=p(t,V);gr<4&&Je(t,o>>>0<1<<8*gr,V,"unsigned overflow"),_r(v,o>>>0,O.islittle,gr,!1);break}case 2:{let o=mr(v,gr),x=j(t,V),Q=new DataView(o.buffer,o.byteOffset,o.byteLength);gr===4?Q.setFloat32(0,x,O.islittle):Q.setFloat64(0,x,O.islittle),q(v,gr);break}case 3:{let o=g(t,V),x=o.length;for(Je(t,x<=gr,V,"string longer than given size"),de(v,o,x);x++<gr;)N(v,0);break}case 4:{let o=g(t,V),x=o.length;Je(t,gr>=4||x<1<<8*gr,V,"string length does not fit in given size"),_r(v,x,O.islittle,gr,0),de(v,o,x),B+=x;break}case 5:{let o=g(t,V),x=o.length;Je(t,ge(o,0)<0,V,"strings contains zeros"),de(v,o,x),N(v,0),B+=x+1;break}case 6:N(v,0);case 7:case 8:V--}}return Sr(v),1},packsize:function(t){let v=new M(t),O={s:g(t,1),off:0},F=0;for(;O.off<O.s.length;){let V=Ce(v,F,O),B=V.opt,$e=V.size,pr=V.ntoalign;switch(Je(t,F<=2147483647-($e+=pr),1,"format result too large"),F+=$e,B){case 4:case 5:ke(t,1,"variable-length format")}}return X(t,F),1},rep:function(t){let v=g(t,1),O=v.length,F=p(t,2),V=cr(t,3,""),B=V.length;if(F<=0)Ne(t,"");else{if(O+B<O||O+B>2147483647/F)return se(t,ce("resulting string too large"));{let $e=F*O+(F-1)*B,pr=new R,gr=le(t,pr,$e),Nr=0;for(;F-- >1;)gr.set(v,Nr),Nr+=O,B>0&&(gr.set(V,Nr),Nr+=B);gr.set(v,Nr),Rr(pr,$e)}}return 1},reverse:function(t){let v=g(t,1),O=v.length,F=new Uint8Array(O);for(let V=0;V<O;V++)F[V]=v[O-1-V];return W(t,F),1},sub:function(t){let v=g(t,1),O=v.length,F=dr(p(t,2),O),V=dr(ir(t,3,-1),O);return F<1&&(F=1),V>O&&(V=O),F<=V?W(t,v.subarray(F-1,F-1+(V-F+1))):Ne(t,""),1},unpack:function(t){let v=new M(t),O={s:g(t,1),off:0},F=g(t,2),V=F.length,B=dr(ir(t,3,1),V)-1,$e=0;for(Je(t,B<=V&&B>=0,3,"initial position out of string");O.off<O.s.length;){let pr=Ce(v,B,O),gr=pr.opt,Nr=pr.size,o=pr.ntoalign;switch(B+o+Nr>V&&ke(t,2,ce("data string too short")),B+=o,he(t,2,"too many results"),$e++,gr){case 0:case 1:{let x=fr(t,F.subarray(B),v.islittle,Nr,gr===0);X(t,x);break}case 2:{let x=ur(0,F.subarray(B),v.islittle,Nr);y(t,x);break}case 3:W(t,F.subarray(B,B+Nr));break;case 4:{let x=fr(t,F.subarray(B),v.islittle,Nr,0);Je(t,B+x+Nr<=V,2,"data string too short"),W(t,F.subarray(B+Nr,B+Nr+x)),B+=x;break}case 5:{let x=ge(F,0,B);x===-1&&(x=F.length-B),W(t,F.subarray(B,x)),B=x+1;break}case 7:case 6:case 8:$e--}B+=Nr}return X(t,B+1),$e+1},upper:function(t){let v=g(t,1),O=v.length,F=new Uint8Array(O);for(let V=0;V<O;V++){let B=v[V];a(B)&&(B&=223),F[V]=B}return W(t,F),1}};e.exports.luaopen_string=function(t){return or(t,er),(function(v){Be(v,0,1),Ne(v,""),Ue(v,-2),d(v,-2),I(v,1),Ue(v,-2),je(v,-2,ce("__index",!0)),I(v,1)})(t),1}},function(e,lr,h){const{lua_gettop:T,lua_pushcfunction:A,lua_pushfstring:G,lua_pushinteger:S,lua_pushnil:ue,lua_pushstring:we,lua_pushvalue:C,lua_setfield:fe,lua_tointeger:K}=h(2),{luaL_Buffer:Ie,luaL_addvalue:pe,luaL_argcheck:Le,luaL_buffinit:H,luaL_checkinteger:oe,luaL_checkstack:$,luaL_checkstring:Be,luaL_error:Me,luaL_newlib:Ke,luaL_optinteger:Pe,luaL_pushresult:Ye}=h(7),{luastring_of:b,to_luastring:I}=h(5),Y=function(Z){return(192&Z)===128},X=function(Z,je){return Z>=0?Z:0-Z>je?0:je+Z+1},ee=[255,127,2047,65535],Ne=function(Z,je){let d=Z[je],k=0;if(d<128)k=d;else{let m=0;for(;64&d;){let ie=Z[je+ ++m];if((192&ie)!=128)return null;k=k<<6|63&ie,d<<=1}if(k|=(127&d)<<5*m,m>3||k>1114111||k<=ee[m])return null;je+=m}return{code:k,pos:je+1}},Fe=I("%U"),He=function(Z,je){let d=oe(Z,je);Le(Z,0<=d&&d<=1114111,je,"value out of range"),G(Z,Fe,d)},y=function(Z){let je=Be(Z,1),d=je.length,k=K(Z,2)-1;if(k<0)k=0;else if(k<d)for(k++;Y(je[k]);)k++;if(k>=d)return 0;{let m=Ne(je,k);return m===null||Y(je[m.pos])?Me(Z,I("invalid UTF-8 code")):(S(Z,k+1),S(Z,m.code),2)}},W={char:function(Z){let je=T(Z);if(je===1)He(Z,1);else{let d=new Ie;H(Z,d);for(let k=1;k<=je;k++)He(Z,k),pe(d);Ye(d)}return 1},codepoint:function(Z){let je=Be(Z,1),d=X(Pe(Z,2,1),je.length),k=X(Pe(Z,3,d),je.length);if(Le(Z,d>=1,2,"out of range"),Le(Z,k<=je.length,3,"out of range"),d>k)return 0;if(k-d>=Number.MAX_SAFE_INTEGER)return Me(Z,"string slice too long");let m=k-d+1;for($(Z,m,"string slice too long"),m=0,d-=1;d<k;){let ie=Ne(je,d);if(ie===null)return Me(Z,"invalid UTF-8 code");S(Z,ie.code),d=ie.pos,m++}return m},codes:function(Z){return Be(Z,1),A(Z,y),C(Z,1),S(Z,0),3},len:function(Z){let je=0,d=Be(Z,1),k=d.length,m=X(Pe(Z,2,1),k),ie=X(Pe(Z,3,-1),k);for(Le(Z,1<=m&&--m<=k,2,"initial position out of string"),Le(Z,--ie<k,3,"final position out of string");m<=ie;){let _e=Ne(d,m);if(_e===null)return ue(Z),S(Z,m+1),2;m=_e.pos,je++}return S(Z,je),1},offset:function(Z){let je=Be(Z,1),d=oe(Z,2),k=d>=0?1:je.length+1;if(k=X(Pe(Z,3,k),je.length),Le(Z,1<=k&&--k<=je.length,3,"position out of range"),d===0)for(;k>0&&Y(je[k]);)k--;else if(Y(je[k])&&Me(Z,"initial position is a continuation byte"),d<0)for(;d<0&&k>0;){do k--;while(k>0&&Y(je[k]));d++}else for(d--;d>0&&k<je.length;){do k++;while(Y(je[k]));d--}return d===0?S(Z,k+1):ue(Z),1}},Ue=b(91,0,45,127,194,45,244,93,91,128,45,191,93,42);e.exports.luaopen_utf8=function(Z){return Ke(Z,W),we(Z,Ue),fe(Z,-2,I("charpattern",!0)),1}},function(e,lr,h){const{LUA_OPLT:T,LUA_TNUMBER:A,lua_compare:G,lua_gettop:S,lua_isinteger:ue,lua_isnoneornil:we,lua_pushboolean:C,lua_pushinteger:fe,lua_pushliteral:K,lua_pushnil:Ie,lua_pushnumber:pe,lua_pushvalue:Le,lua_setfield:H,lua_settop:oe,lua_tointeger:$,lua_tointegerx:Be,lua_type:Me}=h(2),{luaL_argcheck:Ke,luaL_argerror:Pe,luaL_checkany:Ye,luaL_checkinteger:b,luaL_checknumber:I,luaL_error:Y,luaL_newlib:X,luaL_optnumber:ee}=h(7),{LUA_MAXINTEGER:Ne,LUA_MININTEGER:Fe,lua_numbertointeger:He}=h(3),{to_luastring:y}=h(5);let W;const Ue=function(){return W=1103515245*W+12345&2147483647},Z=function(d,k){let m=He(k);m!==!1?fe(d,m):pe(d,k)},je={abs:function(d){if(ue(d,1)){let k=$(d,1);k<0&&(k=0|-k),fe(d,k)}else pe(d,Math.abs(I(d,1)));return 1},acos:function(d){return pe(d,Math.acos(I(d,1))),1},asin:function(d){return pe(d,Math.asin(I(d,1))),1},atan:function(d){let k=I(d,1),m=ee(d,2,1);return pe(d,Math.atan2(k,m)),1},ceil:function(d){return ue(d,1)?oe(d,1):Z(d,Math.ceil(I(d,1))),1},cos:function(d){return pe(d,Math.cos(I(d,1))),1},deg:function(d){return pe(d,I(d,1)*(180/Math.PI)),1},exp:function(d){return pe(d,Math.exp(I(d,1))),1},floor:function(d){return ue(d,1)?oe(d,1):Z(d,Math.floor(I(d,1))),1},fmod:function(d){if(ue(d,1)&&ue(d,2)){let k=$(d,2);k===0?Pe(d,2,"zero"):fe(d,$(d,1)%k|0)}else{let k=I(d,1),m=I(d,2);pe(d,k%m)}return 1},log:function(d){let k,m=I(d,1);if(we(d,2))k=Math.log(m);else{let ie=I(d,2);k=ie===2?Math.log2(m):ie===10?Math.log10(m):Math.log(m)/Math.log(ie)}return pe(d,k),1},max:function(d){let k=S(d),m=1;Ke(d,k>=1,1,"value expected");for(let ie=2;ie<=k;ie++)G(d,m,ie,T)&&(m=ie);return Le(d,m),1},min:function(d){let k=S(d),m=1;Ke(d,k>=1,1,"value expected");for(let ie=2;ie<=k;ie++)G(d,ie,m,T)&&(m=ie);return Le(d,m),1},modf:function(d){if(ue(d,1))oe(d,1),pe(d,0);else{let k=I(d,1),m=k<0?Math.ceil(k):Math.floor(k);Z(d,m),pe(d,k===m?0:k-m)}return 2},rad:function(d){return pe(d,I(d,1)*(Math.PI/180)),1},random:function(d){let k,m,ie=W===void 0?Math.random():Ue()/2147483648;switch(S(d)){case 0:return pe(d,ie),1;case 1:k=1,m=b(d,1);break;case 2:k=b(d,1),m=b(d,2);break;default:return Y(d,"wrong number of arguments")}return Ke(d,k<=m,1,"interval is empty"),Ke(d,k>=0||m<=Ne+k,1,"interval too large"),ie*=m-k+1,fe(d,Math.floor(ie)+k),1},randomseed:function(d){return(function(k){(W=0|k)==0&&(W=1)})(I(d,1)),Ue(),0},sin:function(d){return pe(d,Math.sin(I(d,1))),1},sqrt:function(d){return pe(d,Math.sqrt(I(d,1))),1},tan:function(d){return pe(d,Math.tan(I(d,1))),1},tointeger:function(d){let k=Be(d,1);return k!==!1?fe(d,k):(Ye(d,1),Ie(d)),1},type:function(d){return Me(d,1)===A?ue(d,1)?K(d,"integer"):K(d,"float"):(Ye(d,1),Ie(d)),1},ult:function(d){let k=b(d,1),m=b(d,2);return C(d,k>=0?m<0||k<m:m<0&&k<m),1}};e.exports.luaopen_math=function(d){return X(d,je),pe(d,Math.PI),H(d,-2,y("pi",!0)),pe(d,1/0),H(d,-2,y("huge",!0)),fe(d,Ne),H(d,-2,y("maxinteger",!0)),fe(d,Fe),H(d,-2,y("mininteger",!0)),1}},function(e,lr,h){const{LUA_MASKCALL:T,LUA_MASKCOUNT:A,LUA_MASKLINE:G,LUA_MASKRET:S,LUA_REGISTRYINDEX:ue,LUA_TFUNCTION:we,LUA_TNIL:C,LUA_TTABLE:fe,LUA_TUSERDATA:K,lua_Debug:Ie,lua_call:pe,lua_checkstack:Le,lua_gethook:H,lua_gethookcount:oe,lua_gethookmask:$,lua_getinfo:Be,lua_getlocal:Me,lua_getmetatable:Ke,lua_getstack:Pe,lua_getupvalue:Ye,lua_getuservalue:b,lua_insert:I,lua_iscfunction:Y,lua_isfunction:X,lua_isnoneornil:ee,lua_isthread:Ne,lua_newtable:Fe,lua_pcall:He,lua_pop:y,lua_pushboolean:W,lua_pushfstring:Ue,lua_pushinteger:Z,lua_pushlightuserdata:je,lua_pushliteral:d,lua_pushnil:k,lua_pushstring:m,lua_pushvalue:ie,lua_rawgetp:_e,lua_rawsetp:nr,lua_rotate:ze,lua_setfield:rr,lua_sethook:tr,lua_setlocal:R,lua_setmetatable:N,lua_settop:de,lua_setupvalue:q,lua_setuservalue:Re,lua_tojsstring:ar,lua_toproxy:Je,lua_tostring:ke,lua_tothread:w,lua_touserdata:le,lua_type:p,lua_upvalueid:j,lua_upvaluejoin:he,lua_xmove:g}=h(2),{luaL_argcheck:z,luaL_argerror:se,luaL_checkany:or,luaL_checkinteger:ir,luaL_checkstring:cr,luaL_checktype:mr,luaL_error:Sr,luaL_loadbuffer:Rr,luaL_newlib:Cr,luaL_optinteger:_,luaL_optstring:Oe,luaL_traceback:be,lua_writestringerror:ge}=h(7),ae=h(17),{luastring_indexOf:ce,to_luastring:De}=h(5),Lr=function(s,U,xe){s===U||Le(U,xe)||Sr(s,De("stack overflow",!0))},dr=function(s){return Ne(s,1)?{arg:1,thread:w(s,1)}:{arg:0,thread:s}},xr=function(s,U,xe){m(s,xe),rr(s,-2,U)},Mr=function(s,U,xe){Z(s,xe),rr(s,-2,U)},Qe=function(s,U,xe){W(s,xe),rr(s,-2,U)},sr=function(s,U,xe){s==U?ze(s,-2,1):g(U,s,1),rr(s,-2,xe)},br=function(s,U){let xe=ir(s,2);mr(s,1,we);let Ge=U?Ye(s,1,xe):q(s,1,xe);return Ge===null?0:(m(s,Ge),I(s,-(U+1)),U+1)},r=function(s,U,xe){let Ge=ir(s,xe);return mr(s,U,we),z(s,Ye(s,U,Ge)!==null,xe,"invalid upvalue index"),Ge},n=De("__hooks__",!0),l=["call","return","line","count","tail call"].map(s=>De(s)),a=function(s,U){_e(s,ue,n);let xe=le(s,-1).get(s);xe&&(xe(s),m(s,l[U.event]),U.currentline>=0?Z(s,U.currentline):k(s),ae.lua_assert(Be(s,De("lS"),U)),pe(s,2,0))},u={gethook:function(s){let U=dr(s).thread,xe=new Uint8Array(5),Ge=$(U),Ar=H(U);return Ar===null?k(s):Ar!==a?d(s,"external hook"):(_e(s,ue,n),le(s,-1).get(U)(s)),m(s,(function(Tr,M){let me=0;return Tr&T&&(M[me++]=99),Tr&S&&(M[me++]=114),Tr&G&&(M[me++]=108),M.subarray(0,me)})(Ge,xe)),Z(s,oe(U)),3},getinfo:function(s){let U=new Ie,xe=dr(s),Ge=xe.arg,Ar=xe.thread,Tr=Oe(s,Ge+2,"flnStu");if(Lr(s,Ar,3),X(s,Ge+1))Tr=Ue(s,De(">%s"),Tr),ie(s,Ge+1),g(s,Ar,1);else if(!Pe(Ar,ir(s,Ge+1),U))return k(s),1;return Be(Ar,Tr,U)||se(s,Ge+2,"invalid option"),Fe(s),ce(Tr,83)>-1&&(xr(s,De("source",!0),U.source),xr(s,De("short_src",!0),U.short_src),Mr(s,De("linedefined",!0),U.linedefined),Mr(s,De("lastlinedefined",!0),U.lastlinedefined),xr(s,De("what",!0),U.what)),ce(Tr,108)>-1&&Mr(s,De("currentline",!0),U.currentline),ce(Tr,117)>-1&&(Mr(s,De("nups",!0),U.nups),Mr(s,De("nparams",!0),U.nparams),Qe(s,De("isvararg",!0),U.isvararg)),ce(Tr,110)>-1&&(xr(s,De("name",!0),U.name),xr(s,De("namewhat",!0),U.namewhat)),ce(Tr,116)>-1&&Qe(s,De("istailcall",!0),U.istailcall),ce(Tr,76)>-1&&sr(s,Ar,De("activelines",!0)),ce(Tr,102)>-1&&sr(s,Ar,De("func",!0)),1},getlocal:function(s){let U=dr(s),xe=U.thread,Ge=U.arg,Ar=new Ie,Tr=ir(s,Ge+2);if(X(s,Ge+1))return ie(s,Ge+1),m(s,Me(s,null,Tr)),1;{let M=ir(s,Ge+1);if(!Pe(xe,M,Ar))return se(s,Ge+1,"level out of range");Lr(s,xe,1);let me=Me(xe,Ar,Tr);return me?(g(xe,s,1),m(s,me),ze(s,-2,1),2):(k(s),1)}},getmetatable:function(s){return or(s,1),Ke(s,1)||k(s),1},getregistry:function(s){return ie(s,ue),1},getupvalue:function(s){return br(s,1)},getuservalue:function(s){return p(s,1)!==K?k(s):b(s,1),1},sethook:function(s){let U,xe,Ge,Ar,Tr=dr(s),M=Tr.thread,me=Tr.arg;if(ee(s,me+1))de(s,me+1),Ge=null,U=0,xe=0;else{const ne=cr(s,me+2);mr(s,me+1,we),xe=_(s,me+3,0),Ge=a,U=(function(P,Ce){let _r=0;return ce(P,99)>-1&&(_r|=T),ce(P,114)>-1&&(_r|=S),ce(P,108)>-1&&(_r|=G),Ce>0&&(_r|=A),_r})(ne,xe)}_e(s,ue,n)===C?(Ar=new WeakMap,je(s,Ar),nr(s,ue,n)):Ar=le(s,-1);let L=Je(s,me+1);return Ar.set(M,L),tr(M,Ge,U,xe),0},setlocal:function(s){let U=dr(s),xe=U.thread,Ge=U.arg,Ar=new Ie,Tr=ir(s,Ge+1),M=ir(s,Ge+2);if(!Pe(xe,Tr,Ar))return se(s,Ge+1,"level out of range");or(s,Ge+3),de(s,Ge+3),Lr(s,xe,1),g(s,xe,1);let me=R(xe,Ar,M);return me===null&&y(xe,1),m(s,me),1},setmetatable:function(s){const U=p(s,2);return z(s,U==C||U==fe,2,"nil or table expected"),de(s,2),N(s,1),1},setupvalue:function(s){return or(s,3),br(s,0)},setuservalue:function(s){return mr(s,1,K),or(s,2),de(s,2),Re(s,1),1},traceback:function(s){let U=dr(s),xe=U.thread,Ge=U.arg,Ar=ke(s,Ge+1);if(Ar!==null||ee(s,Ge+1)){let Tr=_(s,Ge+2,s===xe?1:0);be(s,xe,Ar,Tr)}else ie(s,Ge+1);return 1},upvalueid:function(s){let U=r(s,1,2);return je(s,j(s,1,U)),1},upvaluejoin:function(s){let U=r(s,1,2),xe=r(s,3,4);return z(s,!Y(s,1),1,"Lua function expected"),z(s,!Y(s,3),3,"Lua function expected"),he(s,1,U,3,xe),0}};let f;typeof window<"u"&&(f=function(){let s=prompt("lua_debug>","");return s!==null?s:""}),f&&(u.debug=function(s){for(;;){let U=f();if(U==="cont")return 0;if(U.length===0)continue;let xe=De(U);(Rr(s,xe,xe.length,De("=(debug command)",!0))||He(s,0,0,0))&&ge(ar(s,-1),`
`),de(s,0)}}),e.exports.luaopen_debug=function(s){return Cr(s,u),1}},function(e,lr,h){const{LUA_DIRSEP:T,LUA_EXEC_DIR:A,LUA_JSPATH_DEFAULT:G,LUA_PATH_DEFAULT:S,LUA_PATH_MARK:ue,LUA_PATH_SEP:we}=h(3),{LUA_OK:C,LUA_REGISTRYINDEX:fe,LUA_TNIL:K,LUA_TTABLE:Ie,lua_callk:pe,lua_createtable:Le,lua_getfield:H,lua_insert:oe,lua_isfunction:$,lua_isnil:Be,lua_isstring:Me,lua_newtable:Ke,lua_pop:Pe,lua_pushboolean:Ye,lua_pushcclosure:b,lua_pushcfunction:I,lua_pushfstring:Y,lua_pushglobaltable:X,lua_pushlightuserdata:ee,lua_pushliteral:Ne,lua_pushlstring:Fe,lua_pushnil:He,lua_pushstring:y,lua_pushvalue:W,lua_rawgeti:Ue,lua_rawgetp:Z,lua_rawseti:je,lua_rawsetp:d,lua_remove:k,lua_setfield:m,lua_setmetatable:ie,lua_settop:_e,lua_toboolean:nr,lua_tostring:ze,lua_touserdata:rr,lua_upvalueindex:tr}=h(2),{LUA_LOADED_TABLE:R,LUA_PRELOAD_TABLE:N,luaL_Buffer:de,luaL_addvalue:q,luaL_buffinit:Re,luaL_checkstring:ar,luaL_error:Je,luaL_getsubtable:ke,luaL_gsub:w,luaL_len:le,luaL_loadfile:p,luaL_newlib:j,luaL_optstring:he,luaL_pushresult:g,luaL_setfuncs:z}=h(7),se=h(17),{luastring_indexOf:or,to_jsstring:ir,to_luastring:cr,to_uristring:mr}=h(5),Sr=h(0),Rr=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:(0,eval)("this"),Cr=cr("__JSLIBS__"),_=T,Oe=T,be=cr("luaopen_"),ge=cr("_"),ae=cr("");let ce;ce=function(M,me,L){me=mr(me);let ne=new XMLHttpRequest;if(ne.open("GET",me,!1),ne.send(),ne.status<200||ne.status>=300)return y(M,cr(`${ne.status}: ${ne.statusText}`)),null;let P,Ce=ne.response;/\/\/[#@] sourceURL=/.test(Ce)||(Ce+=" //# sourceURL="+me);try{P=Function("fengari",Ce)}catch(fr){return y(M,cr(`${fr.name}: ${fr.message}`)),null}let _r=P(Sr);return typeof _r=="function"||typeof _r=="object"&&_r!==null?_r:_r===void 0?Rr:(y(M,cr(`library returned unexpected type (${typeof _r})`)),null)};let De;De=function(M){M=mr(M);let me=new XMLHttpRequest;return me.open("GET",M,!1),me.send(),me.status>=200&&me.status<=299};const Lr=function(M,me,L){let ne=Mr(M,me);if(ne===null){if((ne=ce(M,me,L[0]===42))===null)return 1;Qe(M,me,ne)}if(L[0]===42)return Ye(M,1),0;{let P=(function(Ce,_r,fr){let ur=_r[ir(fr)];return ur&&typeof ur=="function"?ur:(Y(Ce,cr("undefined symbol: %s"),fr),null)})(M,ne,L);return P===null?2:(I(M,P),0)}},dr=Rr,xr=function(M,me,L,ne){let P=`${L}${se.LUA_VERSUFFIX}`;y(M,cr(P));let Ce=dr[P];Ce===void 0&&(Ce=dr[L]),Ce===void 0||(function(_r){H(_r,fe,cr("LUA_NOENV"));let fr=nr(_r,-1);return Pe(_r,1),fr})(M)?y(M,ne):(Ce=w(M,cr(Ce),cr(we+we,!0),cr(we+ir(ae)+we,!0)),w(M,Ce,ae,ne),k(M,-2)),m(M,-3,me),Pe(M,1)},Mr=function(M,me){Z(M,fe,Cr),H(M,-1,me);let L=rr(M,-1);return Pe(M,2),L},Qe=function(M,me,L){Z(M,fe,Cr),ee(M,L),W(M,-1),m(M,-3,me),je(M,-2,le(M,-2)+1),Pe(M,1)},sr=function(M,me){for(;me[0]===we.charCodeAt(0);)me=me.subarray(1);if(me.length===0)return null;let L=or(me,we.charCodeAt(0));return L<0&&(L=me.length),Fe(M,me,L),me.subarray(L)},br=function(M,me,L,ne,P){let Ce=new de;for(Re(M,Ce),ne[0]!==0&&(me=w(M,me,ne,P));(L=sr(M,L))!==null;){let _r=w(M,ze(M,-1),cr(ue,!0),me);if(k(M,-2),De(_r))return _r;Y(M,cr(`
	no file '%s'`),_r),k(M,-2),q(Ce)}return g(Ce),null},r=function(M,me,L,ne){H(M,tr(1),L);let P=ze(M,-1);return P===null&&Je(M,cr("'package.%s' must be a string"),L),br(M,me,P,cr("."),ne)},n=function(M,me,L){return me?(y(M,L),2):Je(M,cr(`error loading module '%s' from file '%s':
	%s`),ze(M,1),L,ze(M,-1))},l=function(M){let me=ar(M,1),L=r(M,me,cr("path",!0),cr(Oe,!0));return L===null?1:n(M,p(M,L)===C,L)},a=function(M,me,L){let ne;L=w(M,L,cr("."),ge);let P=or(L,45);if(P>=0){ne=Fe(M,L,P),ne=Y(M,cr("%s%s"),be,ne);let Ce=Lr(M,me,ne);if(Ce!==2)return Ce;L=P+1}return ne=Y(M,cr("%s%s"),be,L),Lr(M,me,ne)},u=function(M){let me=ar(M,1),L=r(M,me,cr("jspath",!0),cr(_,!0));return L===null?1:n(M,a(M,L,me)===0,L)},f=function(M){let me,L=ar(M,1),ne=or(L,46);if(ne<0)return 0;Fe(M,L,ne);let P=r(M,ze(M,-1),cr("jspath",!0),cr(_,!0));return P===null?1:(me=a(M,P,L))!==0?me!=2?n(M,0,P):(y(M,cr(`
	no module '%s' in file '%s'`),L,P),1):(y(M,P),2)},s=function(M){let me=ar(M,1);return H(M,fe,N),H(M,-1,me)===K&&Y(M,cr(`
	no field package.preload['%s']`),me),1},U=function(M,me,L){for(;me===C?(Ue(M,3,L.i)===K&&(Pe(M,1),g(L.msg),Je(M,cr("module '%s' not found:%s"),L.name,ze(M,-1))),y(M,L.name),pe(M,1,2,L,U)):me=C,!$(M,-2);L.i++)Me(M,-2)?(Pe(M,1),q(L.msg)):Pe(M,2);return L.k(M,C,L.ctx)},xe=function(M,me,L){return y(M,L),oe(M,-2),pe(M,2,1,L,Ge),Ge(M,C,L)},Ge=function(M,me,L){let ne=L;return Be(M,-1)||m(M,2,ne),H(M,2,ne)==K&&(Ye(M,1),W(M,-1),m(M,2,ne)),1},Ar={loadlib:function(M){let me=ar(M,1),L=ar(M,2),ne=Lr(M,me,L);return ne===0?1:(He(M),oe(M,-2),Ne(M,ne===1?"open":"init"),3)},searchpath:function(M){return br(M,ar(M,1),ar(M,2),he(M,3,"."),he(M,4,T))!==null?1:(He(M),oe(M,-2),2)}},Tr={require:function(M){let me=ar(M,1);return _e(M,1),H(M,fe,R),H(M,2,me),nr(M,-1)?1:(Pe(M,1),(function(L,ne,P,Ce){let _r=new de;return Re(L,_r),H(L,tr(1),cr("searchers",!0))!==Ie&&Je(L,cr("'package.searchers' must be a table")),U(L,C,{name:ne,i:1,msg:_r,ctx:P,k:Ce})})(M,me,me,xe))}};e.exports.luaopen_package=function(M){return(function(me){Ke(me),Le(me,0,1),ie(me,-2),d(me,fe,Cr)})(M),j(M,Ar),(function(me){let L=[s,l,u,f,null];Le(me);for(let ne=0;L[ne];ne++)W(me,-2),b(me,L[ne],1),je(me,-2,ne+1);m(me,-2,cr("searchers",!0))})(M),xr(M,cr("path",!0),"LUA_PATH",S),xr(M,cr("jspath",!0),"LUA_JSPATH",G),Ne(M,T+`
`+we+`
`+ue+`
`+A+`
-
`),m(M,-2,cr("config",!0)),ke(M,fe,R),m(M,-2,cr("loaded",!0)),ke(M,fe,N),m(M,-2,cr("preload",!0)),X(M),W(M,-2),z(M,Tr,1),Pe(M,1),1}},function(e,lr,h){const{lua_pushinteger:T,lua_pushliteral:A,lua_setfield:G}=h(2),{luaL_newlib:S}=h(7),{FENGARI_AUTHORS:ue,FENGARI_COPYRIGHT:we,FENGARI_RELEASE:C,FENGARI_VERSION:fe,FENGARI_VERSION_MAJOR:K,FENGARI_VERSION_MINOR:Ie,FENGARI_VERSION_NUM:pe,FENGARI_VERSION_RELEASE:Le,to_luastring:H}=h(5);e.exports.luaopen_fengari=function(oe){return S(oe,{}),A(oe,ue),G(oe,-2,H("AUTHORS")),A(oe,we),G(oe,-2,H("COPYRIGHT")),A(oe,C),G(oe,-2,H("RELEASE")),A(oe,fe),G(oe,-2,H("VERSION")),A(oe,K),G(oe,-2,H("VERSION_MAJOR")),A(oe,Ie),G(oe,-2,H("VERSION_MINOR")),T(oe,pe),G(oe,-2,H("VERSION_NUM")),A(oe,Le),G(oe,-2,H("VERSION_RELEASE")),1}},function(e,lr,h){h.r(lr),h.d(lr,"L",function(){return Fe}),h.d(lr,"load",function(){return He});var T=h(0);h.d(lr,"FENGARI_AUTHORS",function(){return T.FENGARI_AUTHORS}),h.d(lr,"FENGARI_COPYRIGHT",function(){return T.FENGARI_COPYRIGHT}),h.d(lr,"FENGARI_RELEASE",function(){return T.FENGARI_RELEASE}),h.d(lr,"FENGARI_VERSION",function(){return T.FENGARI_VERSION}),h.d(lr,"FENGARI_VERSION_MAJOR",function(){return T.FENGARI_VERSION_MAJOR}),h.d(lr,"FENGARI_VERSION_MINOR",function(){return T.FENGARI_VERSION_MINOR}),h.d(lr,"FENGARI_VERSION_NUM",function(){return T.FENGARI_VERSION_NUM}),h.d(lr,"FENGARI_VERSION_RELEASE",function(){return T.FENGARI_VERSION_RELEASE}),h.d(lr,"luastring_eq",function(){return T.luastring_eq}),h.d(lr,"luastring_indexOf",function(){return T.luastring_indexOf}),h.d(lr,"luastring_of",function(){return T.luastring_of}),h.d(lr,"to_jsstring",function(){return T.to_jsstring}),h.d(lr,"to_luastring",function(){return T.to_luastring}),h.d(lr,"to_uristring",function(){return T.to_uristring}),h.d(lr,"lua",function(){return T.lua}),h.d(lr,"lauxlib",function(){return T.lauxlib}),h.d(lr,"lualib",function(){return T.lualib});var A=h(21);h.d(lr,"interop",function(){return A});const{LUA_ERRRUN:G,LUA_ERRSYNTAX:S,LUA_OK:ue,LUA_VERSION_MAJOR:we,LUA_VERSION_MINOR:C,lua_Debug:fe,lua_getinfo:K,lua_getstack:Ie,lua_gettop:pe,lua_insert:Le,lua_pcall:H,lua_pop:oe,lua_pushcfunction:$,lua_pushstring:Be,lua_remove:Me,lua_setglobal:Ke,lua_tojsstring:Pe}=T.lua,{luaL_loadbuffer:Ye,luaL_newstate:b,luaL_requiref:I}=T.lauxlib,{checkjs:Y,luaopen_js:X,push:ee,tojs:Ne}=A,Fe=b();function He(y,W){if(typeof y=="string")y=Object(T.to_luastring)(y);else if(!(y instanceof Uint8Array))throw new TypeError("expects an array of bytes or javascript string");W=W?Object(T.to_luastring)(W):null;let Ue,Z=Ye(Fe,y,null,W);if(Ue=Z===S?new SyntaxError(Pe(Fe,-1)):Ne(Fe,-1),oe(Fe,1),Z!==ue)throw Ue;return Ue}if(T.lualib.luaL_openlibs(Fe),I(Fe,Object(T.to_luastring)("js"),X,1),oe(Fe,1),Be(Fe,Object(T.to_luastring)(T.FENGARI_COPYRIGHT)),Ke(Fe,Object(T.to_luastring)("_COPYRIGHT")),typeof document<"u"&&document instanceof HTMLDocument){const y=function(_e){switch(_e){case"anonymous":return"omit";case"use-credentials":return"include";default:return"same-origin"}},W=function(_e){let nr=new fe;return Ie(_e,2,nr)&&K(_e,Object(T.to_luastring)("Sl"),nr),ee(_e,new ErrorEvent("error",{bubbles:!0,cancelable:!0,message:Pe(_e,1),error:Ne(_e,1),filename:nr.short_src?Object(T.to_jsstring)(nr.short_src):void 0,lineno:nr.currentline>0?nr.currentline:void 0})),1},Ue=function(_e,nr,ze){let rr,tr=Ye(Fe,nr,null,ze);if(tr===S){let R=Pe(Fe,-1),N=_e.src?_e.src:document.location,de,q=new SyntaxError(R,N,de);rr=new ErrorEvent("error",{message:R,error:q,filename:N,lineno:de})}else if(tr===ue){let R=pe(Fe);$(Fe,W),Le(Fe,R),Object.defineProperty(document,"currentScript",{value:_e,configurable:!0}),tr=H(Fe,0,0,R),delete document.currentScript,Me(Fe,R),tr===G&&(rr=Y(Fe,-1))}tr!==ue&&(rr===void 0&&(rr=new ErrorEvent("error",{message:Pe(Fe,-1),error:Ne(Fe,-1)})),oe(Fe,1),window.dispatchEvent(rr)&&console.error("uncaught exception",rr.error))},Z=function(_e,nr,ze){if(_e.status>=200&&_e.status<300){let rr=_e.response;rr=typeof rr=="string"?Object(T.to_luastring)(_e.response):new Uint8Array(rr),Ue(nr,rr,ze)}else nr.dispatchEvent(new Event("error"))},je=function(_e){if(_e.src){let nr=Object(T.to_luastring)("@"+_e.src);if(document.readyState==="complete"||_e.async)if(typeof fetch=="function")fetch(_e.src,{method:"GET",credentials:y(_e.crossorigin),redirect:"follow",integrity:_e.integrity}).then(function(ze){if(ze.ok)return ze.arrayBuffer();throw new Error("unable to fetch")}).then(function(ze){let rr=new Uint8Array(ze);Ue(_e,rr,nr)}).catch(function(ze){_e.dispatchEvent(new Event("error"))});else{let ze=new XMLHttpRequest;ze.open("GET",_e.src,!0),ze.responseType="arraybuffer",ze.onreadystatechange=function(){ze.readyState===4&&Z(ze,_e,nr)},ze.send()}else{let ze=new XMLHttpRequest;ze.open("GET",_e.src,!1),ze.send(),Z(ze,_e,nr)}}else{let nr=Object(T.to_luastring)(_e.innerHTML),ze=_e.id?Object(T.to_luastring)("="+_e.id):nr;Ue(_e,nr,ze)}},d=/^(.*?\/.*?)([\t ]*;.*)?$/,k=/^(\d+)\.(\d+)$/,m=function(_e){if(_e.tagName!=="SCRIPT")return;let nr=d.exec(_e.type);if(!nr)return;let ze=nr[1];if(ze==="application/lua"||ze==="text/lua"){if(_e.hasAttribute("lua-version")){let rr=k.exec(_e.getAttribute("lua-version"));if(!rr||rr[1]!==we||rr[2]!==C)return}je(_e)}};typeof MutationObserver<"u"?new MutationObserver(function(_e,nr){for(let ze=0;ze<_e.length;ze++){let rr=_e[ze];for(let tr=0;tr<rr.addedNodes.length;tr++)m(rr.addedNodes[tr])}}).observe(document,{childList:!0,subtree:!0}):console.warn&&console.warn("fengari-web: MutationObserver not found; lua script tags will not be run when inserted"),Array.prototype.forEach.call(document.querySelectorAll('script[type^="application/lua"], script[type^="text/lua"]'),m)}},function(e,lr,h){const{LUA_MULTRET:T,LUA_OPADD:A,LUA_OPBAND:G,LUA_OPBNOT:S,LUA_OPBOR:ue,LUA_OPBXOR:we,LUA_OPDIV:C,LUA_OPIDIV:fe,LUA_OPMOD:K,LUA_OPSHL:Ie,LUA_OPSHR:pe,LUA_OPUNM:Le,constant_types:{LUA_TBOOLEAN:H,LUA_TLIGHTUSERDATA:oe,LUA_TLNGSTR:$,LUA_TNIL:Be,LUA_TNUMFLT:Me,LUA_TNUMINT:Ke,LUA_TTABLE:Pe},to_luastring:Ye}=h(1),{lua_assert:b}=h(4),I=h(20),Y=h(6),X=h(16),ee=h(23),Ne=h(9),Fe=h(15),He=X.OpCodesI,y=Y.TValue,W={OPR_ADD:0,OPR_SUB:1,OPR_MUL:2,OPR_MOD:3,OPR_POW:4,OPR_DIV:5,OPR_IDIV:6,OPR_BAND:7,OPR_BOR:8,OPR_BXOR:9,OPR_SHL:10,OPR_SHR:11,OPR_CONCAT:12,OPR_EQ:13,OPR_LT:14,OPR_LE:15,OPR_NE:16,OPR_GT:17,OPR_GE:18,OPR_AND:19,OPR_OR:20,OPR_NOBINOPR:21},Ue={OPR_MINUS:0,OPR_BNOT:1,OPR_NOT:2,OPR_LEN:3,OPR_NOUNOPR:4},Z=function(a){return a.t!==a.f},je=function(a,u){let f=ee.expkind;if(Z(a))return!1;switch(a.k){case f.VKINT:return!u||new y(Ke,a.u.ival);case f.VKFLT:return!u||new y(Me,a.u.nval);default:return!1}},d=function(a,u,f){let s,U=u+f-1;if(a.pc>a.lasttarget&&(s=a.f.code[a.pc-1]).opcode===He.OP_LOADNIL){let xe=s.A,Ge=xe+s.B;if(xe<=u&&u<=Ge+1||u<=xe&&xe<=U+1)return xe<u&&(u=xe),Ge>U&&(U=Ge),X.SETARG_A(s,u),void X.SETARG_B(s,U-u)}ke(a,He.OP_LOADNIL,u,f-1,0)},k=function(a,u){return a.f.code[u.u.info]},m=function(a,u){let f=a.f.code[u].sBx;return f===-1?-1:u+1+f},ie=function(a,u,f){let s=a.f.code[u],U=f-(u+1);b(f!==-1),Math.abs(U)>X.MAXARG_sBx&&I.luaX_syntaxerror(a.ls,Ye("control structure too long",!0)),X.SETARG_sBx(s,U)},_e=function(a,u,f){if(f===-1)return u;if(u===-1)u=f;else{let s=u,U=m(a,s);for(;U!==-1;)U=m(a,s=U);ie(a,s,f)}return u},nr=function(a){let u=a.jpc;a.jpc=-1;let f=le(a,He.OP_JMP,0,-1);return f=_e(a,f,u)},ze=function(a,u,f,s,U){return ke(a,u,f,s,U),nr(a)},rr=function(a){return a.lasttarget=a.pc,a.pc},tr=function(a,u){return u>=1&&X.testTMode(a.f.code[u-1].opcode)?u-1:u},R=function(a,u){return a.f.code[tr(a,u)]},N=function(a,u,f){let s=tr(a,u),U=a.f.code[s];return U.opcode===He.OP_TESTSET&&(f!==X.NO_REG&&f!==U.B?X.SETARG_A(U,f):a.f.code[s]=X.CREATE_ABC(He.OP_TEST,U.B,0,U.C),!0)},de=function(a,u){for(;u!==-1;u=m(a,u))N(a,u,X.NO_REG)},q=function(a,u,f,s,U){for(;u!==-1;){let xe=m(a,u);N(a,u,s)?ie(a,u,f):ie(a,u,U),u=xe}},Re=function(a,u){rr(a),a.jpc=_e(a,a.jpc,u)},ar=function(a,u,f){f===a.pc?Re(a,u):(b(f<a.pc),q(a,u,f,X.NO_REG,f))},Je=function(a,u){let f=a.f;return(function(s){q(s,s.jpc,s.pc,X.NO_REG,s.pc),s.jpc=-1})(a),f.code[a.pc]=u,f.lineinfo[a.pc]=a.ls.lastline,a.pc++},ke=function(a,u,f,s,U){return b(X.getOpMode(u)===X.iABC),b(X.getBMode(u)!==X.OpArgN||s===0),b(X.getCMode(u)!==X.OpArgN||U===0),b(f<=X.MAXARG_A&&s<=X.MAXARG_B&&U<=X.MAXARG_C),Je(a,X.CREATE_ABC(u,f,s,U))},w=function(a,u,f,s){return b(X.getOpMode(u)===X.iABx||X.getOpMode(u)===X.iAsBx),b(X.getCMode(u)===X.OpArgN),b(f<=X.MAXARG_A&&s<=X.MAXARG_Bx),Je(a,X.CREATE_ABx(u,f,s))},le=function(a,u,f,s){return w(a,u,f,s+X.MAXARG_sBx)},p=function(a,u){return b(u<=X.MAXARG_Ax),Je(a,X.CREATE_Ax(He.OP_EXTRAARG,u))},j=function(a,u,f){if(f<=X.MAXARG_Bx)return w(a,He.OP_LOADK,u,f);{let s=w(a,He.OP_LOADKX,u,0);return p(a,f),s}},he=function(a,u){let f=a.freereg+u;f>a.f.maxstacksize&&(f>=255&&I.luaX_syntaxerror(a.ls,Ye("function or expression needs too many registers",!0)),a.f.maxstacksize=f)},g=function(a,u){he(a,u),a.freereg+=u},z=function(a,u){!X.ISK(u)&&u>=a.nactvar&&(a.freereg--,b(u===a.freereg))},se=function(a,u){u.k===ee.expkind.VNONRELOC&&z(a,u.u.info)},or=function(a,u,f){let s=u.k===ee.expkind.VNONRELOC?u.u.info:-1,U=f.k===ee.expkind.VNONRELOC?f.u.info:-1;s>U?(z(a,s),z(a,U)):(z(a,U),z(a,s))},ir=function(a,u,f){let s=a.f,U=Ne.luaH_get(a.L,a.ls.h,u);if(U.ttisinteger()){let Ge=U.value;if(Ge<a.nk&&s.k[Ge].ttype()===f.ttype()&&s.k[Ge].value===f.value)return Ge}let xe=a.nk;return Ne.luaH_setfrom(a.L,a.ls.h,u,new Y.TValue(Ke,xe)),s.k[xe]=f,a.nk++,xe},cr=function(a,u){let f=new y(oe,u),s=new y(Ke,u);return ir(a,f,s)},mr=function(a,u){let f=new y(Me,u);return ir(a,f,f)},Sr=function(a,u){let f=new y(H,u);return ir(a,f,f)},Rr=function(a,u,f){let s=ee.expkind;if(u.k===s.VCALL)X.SETARG_C(k(a,u),f+1);else if(u.k===s.VVARARG){let U=k(a,u);X.SETARG_B(U,f+1),X.SETARG_A(U,a.freereg),g(a,1)}else b(f===T)},Cr=function(a,u){let f=ee.expkind;u.k===f.VCALL?(b(k(a,u).C===2),u.k=f.VNONRELOC,u.u.info=k(a,u).A):u.k===f.VVARARG&&(X.SETARG_B(k(a,u),2),u.k=f.VRELOCABLE)},_=function(a,u){let f=ee.expkind;switch(u.k){case f.VLOCAL:u.k=f.VNONRELOC;break;case f.VUPVAL:u.u.info=ke(a,He.OP_GETUPVAL,0,u.u.info,0),u.k=f.VRELOCABLE;break;case f.VINDEXED:{let s;z(a,u.u.ind.idx),u.u.ind.vt===f.VLOCAL?(z(a,u.u.ind.t),s=He.OP_GETTABLE):(b(u.u.ind.vt===f.VUPVAL),s=He.OP_GETTABUP),u.u.info=ke(a,s,0,u.u.ind.t,u.u.ind.idx),u.k=f.VRELOCABLE;break}case f.VVARARG:case f.VCALL:Cr(a,u)}},Oe=function(a,u,f,s){return rr(a),ke(a,He.OP_LOADBOOL,u,f,s)},be=function(a,u,f){let s=ee.expkind;switch(_(a,u),u.k){case s.VNIL:d(a,f,1);break;case s.VFALSE:case s.VTRUE:ke(a,He.OP_LOADBOOL,f,u.k===s.VTRUE,0);break;case s.VK:j(a,f,u.u.info);break;case s.VKFLT:j(a,f,mr(a,u.u.nval));break;case s.VKINT:j(a,f,cr(a,u.u.ival));break;case s.VRELOCABLE:{let U=k(a,u);X.SETARG_A(U,f);break}case s.VNONRELOC:f!==u.u.info&&ke(a,He.OP_MOVE,f,u.u.info,0);break;default:return void b(u.k===s.VJMP)}u.u.info=f,u.k=s.VNONRELOC},ge=function(a,u){u.k!==ee.expkind.VNONRELOC&&(g(a,1),be(a,u,a.freereg-1))},ae=function(a,u){for(;u!==-1;u=m(a,u))if(R(a,u).opcode!==He.OP_TESTSET)return!0;return!1},ce=function(a,u,f){let s=ee.expkind;if(be(a,u,f),u.k===s.VJMP&&(u.t=_e(a,u.t,u.u.info)),Z(u)){let U,xe=-1,Ge=-1;if(ae(a,u.t)||ae(a,u.f)){let Ar=u.k===s.VJMP?-1:nr(a);xe=Oe(a,f,0,1),Ge=Oe(a,f,1,0),Re(a,Ar)}U=rr(a),q(a,u.f,U,f,xe),q(a,u.t,U,f,Ge)}u.f=u.t=-1,u.u.info=f,u.k=s.VNONRELOC},De=function(a,u){_(a,u),se(a,u),g(a,1),ce(a,u,a.freereg-1)},Lr=function(a,u){if(_(a,u),u.k===ee.expkind.VNONRELOC){if(!Z(u))return u.u.info;if(u.u.info>=a.nactvar)return ce(a,u,u.u.info),u.u.info}return De(a,u),u.u.info},dr=function(a,u){Z(u)?Lr(a,u):_(a,u)},xr=function(a,u){let f=ee.expkind,s=!1;switch(dr(a,u),u.k){case f.VTRUE:u.u.info=Sr(a,!0),s=!0;break;case f.VFALSE:u.u.info=Sr(a,!1),s=!0;break;case f.VNIL:u.u.info=(function(U){let xe=new y(Be,null),Ge=new y(Pe,U.ls.h);return ir(U,Ge,xe)})(a),s=!0;break;case f.VKINT:u.u.info=cr(a,u.u.ival),s=!0;break;case f.VKFLT:u.u.info=mr(a,u.u.nval),s=!0;break;case f.VK:s=!0}return s&&(u.k=f.VK,u.u.info<=X.MAXINDEXRK)?X.RKASK(u.u.info):Lr(a,u)},Mr=function(a,u){let f=R(a,u.u.info);b(X.testTMode(f.opcode)&&f.opcode!==He.OP_TESTSET&&f.opcode!==He.OP_TEST),X.SETARG_A(f,!f.A)},Qe=function(a,u,f){if(u.k===ee.expkind.VRELOCABLE){let s=k(a,u);if(s.opcode===He.OP_NOT)return a.pc--,ze(a,He.OP_TEST,s.B,0,!f)}return ge(a,u),se(a,u),ze(a,He.OP_TESTSET,X.NO_REG,u.u.info,f)},sr=function(a,u){let f,s=ee.expkind;switch(_(a,u),u.k){case s.VJMP:Mr(a,u),f=u.u.info;break;case s.VK:case s.VKFLT:case s.VKINT:case s.VTRUE:f=-1;break;default:f=Qe(a,u,0)}u.f=_e(a,u.f,f),Re(a,u.t),u.t=-1},br=function(a,u){let f,s=ee.expkind;switch(_(a,u),u.k){case s.VJMP:f=u.u.info;break;case s.VNIL:case s.VFALSE:f=-1;break;default:f=Qe(a,u,1)}u.t=_e(a,u.t,f),Re(a,u.f),u.f=-1},r=function(a,u,f){let s,U,xe=ee.expkind;if(!(s=je(u,!0))||!(U=je(f,!0))||!(function(Ar,Tr,M){switch(Ar){case G:case ue:case we:case Ie:case pe:case S:return Fe.tointeger(Tr)!==!1&&Fe.tointeger(M)!==!1;case C:case fe:case K:return M.value!==0;default:return 1}})(a,s,U))return 0;let Ge=new y;if(Y.luaO_arith(null,a,s,U,Ge),Ge.ttisinteger())u.k=xe.VKINT,u.u.ival=Ge.value;else{let Ar=Ge.value;if(isNaN(Ar)||Ar===0)return!1;u.k=xe.VKFLT,u.u.nval=Ar}return!0},n=function(a,u,f,s,U){let xe=xr(a,s),Ge=xr(a,f);or(a,f,s),f.u.info=ke(a,u,0,Ge,xe),f.k=ee.expkind.VRELOCABLE,l(a,U)},l=function(a,u){a.f.lineinfo[a.pc-1]=u};e.exports.BinOpr=W,e.exports.NO_JUMP=-1,e.exports.UnOpr=Ue,e.exports.getinstruction=k,e.exports.luaK_checkstack=he,e.exports.luaK_code=Je,e.exports.luaK_codeABC=ke,e.exports.luaK_codeABx=w,e.exports.luaK_codeAsBx=le,e.exports.luaK_codek=j,e.exports.luaK_concat=_e,e.exports.luaK_dischargevars=_,e.exports.luaK_exp2RK=xr,e.exports.luaK_exp2anyreg=Lr,e.exports.luaK_exp2anyregup=function(a,u){(u.k!==ee.expkind.VUPVAL||Z(u))&&Lr(a,u)},e.exports.luaK_exp2nextreg=De,e.exports.luaK_exp2val=dr,e.exports.luaK_fixline=l,e.exports.luaK_getlabel=rr,e.exports.luaK_goiffalse=br,e.exports.luaK_goiftrue=sr,e.exports.luaK_indexed=function(a,u,f){let s=ee.expkind;b(!Z(u)&&(ee.vkisinreg(u.k)||u.k===s.VUPVAL)),u.u.ind.t=u.u.info,u.u.ind.idx=xr(a,f),u.u.ind.vt=u.k===s.VUPVAL?s.VUPVAL:s.VLOCAL,u.k=s.VINDEXED},e.exports.luaK_infix=function(a,u,f){switch(u){case W.OPR_AND:sr(a,f);break;case W.OPR_OR:br(a,f);break;case W.OPR_CONCAT:De(a,f);break;case W.OPR_ADD:case W.OPR_SUB:case W.OPR_MUL:case W.OPR_DIV:case W.OPR_IDIV:case W.OPR_MOD:case W.OPR_POW:case W.OPR_BAND:case W.OPR_BOR:case W.OPR_BXOR:case W.OPR_SHL:case W.OPR_SHR:je(f,!1)||xr(a,f);break;default:xr(a,f)}},e.exports.luaK_intK=cr,e.exports.luaK_jump=nr,e.exports.luaK_jumpto=function(a,u){return ar(a,nr(a),u)},e.exports.luaK_nil=d,e.exports.luaK_numberK=mr,e.exports.luaK_patchclose=function(a,u,f){for(f++;u!==-1;u=m(a,u)){let s=a.f.code[u];b(s.opcode===He.OP_JMP&&(s.A===0||s.A>=f)),X.SETARG_A(s,f)}},e.exports.luaK_patchlist=ar,e.exports.luaK_patchtohere=Re,e.exports.luaK_posfix=function(a,u,f,s,U){let xe=ee.expkind;switch(u){case W.OPR_AND:b(f.t===-1),_(a,s),s.f=_e(a,s.f,f.f),f.to(s);break;case W.OPR_OR:b(f.f===-1),_(a,s),s.t=_e(a,s.t,f.t),f.to(s);break;case W.OPR_CONCAT:{dr(a,s);let Ge=k(a,s);s.k===xe.VRELOCABLE&&Ge.opcode===He.OP_CONCAT?(b(f.u.info===Ge.B-1),se(a,f),X.SETARG_B(Ge,f.u.info),f.k=xe.VRELOCABLE,f.u.info=s.u.info):(De(a,s),n(a,He.OP_CONCAT,f,s,U));break}case W.OPR_ADD:case W.OPR_SUB:case W.OPR_MUL:case W.OPR_DIV:case W.OPR_IDIV:case W.OPR_MOD:case W.OPR_POW:case W.OPR_BAND:case W.OPR_BOR:case W.OPR_BXOR:case W.OPR_SHL:case W.OPR_SHR:r(u+A,f,s)||n(a,u+He.OP_ADD,f,s,U);break;case W.OPR_EQ:case W.OPR_LT:case W.OPR_LE:case W.OPR_NE:case W.OPR_GT:case W.OPR_GE:(function(Ge,Ar,Tr,M){let me,L=ee.expkind;Tr.k===L.VK?me=X.RKASK(Tr.u.info):(b(Tr.k===L.VNONRELOC),me=Tr.u.info);let ne=xr(Ge,M);switch(or(Ge,Tr,M),Ar){case W.OPR_NE:Tr.u.info=ze(Ge,He.OP_EQ,0,me,ne);break;case W.OPR_GT:case W.OPR_GE:{let P=Ar-W.OPR_NE+He.OP_EQ;Tr.u.info=ze(Ge,P,1,ne,me);break}default:{let P=Ar-W.OPR_EQ+He.OP_EQ;Tr.u.info=ze(Ge,P,1,me,ne);break}}Tr.k=L.VJMP})(a,u,f,s)}return f},e.exports.luaK_prefix=function(a,u,f,s){let U=new ee.expdesc;switch(U.k=ee.expkind.VKINT,U.u.ival=U.u.nval=U.u.info=0,U.t=-1,U.f=-1,u){case Ue.OPR_MINUS:case Ue.OPR_BNOT:if(r(u+Le,f,U))break;case Ue.OPR_LEN:(function(xe,Ge,Ar,Tr){let M=Lr(xe,Ar);se(xe,Ar),Ar.u.info=ke(xe,Ge,0,M,0),Ar.k=ee.expkind.VRELOCABLE,l(xe,Tr)})(a,u+He.OP_UNM,f,s);break;case Ue.OPR_NOT:(function(xe,Ge){let Ar=ee.expkind;switch(_(xe,Ge),Ge.k){case Ar.VNIL:case Ar.VFALSE:Ge.k=Ar.VTRUE;break;case Ar.VK:case Ar.VKFLT:case Ar.VKINT:case Ar.VTRUE:Ge.k=Ar.VFALSE;break;case Ar.VJMP:Mr(xe,Ge);break;case Ar.VRELOCABLE:case Ar.VNONRELOC:ge(xe,Ge),se(xe,Ge),Ge.u.info=ke(xe,He.OP_NOT,0,Ge.u.info,0),Ge.k=Ar.VRELOCABLE}{let Tr=Ge.f;Ge.f=Ge.t,Ge.t=Tr}de(xe,Ge.f),de(xe,Ge.t)})(a,f)}},e.exports.luaK_reserveregs=g,e.exports.luaK_ret=function(a,u,f){ke(a,He.OP_RETURN,u,f+1,0)},e.exports.luaK_self=function(a,u,f){Lr(a,u);let s=u.u.info;se(a,u),u.u.info=a.freereg,u.k=ee.expkind.VNONRELOC,g(a,2),ke(a,He.OP_SELF,u.u.info,s,xr(a,f)),se(a,f)},e.exports.luaK_setlist=function(a,u,f,s){let U=(f-1)/X.LFIELDS_PER_FLUSH+1,xe=s===T?0:s;b(s!==0&&s<=X.LFIELDS_PER_FLUSH),U<=X.MAXARG_C?ke(a,He.OP_SETLIST,u,xe,U):U<=X.MAXARG_Ax?(ke(a,He.OP_SETLIST,u,xe,0),p(a,U)):I.luaX_syntaxerror(a.ls,Ye("constructor too long",!0)),a.freereg=u+1},e.exports.luaK_setmultret=function(a,u){Rr(a,u,T)},e.exports.luaK_setoneret=Cr,e.exports.luaK_setreturns=Rr,e.exports.luaK_storevar=function(a,u,f){let s=ee.expkind;switch(u.k){case s.VLOCAL:return se(a,f),void ce(a,f,u.u.info);case s.VUPVAL:{let U=Lr(a,f);ke(a,He.OP_SETUPVAL,U,u.u.info,0);break}case s.VINDEXED:{let U=u.u.ind.vt===s.VLOCAL?He.OP_SETTABLE:He.OP_SETTABUP,xe=xr(a,f);ke(a,U,u.u.ind.t,u.u.ind.idx,xe);break}}se(a,f)},e.exports.luaK_stringK=function(a,u){let f=new y($,u);return ir(a,f,f)}},function(e,lr,h){const{LUA_SIGNATURE:T,constant_types:{LUA_TBOOLEAN:A,LUA_TLNGSTR:G,LUA_TNIL:S,LUA_TNUMFLT:ue,LUA_TNUMINT:we,LUA_TSHRSTR:C},thread_status:{LUA_ERRSYNTAX:fe},is_luastring:K,luastring_eq:Ie,to_luastring:pe}=h(1),Le=h(8),H=h(13),oe=h(6),{MAXARG_sBx:$,POS_A:Be,POS_Ax:Me,POS_B:Ke,POS_Bx:Pe,POS_C:Ye,POS_OP:b,SIZE_A:I,SIZE_Ax:Y,SIZE_B:X,SIZE_Bx:ee,SIZE_C:Ne,SIZE_OP:Fe}=h(16),{lua_assert:He}=h(4),{luaS_bless:y}=h(10),{luaZ_read:W,ZIO:Ue}=h(19);let Z=[25,147,13,10,26,10];class je{constructor(k,m,ie){this.intSize=4,this.size_tSize=4,this.instructionSize=4,this.integerSize=4,this.numberSize=8,He(m instanceof Ue,"BytecodeParser only operates on a ZIO"),He(K(ie)),ie[0]===64||ie[0]===61?this.name=ie.subarray(1):ie[0]==T[0]?this.name=pe("binary string",!0):this.name=ie,this.L=k,this.Z=m,this.arraybuffer=new ArrayBuffer(Math.max(this.intSize,this.size_tSize,this.instructionSize,this.integerSize,this.numberSize)),this.dv=new DataView(this.arraybuffer),this.u8=new Uint8Array(this.arraybuffer)}read(k){let m=new Uint8Array(k);return W(this.Z,m,0,k)!==0&&this.error("truncated"),m}LoadByte(){return W(this.Z,this.u8,0,1)!==0&&this.error("truncated"),this.u8[0]}LoadInt(){return W(this.Z,this.u8,0,this.intSize)!==0&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadNumber(){return W(this.Z,this.u8,0,this.numberSize)!==0&&this.error("truncated"),this.dv.getFloat64(0,!0)}LoadInteger(){return W(this.Z,this.u8,0,this.integerSize)!==0&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadSize_t(){return this.LoadInteger()}LoadString(){let k=this.LoadByte();return k===255&&(k=this.LoadSize_t()),k===0?null:y(this.L,this.read(k-1))}static MASK1(k,m){return~(-1<<k)<<m}LoadCode(k){let m=this.LoadInt(),ie=je;for(let _e=0;_e<m;_e++){W(this.Z,this.u8,0,this.instructionSize)!==0&&this.error("truncated");let nr=this.dv.getUint32(0,!0);k.code[_e]={code:nr,opcode:nr>>b&ie.MASK1(Fe,0),A:nr>>Be&ie.MASK1(I,0),B:nr>>Ke&ie.MASK1(X,0),C:nr>>Ye&ie.MASK1(Ne,0),Bx:nr>>Pe&ie.MASK1(ee,0),Ax:nr>>Me&ie.MASK1(Y,0),sBx:(nr>>Pe&ie.MASK1(ee,0))-$}}}LoadConstants(k){let m=this.LoadInt();for(let ie=0;ie<m;ie++){let _e=this.LoadByte();switch(_e){case S:k.k.push(new oe.TValue(S,null));break;case A:k.k.push(new oe.TValue(A,this.LoadByte()!==0));break;case ue:k.k.push(new oe.TValue(ue,this.LoadNumber()));break;case we:k.k.push(new oe.TValue(we,this.LoadInteger()));break;case C:case G:k.k.push(new oe.TValue(G,this.LoadString()));break;default:this.error(`unrecognized constant '${_e}'`)}}}LoadProtos(k){let m=this.LoadInt();for(let ie=0;ie<m;ie++)k.p[ie]=new H.Proto(this.L),this.LoadFunction(k.p[ie],k.source)}LoadUpvalues(k){let m=this.LoadInt();for(let ie=0;ie<m;ie++)k.upvalues[ie]={name:null,instack:this.LoadByte(),idx:this.LoadByte()}}LoadDebug(k){let m=this.LoadInt();for(let ie=0;ie<m;ie++)k.lineinfo[ie]=this.LoadInt();m=this.LoadInt();for(let ie=0;ie<m;ie++)k.locvars[ie]={varname:this.LoadString(),startpc:this.LoadInt(),endpc:this.LoadInt()};m=this.LoadInt();for(let ie=0;ie<m;ie++)k.upvalues[ie].name=this.LoadString()}LoadFunction(k,m){k.source=this.LoadString(),k.source===null&&(k.source=m),k.linedefined=this.LoadInt(),k.lastlinedefined=this.LoadInt(),k.numparams=this.LoadByte(),k.is_vararg=this.LoadByte()!==0,k.maxstacksize=this.LoadByte(),this.LoadCode(k),this.LoadConstants(k),this.LoadUpvalues(k),this.LoadProtos(k),this.LoadDebug(k)}checkliteral(k,m){let ie=this.read(k.length);Ie(ie,k)||this.error(m)}checkHeader(){this.checkliteral(T.subarray(1),"not a"),this.LoadByte()!==83&&this.error("version mismatch in"),this.LoadByte()!==0&&this.error("format mismatch in"),this.checkliteral(Z,"corrupted"),this.intSize=this.LoadByte(),this.size_tSize=this.LoadByte(),this.instructionSize=this.LoadByte(),this.integerSize=this.LoadByte(),this.numberSize=this.LoadByte(),this.checksize(this.intSize,4,"int"),this.checksize(this.size_tSize,4,"size_t"),this.checksize(this.instructionSize,4,"instruction"),this.checksize(this.integerSize,4,"integer"),this.checksize(this.numberSize,8,"number"),this.LoadInteger()!==22136&&this.error("endianness mismatch in"),this.LoadNumber()!==370.5&&this.error("float format mismatch in")}error(k){oe.luaO_pushfstring(this.L,pe("%s: %s precompiled chunk"),this.name,pe(k)),Le.luaD_throw(this.L,fe)}checksize(k,m,ie){k!==m&&this.error(`${ie} size mismatch in`)}}e.exports.luaU_undump=function(d,k,m){let ie=new je(d,k,m);ie.checkHeader();let _e=H.luaF_newLclosure(d,ie.LoadByte());return Le.luaD_inctop(d),d.stack[d.top-1].setclLvalue(_e),_e.p=new H.Proto(d),ie.LoadFunction(_e.p,null),He(_e.nupvalues===_e.p.upvalues.length),_e}},function(e,lr,h){const{LUA_SIGNATURE:T,LUA_VERSION_MAJOR:A,LUA_VERSION_MINOR:G,constant_types:{LUA_TBOOLEAN:S,LUA_TLNGSTR:ue,LUA_TNIL:we,LUA_TNUMFLT:C,LUA_TNUMINT:fe,LUA_TSHRSTR:K},luastring_of:Ie}=h(1),pe=Ie(25,147,13,10,26,10),Le=16*Number(A)+Number(G),H=function(Ye,b,I){I.status===0&&b>0&&(I.status=I.writer(I.L,Ye,b,I.data))},oe=function(Ye,b){H(Ie(Ye),1,b)},$=function(Ye,b){let I=new ArrayBuffer(4);new DataView(I).setInt32(0,Ye,!0);let Y=new Uint8Array(I);H(Y,4,b)},Be=function(Ye,b){let I=new ArrayBuffer(4);new DataView(I).setInt32(0,Ye,!0);let Y=new Uint8Array(I);H(Y,4,b)},Me=function(Ye,b){let I=new ArrayBuffer(8);new DataView(I).setFloat64(0,Ye,!0);let Y=new Uint8Array(I);H(Y,8,b)},Ke=function(Ye,b){if(Ye===null)oe(0,b);else{let I=Ye.tsslen()+1,Y=Ye.getstr();I<255?oe(I,b):(oe(255,b),Be(I,b)),H(Y,I-1,b)}},Pe=function(Ye,b,I){I.strip||Ye.source===b?Ke(null,I):Ke(Ye.source,I),$(Ye.linedefined,I),$(Ye.lastlinedefined,I),oe(Ye.numparams,I),oe(Ye.is_vararg?1:0,I),oe(Ye.maxstacksize,I),(function(Y,X){let ee=Y.code.map(Ne=>Ne.code);$(ee.length,X);for(let Ne=0;Ne<ee.length;Ne++)$(ee[Ne],X)})(Ye,I),(function(Y,X){let ee=Y.k.length;$(ee,X);for(let Ne=0;Ne<ee;Ne++){let Fe=Y.k[Ne];switch(oe(Fe.ttype(),X),Fe.ttype()){case we:break;case S:oe(Fe.value?1:0,X);break;case C:Me(Fe.value,X);break;case fe:Be(Fe.value,X);break;case K:case ue:Ke(Fe.tsvalue(),X)}}})(Ye,I),(function(Y,X){let ee=Y.upvalues.length;$(ee,X);for(let Ne=0;Ne<ee;Ne++)oe(Y.upvalues[Ne].instack?1:0,X),oe(Y.upvalues[Ne].idx,X)})(Ye,I),(function(Y,X){let ee=Y.p.length;$(ee,X);for(let Ne=0;Ne<ee;Ne++)Pe(Y.p[Ne],Y.source,X)})(Ye,I),(function(Y,X){let ee=X.strip?0:Y.lineinfo.length;$(ee,X);for(let Ne=0;Ne<ee;Ne++)$(Y.lineinfo[Ne],X);ee=X.strip?0:Y.locvars.length,$(ee,X);for(let Ne=0;Ne<ee;Ne++)Ke(Y.locvars[Ne].varname,X),$(Y.locvars[Ne].startpc,X),$(Y.locvars[Ne].endpc,X);ee=X.strip?0:Y.upvalues.length,$(ee,X);for(let Ne=0;Ne<ee;Ne++)Ke(Y.upvalues[Ne].name,X)})(Ye,I)};e.exports.luaU_dump=function(Ye,b,I,Y,X){let ee=new class{constructor(){this.L=null,this.write=null,this.data=null,this.strip=NaN,this.status=NaN}};return ee.L=Ye,ee.writer=I,ee.data=Y,ee.strip=X,ee.status=0,(function(Ne){H(T,T.length,Ne),oe(Le,Ne),oe(0,Ne),H(pe,pe.length,Ne),oe(4,Ne),oe(4,Ne),oe(4,Ne),oe(4,Ne),oe(8,Ne),Be(22136,Ne),Me(370.5,Ne)})(ee),oe(b.upvalues.length,ee),Pe(b,null,ee),ee.status}},function(e,lr,h){var T;(function(){var A={not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function G(we){return(function(C,fe){var K,Ie,pe,Le,H,oe,$,Be,Me,Ke=1,Pe=C.length,Ye="";for(Ie=0;Ie<Pe;Ie++)if(typeof C[Ie]=="string")Ye+=C[Ie];else if(Array.isArray(C[Ie])){if((Le=C[Ie])[2])for(K=fe[Ke],pe=0;pe<Le[2].length;pe++){if(!K.hasOwnProperty(Le[2][pe]))throw new Error(G('[sprintf] property "%s" does not exist',Le[2][pe]));K=K[Le[2][pe]]}else K=Le[1]?fe[Le[1]]:fe[Ke++];if(A.not_type.test(Le[8])&&A.not_primitive.test(Le[8])&&K instanceof Function&&(K=K()),A.numeric_arg.test(Le[8])&&typeof K!="number"&&isNaN(K))throw new TypeError(G("[sprintf] expecting number but found %T",K));switch(A.number.test(Le[8])&&(Be=K>=0),Le[8]){case"b":K=parseInt(K,10).toString(2);break;case"c":K=String.fromCharCode(parseInt(K,10));break;case"d":case"i":K=parseInt(K,10);break;case"j":K=JSON.stringify(K,null,Le[6]?parseInt(Le[6]):0);break;case"e":K=Le[7]?parseFloat(K).toExponential(Le[7]):parseFloat(K).toExponential();break;case"f":K=Le[7]?parseFloat(K).toFixed(Le[7]):parseFloat(K);break;case"g":K=Le[7]?String(Number(K.toPrecision(Le[7]))):parseFloat(K);break;case"o":K=(parseInt(K,10)>>>0).toString(8);break;case"s":K=String(K),K=Le[7]?K.substring(0,Le[7]):K;break;case"t":K=String(!!K),K=Le[7]?K.substring(0,Le[7]):K;break;case"T":K=Object.prototype.toString.call(K).slice(8,-1).toLowerCase(),K=Le[7]?K.substring(0,Le[7]):K;break;case"u":K=parseInt(K,10)>>>0;break;case"v":K=K.valueOf(),K=Le[7]?K.substring(0,Le[7]):K;break;case"x":K=(parseInt(K,10)>>>0).toString(16);break;case"X":K=(parseInt(K,10)>>>0).toString(16).toUpperCase()}A.json.test(Le[8])?Ye+=K:(!A.number.test(Le[8])||Be&&!Le[3]?Me="":(Me=Be?"+":"-",K=K.toString().replace(A.sign,"")),oe=Le[4]?Le[4]==="0"?"0":Le[4].charAt(1):" ",$=Le[6]-(Me+K).length,H=Le[6]&&$>0?oe.repeat($):"",Ye+=Le[5]?Me+K+H:oe==="0"?Me+H+K:H+Me+K)}return Ye})((function(C){if(ue[C])return ue[C];for(var fe,K=C,Ie=[],pe=0;K;){if((fe=A.text.exec(K))!==null)Ie.push(fe[0]);else if((fe=A.modulo.exec(K))!==null)Ie.push("%");else{if((fe=A.placeholder.exec(K))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(fe[2]){pe|=1;var Le=[],H=fe[2],oe=[];if((oe=A.key.exec(H))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");for(Le.push(oe[1]);(H=H.substring(oe[0].length))!=="";)if((oe=A.key_access.exec(H))!==null)Le.push(oe[1]);else{if((oe=A.index_access.exec(H))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");Le.push(oe[1])}fe[2]=Le}else pe|=2;if(pe===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");Ie.push(fe)}K=K.substring(fe[0].length)}return ue[C]=Ie})(we),arguments)}function S(we,C){return G.apply(null,[we].concat(C||[]))}var ue=Object.create(null);lr.sprintf=G,lr.vsprintf=S,typeof window<"u"&&(window.sprintf=G,window.vsprintf=S,(T=(function(){return{sprintf:G,vsprintf:S}}).call(lr,h,lr,e))===void 0||(e.exports=T))})()},function(e,lr,h){const{lua_pop:T}=h(2),{luaL_requiref:A}=h(7),{to_luastring:G}=h(5),S={};e.exports.luaL_openlibs=function(Be){for(let Me in S)A(Be,G(Me),S[Me],1),T(Be,1)};const ue=h(17),{luaopen_base:we}=h(24),{luaopen_coroutine:C}=h(25),{luaopen_debug:fe}=h(31),{luaopen_math:K}=h(30),{luaopen_package:Ie}=h(32),{luaopen_os:pe}=h(27),{luaopen_string:Le}=h(28),{luaopen_table:H}=h(26),{luaopen_utf8:oe}=h(29);S._G=we,S[ue.LUA_LOADLIBNAME]=Ie,S[ue.LUA_COLIBNAME]=C,S[ue.LUA_TABLIBNAME]=H,S[ue.LUA_OSLIBNAME]=pe,S[ue.LUA_STRLIBNAME]=Le,S[ue.LUA_MATHLIBNAME]=K,S[ue.LUA_UTF8LIBNAME]=oe,S[ue.LUA_DBLIBNAME]=fe;const{luaopen_fengari:$}=h(33);S[ue.LUA_FENGARILIBNAME]=$}])),fn}var ln=Sn(),wn=Rn(ln),In=Nn({__proto__:null,default:wn},[ln]);const{lua:Dr,lauxlib:kn,lualib:yn}=In,{tojs:Mn,push:Pn}=ln.interop,en=ln.to_luastring;function Yr(e,lr=void 0){self.postMessage({type:e,payload:lr})}function tn(e,lr){try{const h=Mn(e,lr);if(h==null)return"nil";if(typeof h=="object")try{return JSON.stringify(h)}catch{return String(h)}return String(h)}catch{try{if(typeof Dr.lua_tojsstring=="function")return Dr.lua_tojsstring(e,lr)??"<unprintable>"}catch{}return"<unprintable>"}}let Kr=null,rn=null,vn=!1,un=null;self.onmessage=async e=>{const lr=e.data;if(!(!lr||!lr.type))switch(lr.type){case"run":Cn(String(lr.payload?.code??"")).catch(h=>{Yr("error",String(h?.stack??h?.message??h)),Yr("done")});break;case"resume":un&&(un(lr.payload?.args??[]),un=null);break;case"cancel":vn=!0;break;case"terminate":try{self.close()}catch{}break}};async function Cn(e){Kr=kn.luaL_newstate(),yn.luaL_openlibs(Kr);const lr=S=>{vn&&Dr.luaL_error(S,en("execution cancelled"))};Dr.lua_sethook(Kr,lr,Dr.LUA_MASKCOUNT,1e4);const h=S=>{const ue=Dr.lua_gettop(S),we=[];for(let C=1;C<=ue;C++)we.push(tn(S,C));return Yr("log",we.join("	")+`
`),0},T=S=>{const ue=Dr.lua_gettop(S),we=[];for(let C=1;C<=ue;C++)we.push(tn(S,C));return Yr("log",we.join("")),0},A=S=>Dr.lua_yield(S,0);if(Dr.lua_pushcfunction(Kr,h),Dr.lua_setglobal(Kr,en("print")),Dr.lua_newtable(Kr),Dr.lua_pushcfunction(Kr,T),Dr.lua_setfield(Kr,-2,en("write")),Dr.lua_pushcfunction(Kr,A),Dr.lua_setfield(Kr,-2,en("read")),Dr.lua_pushcfunction(Kr,(()=>0)),Dr.lua_setfield(Kr,-2,en("flush")),Dr.lua_setglobal(Kr,en("io")),kn.luaL_loadstring(Kr,en(e))!==Dr.LUA_OK){const S=tn(Kr,-1);Yr("log",`Syntax Error: ${S}
`),Dr.lua_pop(Kr,1),Yr("done");return}rn=Dr.lua_newthread(Kr),Dr.lua_pushvalue(Kr,-2),Dr.lua_xmove(Kr,rn,1),Dr.lua_pop(Kr,1);try{let S=Dr.lua_resume(rn,null,0);for(;S===Dr.LUA_YIELD;){const ue=await new Promise(C=>{un=C,Yr("request_input")});if(ue&&ue.length)for(let C=0;C<ue.length;C++)Pn(rn,ue[C]);const we=ue&&ue.length?ue.length:0;S=Dr.lua_resume(rn,null,we)}if(S!==Dr.LUA_OK){const ue=tn(rn,-1);Yr("log",`Runtime Error: ${ue}
`);try{Dr.lua_pop(rn,1)}catch{}Yr("done");return}}catch(S){Yr("log",`Runtime Error: ${String(S?.message??S)}
`),Yr("done");return}Yr("done")}
